<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Getting familiar with deep Q-networks | Stochastic Expatriate Descent</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Getting familiar with deep Q-networks" />
<meta name="author" content="David R. Pugh" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Notes on the seminal Deep Q-Networks Nature paper from Deepmind." />
<meta property="og:description" content="Notes on the seminal Deep Q-Networks Nature paper from Deepmind." />
<link rel="canonical" href="https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html" />
<meta property="og:url" content="https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html" />
<meta property="og:site_name" content="Stochastic Expatriate Descent" />
<meta property="og:image" content="https://davidrpugh.github.io/stochastic-expatriate-descent/images/q-network-architecture.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-03T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"David R. Pugh"},"datePublished":"2020-04-03T00:00:00-05:00","headline":"Getting familiar with deep Q-networks","image":"https://davidrpugh.github.io/stochastic-expatriate-descent/images/q-network-architecture.jpg","description":"Notes on the seminal Deep Q-Networks Nature paper from Deepmind.","mainEntityOfPage":{"@type":"WebPage","@id":"https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html"},"@type":"BlogPosting","url":"https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html","dateModified":"2020-04-03T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/stochastic-expatriate-descent/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://davidrpugh.github.io/stochastic-expatriate-descent/feed.xml" title="Stochastic Expatriate Descent" /><link rel="shortcut icon" type="image/x-icon" href="/stochastic-expatriate-descent/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Getting familiar with deep Q-networks | Stochastic Expatriate Descent</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Getting familiar with deep Q-networks" />
<meta name="author" content="David R. Pugh" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Notes on the seminal Deep Q-Networks Nature paper from Deepmind." />
<meta property="og:description" content="Notes on the seminal Deep Q-Networks Nature paper from Deepmind." />
<link rel="canonical" href="https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html" />
<meta property="og:url" content="https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html" />
<meta property="og:site_name" content="Stochastic Expatriate Descent" />
<meta property="og:image" content="https://davidrpugh.github.io/stochastic-expatriate-descent/images/q-network-architecture.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-03T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"David R. Pugh"},"datePublished":"2020-04-03T00:00:00-05:00","headline":"Getting familiar with deep Q-networks","image":"https://davidrpugh.github.io/stochastic-expatriate-descent/images/q-network-architecture.jpg","description":"Notes on the seminal Deep Q-Networks Nature paper from Deepmind.","mainEntityOfPage":{"@type":"WebPage","@id":"https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html"},"@type":"BlogPosting","url":"https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html","dateModified":"2020-04-03T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://davidrpugh.github.io/stochastic-expatriate-descent/feed.xml" title="Stochastic Expatriate Descent" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/stochastic-expatriate-descent/">Stochastic Expatriate Descent</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/stochastic-expatriate-descent/about/">About Me</a><a class="page-link" href="/stochastic-expatriate-descent/search/">Search</a><a class="page-link" href="/stochastic-expatriate-descent/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Getting familiar with deep Q-networks</h1><p class="page-description">Notes on the seminal Deep Q-Networks *Nature* paper from Deepmind.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-04-03T00:00:00-05:00" itemprop="datePublished">
        Apr 3, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">David R. Pugh</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      23 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/stochastic-expatriate-descent/categories/#pytorch">pytorch</a>
        &nbsp;
      
        <a class="category-tags-link" href="/stochastic-expatriate-descent/categories/#deep-reinforcement-learning">deep-reinforcement-learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/stochastic-expatriate-descent/categories/#deep-q-networks">deep-q-networks</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/davidrpugh/stochastic-expatriate-descent/tree/2020-04-03-deep-q-networks/_notebooks/2020-04-03-deep-q-networks.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/stochastic-expatriate-descent/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/davidrpugh/stochastic-expatriate-descent/2020-04-03-deep-q-networks?filepath=_notebooks%2F2020-04-03-deep-q-networks.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/stochastic-expatriate-descent/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/davidrpugh/stochastic-expatriate-descent/blob/2020-04-03-deep-q-networks/_notebooks/2020-04-03-deep-q-networks.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/stochastic-expatriate-descent/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-03-deep-q-networks.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Motivation">Motivation<a class="anchor-link" href="#Motivation"> </a></h2><p>I am currently using my COVID-19 imposed quarantine to expand my deep learning skills by completing the <a href="https://www.udacity.com/course/deep-reinforcement-learning-nanodegree--nd893"><em>Deep Reinforcement Learning Nanodegree</em></a> from <a href="https://www.udacity.com/">Udacity</a>. This past week I have been working my way through the seminal 2015 <em>Nature</em> paper from researchers at <a href="https://deepmind.com/">Deepmind</a> <a href="https://storage.googleapis.com/deepmind-media/dqn/DQNNaturePaper.pdf"><em>Human-level control through deep reinforcement learning</em></a> (Minh et al 2015).</p>
<h3 id="Why-is-Minh-et-al-2015-important?">Why is Minh et al 2015 important?<a class="anchor-link" href="#Why-is-Minh-et-al-2015-important?"> </a></h3><p>While Minh et al 2015 was not the first paper to use neural networks to approximate the action-value function, this paper was the first to demonstrate that the same neural network architecture could be trained in a computationally efficient manner to "solve" a large number or different tasks.</p>
<p>The paper also contributed several practical "tricks" for getting deep neural networks to consistently converge during training. This was a non-trivial contribution as issues with training convergence had plaugued previous attempts to use neural networks as function approximators in reinforcement learning tasks and were blocking widespread adoption of deep learning techniques within the reinforcemnt learning community.</p>
<h2 id="Summary-of-the-paper">Summary of the paper<a class="anchor-link" href="#Summary-of-the-paper"> </a></h2><p>Minh et al 2015 uses deep (convolutional) neural network to approximate the optimal action-value function</p>
<p>
$$ Q^*(s, a) = \max_{\pi} \mathbb{E}\Bigg[\sum_{s=0}^{\infty} \gamma^s r_{t+s} | s_t=s, a_t=a, \pi \Bigg] $$
</p>
<p>which is the maximum sum of rewards $r_t$ discounted by $\gamma$ at each time-step $t$ achievable by a behaviour policy $\pi = P(a|s)$, after making an observation of the state $s$ and taking an action $a$.</p>
<p>Prior to this seminal paper it was well known that standard reinforcement learning algorithms were unstable or even diverged when a non-linear function approximators such as a neural networks were used to represent the action-value function $Q$. Why?</p>
<p>Minh et al 2015 discuss several reasons.</p>
<ol>
<li>Correlations present in the sequence of observations of the state $s$. In reinforcement learning applications the sequence state observations is a time-series which will almost surely be auto-correlated. But surely this would also be true of any application of deep neural networks to model time series data. </li>
<li>Small updates to $Q$ may significantly change the policy, $\pi$ and therefore change the data distribution.</li>
<li>Correlations between the action-values, $Q$, and the target values $r + \gamma \max_{a'} Q(s', a')$</li>
</ol>
<p>In the paper the authors address these issues by using...</p>
<ul>
<li>a biologically inspired mechanism they refer to as <em>experience replay</em> that randomizes over the data which removes correlations in the sequence of observations of the state $s$ and smoothes over changes in the data distribution (issues 1 and 2 above).</li>
<li>an iterative update rule that adjusts the action-values, $Q$, towards target values, $Q'$ that are only periodically updated thereby reducing correlations with the target (issue 3 above).</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Approximating-the-action-value-function,-$Q(s,a)$">Approximating the action-value function, $Q(s,a)$<a class="anchor-link" href="#Approximating-the-action-value-function,-$Q(s,a)$"> </a></h3><p>There are several possible ways of approximating the action-value function $Q$ using a neural network. The only input to the DQN architecture is the state representation and the output layer has a separate output for each possible action. The output units correspond to the predicted $Q$-values of the individual actions for the input state. A representaion of the DQN architecture from the paper is reproduced in the figure below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/stochastic-expatriate-descent/images/copied_from_nb/my_icons/q-network-architecture.jpg" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The input to the neural network consists of an 84 x 84 x 4 image produced by the preprocessing map $\phi$. The network has four hidden layers:</p>
<ul>
<li>Convolutional layer with 32 filters (each of which uses an 8 x 8 kernel and a stride of 4) and a ReLU activation function. </li>
<li>Convolutional layer with 64 filters (each of which using a 4 x 4 kernel with stride of 2) and a ReLU activation function. </li>
<li>Convolutional layer with 64 filters (each of which uses a 3 x 3 kernel and a stride of 1) and a ReLU activation function. </li>
<li>Fully-connected (i.e., dense) layer with 512 neurons followed by a ReLU activation function.</li>
</ul>
<p>The output layer is another fully-connected layer with a single output for each action. A PyTorch implementation of the DQN architecture would look something like the following.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>


<span class="n">QNetwork</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span>


<span class="k">class</span> <span class="nc">LambdaLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_f</span> <span class="o">=</span> <span class="n">f</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">make_deep_q_network_fn</span><span class="p">(</span><span class="n">action_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">QNetwork</span><span class="p">]:</span>
    
    <span class="k">def</span> <span class="nf">deep_q_network_fn</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">QNetwork</span><span class="p">:</span>
        <span class="n">q_network</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">LambdaLayer</span><span class="p">(</span><span class="k">lambda</span> <span class="n">tensor</span><span class="p">:</span> <span class="n">tensor</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">25024</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">action_size</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">q_network</span>
    
    <span class="k">return</span> <span class="n">deep_q_network_fn</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Loss-Function">The Loss Function<a class="anchor-link" href="#The-Loss-Function"> </a></h3><p>The $Q$-learning update at iteration $i$ uses the following loss function</p>
<p>
$$ \mathcal{L_i}(\theta_i) = \mathbb{E}_{(s, a, r, s') \sim U(D)} \Bigg[\bigg(r + \gamma \max_{a'} Q\big(s', a'; \theta_i^{-}\big) - Q\big(s, a; \theta_i\big)\bigg)^2\Bigg] $$
</p>
<p>where $\gamma$ is the discount factor determining the agent’s horizon, $\theta_i$ are the parameters of the $Q$-network at iteration $i$ and $\theta_i^{-}$ are the $Q$-network parameters used to compute the target at iteration $i$. The target network parameters $\theta_i^{-}$ are only updated with the $Q$-network parameters $\theta_i$ every $C$ steps and are held fixed between individual updates.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Experience-Replay">Experience Replay<a class="anchor-link" href="#Experience-Replay"> </a></h3><p>To perform <em>experience replay</em> the authors store the agent's experiences $e_t$ as represented by the tuple</p>
<p>
$$ e_t = (s_t, a_t, r_t, s_{t+1}) $$
</p>
<p>consisting of the observed state in period $t$, the reward received in period $t$, the action taken in period $t$, and the resulting state in period $t+1$. The dataset of agent experiences at period $t$ consists of the set of past experiences.</p>
<p>
$$ D_t = \{e1, e2, ..., e_t \} $$
</p>
<p>Depending on the task it may note be feasible for the agent to store the entire history of past experiences.</p>
<p>During learning Q-learning updates are computed based on samples (or minibatches) of experience $(s,a,r,s')$, drawn uniformly at random from the pool of stored samples $D_t$.</p>
<p>The following is my Python implmentation of these ideas.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">_field_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;state&quot;</span><span class="p">,</span>
    <span class="s2">&quot;action&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reward&quot;</span><span class="p">,</span>
    <span class="s2">&quot;next_state&quot;</span><span class="p">,</span>
    <span class="s2">&quot;done&quot;</span>
<span class="p">]</span>
<span class="n">Experience</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;Experience&quot;</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">_field_names</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ExperienceReplayBuffer</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fixed-size buffer to store experience tuples.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">buffer_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">random_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an ExperienceReplayBuffer object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        buffer_size (int): maximum size of buffer</span>
<span class="sd">        batch_size (int): size of each training batch</span>
<span class="sd">        seed (int): random seed</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="n">buffer_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">buffer_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">()</span> <span class="k">if</span> <span class="n">random_state</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random_state</span>
        
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">batch_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_size</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">buffer_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span>

    <span class="k">def</span> <span class="nf">is_full</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span>
    
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experience</span><span class="p">:</span> <span class="n">Experience</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a new experience to memory.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">experience</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Experience</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Randomly sample a batch of experiences from memory.&quot;&quot;&quot;</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch_size</span><span class="p">)</span>
        <span class="n">experiences</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">experiences</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Deep-Q-Network-Algorithm">The Deep Q-Network Algorithm<a class="anchor-link" href="#The-Deep-Q-Network-Algorithm"> </a></h3><p>The following is Python pseudo-code for the Deep Q-Network (DQN) algorithm. For more fine-grained details of the DQN algorithm see the methods section of <a href="https://storage.googleapis.com/deepmind-media/dqn/DQNNaturePaper.pdf">Minh et al 2015</a>.</p>
<div class="highlight"><pre><span></span><span class="c1"># hyper-parameters</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># number of experience tuples used in computing the gradient descent parameter update.</span>
<span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># number of experience tuples stored in the replay buffer</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.99</span> <span class="c1"># discount factor used in the Q-learning update</span>
<span class="n">target_network_update_frequency</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># frequency (measured in parameter updates) with which target network is updated.</span>
<span class="n">update_frequency</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># frequency (measured in number of timesteps) with which q-network parameters are updated.</span>

<span class="c1"># initilizing the various data structures</span>
<span class="n">replay_buffer</span> <span class="o">=</span> <span class="n">ExperienceReplayBuffer</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">buffer_size</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
<span class="n">local_q_network</span> <span class="o">=</span> <span class="n">initialize_q_network</span><span class="p">()</span>
<span class="n">target_q_network</span> <span class="o">=</span> <span class="n">initialize_q_network</span><span class="p">()</span>
<span class="n">synchronize_q_networks</span><span class="p">(</span><span class="n">target_q_network</span><span class="p">,</span> <span class="n">local_q_network</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_episodes</span><span class="p">)</span>

    <span class="c1"># initialize the environment state</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="c1"># simulate a single training episode</span>
    <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">timesteps</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">parameter_updates</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>

        <span class="c1"># greedy action based on Q(s, a; theta)</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">choose_epsilon_greedy_action</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> 

        <span class="c1"># update the environment based on the chosen action</span>
        <span class="n">next_state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="c1"># agent records experience in its replay buffer</span>
        <span class="n">experience</span> <span class="o">=</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">next_state</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">replay_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">experience</span><span class="p">)</span>

        <span class="c1"># agent samples a mini-batch of experiences from its replay buffer</span>
        <span class="n">experiences</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">replay_buffer</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="n">states</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">next_states</span><span class="p">,</span> <span class="n">dones</span> <span class="o">=</span> <span class="n">experiences</span>

        <span class="c1"># agent learns every update_frequency timesteps</span>
        <span class="k">if</span> <span class="n">timesteps</span> <span class="o">%</span> <span class="n">update_frequency</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="c1"># compute the Q^- values using the Q-learning formula</span>
            <span class="n">target_q_values</span> <span class="o">=</span> <span class="n">q_learning_update</span><span class="p">(</span><span class="n">target_q_network</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">next_states</span><span class="p">,</span> <span class="n">dones</span><span class="p">)</span>

            <span class="c1"># compute the Q values</span>
            <span class="n">local_q_values</span> <span class="o">=</span> <span class="n">local_q_network</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">actions</span><span class="p">)</span>

            <span class="c1"># agent updates the parameters theta using gradient descent</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">target_q_values</span><span class="p">,</span> <span class="n">local_q_values</span><span class="p">)</span>
            <span class="n">gradient_descent_update</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>

            <span class="n">parameter_updates</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># every target_network_update_frequency timesteps set theta^- = theta</span>
        <span class="k">if</span> <span class="n">parameter_updates</span> <span class="o">%</span> <span class="n">target_network_update_frequency</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">synchronize_q_networks</span><span class="p">(</span><span class="n">target_q_network</span><span class="p">,</span> <span class="n">local_q_network</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Solving-the-LunarLander-v2-environment">Solving the <code>LunarLander-v2</code> environment<a class="anchor-link" href="#Solving-the-LunarLander-v2-environment"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Google-Colab-Preamble">Google Colab Preamble<a class="anchor-link" href="#Google-Colab-Preamble"> </a></h3><p>If you are playing around with this notebook on Google Colab, then you will need to run the following cell in order to install the required OpenAI dependencies into the environment.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>%%bash

<span class="c1"># install required system dependencies</span>
apt-get install -y xvfb x11-utils

<span class="c1"># install required python dependencies (might need to install additional gym extras depending)</span>
pip install gym<span class="o">[</span>box2d<span class="o">]==</span><span class="m">0</span>.17.* <span class="nv">pyvirtualdisplay</span><span class="o">==</span><span class="m">0</span>.2.* <span class="nv">PyOpenGL</span><span class="o">==</span><span class="m">3</span>.1.* PyOpenGL-accelerate<span class="o">==</span><span class="m">3</span>.1.*
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The code in the cell below creates a virtual display in the background that your Gym Envs can connect to for rendering. You can adjust the size of the virtual buffer as you like but you must set <code>visible=False</code>.</p>
<p><strong>This code only needs to be run once per session to start the display.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pyvirtualdisplay</span>


<span class="n">_display</span> <span class="o">=</span> <span class="n">pyvirtualdisplay</span><span class="o">.</span><span class="n">Display</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># use False with Xvfb</span>
                                    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1400</span><span class="p">,</span> <span class="mi">900</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">_display</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Binder-Preamble">Binder Preamble<a class="anchor-link" href="#Binder-Preamble"> </a></h3><p>If you are running this code on Binder, then there isn't really much to do as all the software is pre-installed. However you do still need to run the code in the cell below to creates a virtual display in the background that your Gym Envs can connect to for rendering. You can adjust the size of the virtual buffer as you like but you must set <code>visible=False</code>.</p>
<p><em>This code only needs to be run once per session to start the display.</em></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pyvirtualdisplay</span>


<span class="n">_display</span> <span class="o">=</span> <span class="n">pyvirtualdisplay</span><span class="o">.</span><span class="n">Display</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># use False with Xvfb</span>
                                    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1400</span><span class="p">,</span> <span class="mi">900</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">_display</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Creating-the-Gym-environment">Creating the Gym environment<a class="anchor-link" href="#Creating-the-Gym-environment"> </a></h3><p>In the rest of this blog post I will use the DQN algorithm to train an agent to solve the <a href="https://gym.openai.com/envs/LunarLander-v2/">LunarLander-v2</a> environment from <a href="https://openai.com/">OpenAI</a>.</p>
<p>In this environment the landing pad is always at coordinates (0,0). The reward for moving the lander from the top of the screen to landing pad and arriving at zero speed is typically between 100 and 140 points. Firing the main engine is -0.3 points each frame (so the lander is incentivized to fire the engine as few times possible). If the lander moves away from landing pad it loses reward (so the lander is incentived to land in the designated landing area). The lander is also incentived to land "gracefully" (and not crash in the landing area!).</p>
<p>A training episode finishes if the lander crashes (-100 points) or comes to rest (+100 points). Each leg with ground contact receives and additional +10 points. The task is considered "solved" if the lander is able to achieve 200 points (I will actually be more stringent and define "solved" as achieving over 200 points on average in the most recent 100 training episodes).</p>
<h4 id="Action-Space">Action Space<a class="anchor-link" href="#Action-Space"> </a></h4><p>There are four discrete actions available:</p>
<ol>
<li>Do nothing.</li>
<li>Fire the left orientation engine.</li>
<li>Fire main engine.</li>
<li>Fire the right orientation engine.</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">gym</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;LunarLander-v2&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-3-9d3fa797859f&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">import</span> gym
<span class="ansi-green-intense-fg ansi-bold">      2</span> 
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg"> </span>env <span class="ansi-blue-fg">=</span> gym<span class="ansi-blue-fg">.</span>make<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;LunarLander-v2&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> _ <span class="ansi-blue-fg">=</span> env<span class="ansi-blue-fg">.</span>seed<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">42</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Research/stochastic-expatriate-descent/env/lib/python3.7/site-packages/gym/envs/registration.py</span> in <span class="ansi-cyan-fg">make</span><span class="ansi-blue-fg">(id, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    140</span> 
<span class="ansi-green-intense-fg ansi-bold">    141</span> <span class="ansi-green-fg">def</span> make<span class="ansi-blue-fg">(</span>id<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 142</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> registry<span class="ansi-blue-fg">.</span>make<span class="ansi-blue-fg">(</span>id<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    143</span> 
<span class="ansi-green-intense-fg ansi-bold">    144</span> <span class="ansi-green-fg">def</span> spec<span class="ansi-blue-fg">(</span>id<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/Research/stochastic-expatriate-descent/env/lib/python3.7/site-packages/gym/envs/registration.py</span> in <span class="ansi-cyan-fg">make</span><span class="ansi-blue-fg">(self, path, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     85</span>             logger<span class="ansi-blue-fg">.</span>info<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Making new env: %s&#39;</span><span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     86</span>         spec <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>spec<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 87</span><span class="ansi-red-fg">         </span>env <span class="ansi-blue-fg">=</span> spec<span class="ansi-blue-fg">.</span>make<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     88</span>         <span class="ansi-red-fg"># We used to have people override _reset/_step rather than</span>
<span class="ansi-green-intense-fg ansi-bold">     89</span>         <span class="ansi-red-fg"># reset/step. Set _gym_disable_underscore_compat = True on</span>

<span class="ansi-green-fg">~/Research/stochastic-expatriate-descent/env/lib/python3.7/site-packages/gym/envs/registration.py</span> in <span class="ansi-cyan-fg">make</span><span class="ansi-blue-fg">(self, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     56</span>             env <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>entry_point<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>_kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     57</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 58</span><span class="ansi-red-fg">             </span>cls <span class="ansi-blue-fg">=</span> load<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>entry_point<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     59</span>             env <span class="ansi-blue-fg">=</span> cls<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>_kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     60</span> 

<span class="ansi-green-fg">~/Research/stochastic-expatriate-descent/env/lib/python3.7/site-packages/gym/envs/registration.py</span> in <span class="ansi-cyan-fg">load</span><span class="ansi-blue-fg">(name)</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span>     mod_name<span class="ansi-blue-fg">,</span> attr_name <span class="ansi-blue-fg">=</span> name<span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;:&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span>     mod <span class="ansi-blue-fg">=</span> importlib<span class="ansi-blue-fg">.</span>import_module<span class="ansi-blue-fg">(</span>mod_name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 18</span><span class="ansi-red-fg">     </span>fn <span class="ansi-blue-fg">=</span> getattr<span class="ansi-blue-fg">(</span>mod<span class="ansi-blue-fg">,</span> attr_name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     19</span>     <span class="ansi-green-fg">return</span> fn
<span class="ansi-green-intense-fg ansi-bold">     20</span> 

<span class="ansi-red-fg">AttributeError</span>: module &#39;gym.envs.box2d&#39; has no attribute &#39;LunarLander&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Defining-a-generic-Agent-and-train-loop">Defining a generic <code>Agent</code> and <code>train</code> loop<a class="anchor-link" href="#Defining-a-generic-Agent-and-train-loop"> </a></h3><p>In the cell below I define a fairly generic training loop for training and <code>Agent</code> to solve a task in a given <code>gym.Env</code> environment. In working through the hands-on portions of the <a href="https://www.udacity.com/">Udacity</a> <a href="https://www.udacity.com/course/deep-reinforcement-learning-nanodegree--nd893"><em>Deep Reinforcement Learning Nanodegree</em></a> I found myself writing similar code over and over again to train the agent to solve a task. This is my first attempt to write something that I might be able to reuse on the course going forward.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Agent</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="nf">choose_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Rule for choosing an action given the current state of the environment.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Save any important agent state to a file.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        
    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
             <span class="n">action</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">reward</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
             <span class="n">next_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
             <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Update agent&#39;s state after observing the effect of its action on the environment.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">NotImplmentedError</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_train_for_at_most</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">Agent</span><span class="p">,</span> <span class="n">env</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">,</span> <span class="n">max_timesteps</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Train agent for a maximum number of timesteps.&quot;&quot;&quot;</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_timesteps</span><span class="p">):</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">choose_action</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">next_state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">next_state</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">next_state</span>
        <span class="n">score</span> <span class="o">+=</span> <span class="n">reward</span>
        <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">score</span>

                
<span class="k">def</span> <span class="nf">_train_until_done</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">Agent</span><span class="p">,</span> <span class="n">env</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Train the agent until the current episode is complete.&quot;&quot;&quot;</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">choose_action</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">next_state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">next_state</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">next_state</span>
        <span class="n">score</span> <span class="o">+=</span> <span class="n">reward</span>
    <span class="k">return</span> <span class="n">score</span>


<span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">Agent</span><span class="p">,</span>
          <span class="n">env</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">,</span>
          <span class="n">checkpoint_filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
          <span class="n">target_score</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
          <span class="n">number_episodes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
          <span class="n">maximum_timesteps</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reinforcement learning training loop.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    agent (Agent): an agent to train.</span>
<span class="sd">    env (gym.Env): an environment in which to train the agent.</span>
<span class="sd">    checkpoint_filepath (str): filepath used to save the state of the trained agent.</span>
<span class="sd">    number_episodes (int): maximum number of training episodes.</span>
<span class="sd">    maximum_timsteps (int): maximum number of timesteps per episode.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    scores (list): collection of episode scores from training.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">most_recent_scores</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_episodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">maximum_timesteps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">_train_until_done</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">_train_for_at_most</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">maximum_timesteps</span><span class="p">)</span>         
        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
        <span class="n">most_recent_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
        
        <span class="n">average_score</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">most_recent_scores</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">most_recent_scores</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">average_score</span> <span class="o">&gt;=</span> <span class="n">target_score</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Environment solved in </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> episodes!</span><span class="se">\t</span><span class="s2">Average Score: </span><span class="si">{</span><span class="n">average_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">checkpoint_filepath</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">Episode </span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="se">\t</span><span class="s2">Average Score: </span><span class="si">{</span><span class="n">average_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scores</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Creating-a-DeepQAgent">Creating a <code>DeepQAgent</code><a class="anchor-link" href="#Creating-a-DeepQAgent"> </a></h3><p>The code in the cell below encapsulates much of the logic of the DQN algorithm in a <code>DeepQAgent</code> class. Since the <code>LunarLander-v2</code> task is not well suited for convolutional neural networks, the agent uses a simple three layer dense neural network with ReLU activation functions to approximate the action-value function $Q$.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">optim</span>
<span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">F</span>


<span class="k">class</span> <span class="nc">DeepQAgent</span><span class="p">(</span><span class="n">Agent</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">state_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">action_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">number_hidden_units</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">optimizer_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">]],</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">],</span>
                 <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">buffer_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">epsilon_decay_schedule</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span>
                 <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                 <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                 <span class="n">update_frequency</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a DeepQAgent.</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        state_size (int): the size of the state space.</span>
<span class="sd">        action_size (int): the size of the action space.</span>
<span class="sd">        number_hidden_units (int): number of units in the hidden layers.</span>
<span class="sd">        optimizer_fn (callable): function that takes Q-network parameters and returns an optimizer.</span>
<span class="sd">        batch_size (int): number of experience tuples in each mini-batch.</span>
<span class="sd">        buffer_size (int): maximum number of experience tuples stored in the replay buffer.</span>
<span class="sd">        epsilon_decay_schdule (callable): function that takes episode number and returns epsilon.</span>
<span class="sd">        alpha (float): rate at which the target q-network parameters are updated.</span>
<span class="sd">        gamma (float): Controls how much that agent discounts future rewards (0 &lt; gamma &lt;= 1).</span>
<span class="sd">        update_frequency (int): frequency (measured in time steps) with which q-network parameters are updated.</span>
<span class="sd">        seed (int): random seed</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state_size</span> <span class="o">=</span> <span class="n">state_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action_size</span> <span class="o">=</span> <span class="n">action_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
        
        <span class="c1"># set seeds for reproducibility</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">()</span> <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1"># initialize agent hyperparameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_experience_replay_buffer</span> <span class="o">=</span> <span class="n">ExperienceReplayBuffer</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">buffer_size</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon_decay_schedule</span> <span class="o">=</span> <span class="n">epsilon_decay_schedule</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gamma</span> <span class="o">=</span> <span class="n">gamma</span>
        
        <span class="c1"># initialize Q-Networks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_frequency</span> <span class="o">=</span> <span class="n">update_frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_q_network</span><span class="p">(</span><span class="n">number_hidden_units</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target_q_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_q_network</span><span class="p">(</span><span class="n">number_hidden_units</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_synchronize_q_networks</span><span class="p">()</span>
        
        <span class="c1"># send the networks to the device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_device</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target_q_network</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_device</span><span class="p">)</span>
        
        <span class="c1"># initialize the optimizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span> <span class="o">=</span> <span class="n">optimizer_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

        <span class="c1"># initialize some counters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_episodes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_timesteps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_parameter_updates</span> <span class="o">=</span> <span class="mi">0</span>
        
    <span class="k">def</span> <span class="nf">_initialize_q_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_hidden_units</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a neural network for approximating the action-value function.&quot;&quot;&quot;</span>
        <span class="n">q_network</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_state_size</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">number_hidden_units</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="n">number_hidden_units</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">number_hidden_units</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="n">number_hidden_units</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_action_size</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">q_network</span>
        
    <span class="k">def</span> <span class="nf">_learn_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiences</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Experience</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Heart of the Deep Q-learning algorithm.&quot;&quot;&quot;</span>
        <span class="n">states</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">next_states</span><span class="p">,</span> <span class="n">dones</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">vs</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_device</span><span class="p">)</span> <span class="k">for</span> <span class="n">vs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">experiences</span><span class="p">))</span>
        
        <span class="c1"># get max predicted Q values (for next states) from target model</span>
        <span class="n">next_target_q_values</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_target_q_network</span><span class="p">(</span><span class="n">next_states</span><span class="p">)</span>
                                       <span class="o">.</span><span class="n">detach</span><span class="p">()</span>
                                       <span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="c1"># compute the new Q&#39; values using the Q-learning formula</span>
        <span class="n">target_q_values</span> <span class="o">=</span> <span class="n">rewards</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gamma</span> <span class="o">*</span> <span class="n">next_target_q_values</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">dones</span><span class="p">))</span>
        
        <span class="c1"># get expected Q values from local model</span>
        <span class="n">_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">actions</span><span class="o">.</span><span class="n">long</span><span class="p">()</span>
                         <span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">expected_q_values</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
                                 <span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">_index</span><span class="p">))</span>
        <span class="c1"># compute the mean squared loss</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">expected_q_values</span><span class="p">,</span> <span class="n">target_q_values</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="c1"># agent updates the parameters theta of Q using gradient descent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_soft_update_target_q_network_parameters</span><span class="p">()</span>
                 
    <span class="k">def</span> <span class="nf">_soft_update_target_q_network_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Soft-update of target q-network parameters with the local q-network parameters.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">target_param</span><span class="p">,</span> <span class="n">local_param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_target_q_network</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span><span class="o">.</span><span class="n">parameters</span><span class="p">()):</span>
            <span class="n">target_param</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha</span> <span class="o">*</span> <span class="n">local_param</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">target_param</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_synchronize_q_networks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Synchronize the target_q_network and the local_q_network.&quot;&quot;&quot;</span>
        <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target_q_network</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
           
    <span class="k">def</span> <span class="nf">_uniform_random_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Choose an action uniformly at random.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_action_size</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_greedy_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Choose an action that maximizes the action_values given the current state.&quot;&quot;&quot;</span>
        <span class="c1"># evaluate the network to compute the action values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">action_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        
        <span class="c1"># choose the greedy action</span>
        <span class="n">action</span> <span class="o">=</span> <span class="p">(</span><span class="n">action_values</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>  <span class="c1"># action_values might reside on the GPU!</span>
                               <span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
                               <span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">action</span>
    
    <span class="k">def</span> <span class="nf">_epsilon_greedy_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;With probability epsilon explore randomly; otherwise exploit knowledge optimally.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uniform_random_policy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_greedy_policy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">action</span>

    <span class="k">def</span> <span class="nf">choose_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the action for given state as per current policy.</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        state (np.array): current state of the environment.</span>
<span class="sd">        </span>
<span class="sd">        Return:</span>
<span class="sd">        --------</span>
<span class="sd">        action (int): an integer representing the chosen action.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># need to reshape state array and convert to tensor</span>
        <span class="n">state_tensor</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
                             <span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                             <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_device</span><span class="p">))</span>
            
        <span class="c1"># choose uniform at random if agent has insufficient experience</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_sufficient_experience</span><span class="p">():</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uniform_random_policy</span><span class="p">(</span><span class="n">state_tensor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">epsilon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon_decay_schedule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_episodes</span><span class="p">)</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon_greedy_policy</span><span class="p">(</span><span class="n">state_tensor</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">action</span>
    
    <span class="k">def</span> <span class="nf">has_sufficient_experience</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;True if agent has enough experience to train on a batch of samples; False otherwise.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_experience_replay_buffer</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_experience_replay_buffer</span><span class="o">.</span><span class="n">batch_size</span>
    
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the state of the DeepQAgent.</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        filepath (str): filepath where the serialized state should be saved.</span>
<span class="sd">        </span>
<span class="sd">        Notes:</span>
<span class="sd">        ------</span>
<span class="sd">        The method uses `torch.save` to serialize the state of the q-network, </span>
<span class="sd">        the optimizer, as well as the dictionary of agent hyperparameters.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">checkpoint</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;q-network-state&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_local_q_network</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
            <span class="s2">&quot;optimizer-state&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
            <span class="s2">&quot;agent-hyperparameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha</span><span class="p">,</span>
                <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_experience_replay_buffer</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
                <span class="s2">&quot;buffer_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_experience_replay_buffer</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">,</span>
                <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gamma</span><span class="p">,</span>
                <span class="s2">&quot;update_frequency&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_frequency</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reward</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">next_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the agent&#39;s state based on feedback received from the environment.</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        state (np.array): the previous state of the environment.</span>
<span class="sd">        action (int): the action taken by the agent in the previous state.</span>
<span class="sd">        reward (float): the reward received from the environment.</span>
<span class="sd">        next_state (np.array): the resulting state of the environment following the action.</span>
<span class="sd">        done (bool): True is the training episode is finised; false otherwise.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># save experience in the experience replay buffer</span>
        <span class="n">experience</span> <span class="o">=</span> <span class="n">Experience</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">next_state</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_experience_replay_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">experience</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_number_episodes</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_number_timesteps</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="c1"># every so often the agent should learn from experiences</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_timesteps</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_frequency</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_sufficient_experience</span><span class="p">():</span>
                <span class="n">experiences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_experience_replay_buffer</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_learn_from</span><span class="p">(</span><span class="n">experiences</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Epsilon-decay-schedule">Epsilon decay schedule<a class="anchor-link" href="#Epsilon-decay-schedule"> </a></h4><p>In the DQN algorithm the agent chooses its action using an $\epsilon$-greedy policy. When using an $\epsilon$-greedy policy, with probability $\epsilon$, the agent explores the state space by choosing an action uniformly at random from the set of feasible actions; with probability $1-\epsilon$, the agent exploits its current knowledge by choosing the optimal action given that current state.</p>
<p>As the agent learns and acquires additional knowledge about it environment it makes sense to <em>decrease</em> exploration and <em>increase</em> exploitation by decreasing $\epsilon$. In practice, it isn't a good idea to decrease $\epsilon$ to zero; instead one typically decreases $\epsilon$ over time according to some schedule until it reaches some minimum value.</p>
<p>The Deepmind researchers used a simple linear decay schedule and set a minimum value of $\epsilon=0.1$. In the cell below I code up a linear decay schedule as well as a power decay schedule that I have seen used in many other practical applications.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">linear_decay_schedule</span><span class="p">(</span><span class="n">episode_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                          <span class="n">slope</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                          <span class="n">minimum_epsilon</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Simple linear decay schedule used in the Deepmind paper.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">episode_number</span><span class="p">,</span> <span class="n">minimum_epsilon</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">power_decay_schedule</span><span class="p">(</span><span class="n">episode_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                         <span class="n">decay_factor</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                         <span class="n">minimum_epsilon</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Power decay schedule found in other practical applications.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">decay_factor</span><span class="o">**</span><span class="n">episode_number</span><span class="p">,</span> <span class="n">minimum_epsilon</span><span class="p">)</span>

<span class="n">_epsilon_decay_schedule_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;decay_factor&quot;</span><span class="p">:</span> <span class="mf">0.995</span><span class="p">,</span>
    <span class="s2">&quot;minimum_epsilon&quot;</span><span class="p">:</span> <span class="mf">1e-2</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">epsilon_decay_schedule</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">power_decay_schedule</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">_epsilon_decay_schedule_kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Choosing-an-optimizer">Choosing an optimizer<a class="anchor-link" href="#Choosing-an-optimizer"> </a></h4><p>As is the case in training any neural network, the choice of optimizer and the tuning of its hyper-parameters (in particular the learning rate) is important. Here I am going to more or less follow the Minh et al 2015 paper and use the <a href="https://pytorch.org/docs/stable/optim.html#torch.optim.RMSprop">RMSProp</a> optimizer.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_optimizer_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">1e-2</span><span class="p">,</span>
    <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
    <span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">1e-08</span><span class="p">,</span>
    <span class="s2">&quot;weight_decay&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;momentum&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;centered&quot;</span><span class="p">:</span> <span class="kc">False</span>
<span class="p">}</span>
<span class="n">optimizer_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">RMSprop</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">_optimizer_kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this point I am ready to create an instance of the <code>DeepQAgent</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_agent_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;state_size&quot;</span><span class="p">:</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;action_size&quot;</span><span class="p">:</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> 
    <span class="s2">&quot;number_hidden_units&quot;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
    <span class="s2">&quot;optimizer_fn&quot;</span><span class="p">:</span> <span class="n">optimizer_fn</span><span class="p">,</span>
    <span class="s2">&quot;epsilon_decay_schedule&quot;</span><span class="p">:</span> <span class="n">epsilon_decay_schedule</span><span class="p">,</span>
    <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
    <span class="s2">&quot;buffer_size&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
    <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span>
    <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
    <span class="s2">&quot;update_frequency&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">deep_q_agent</span> <span class="o">=</span> <span class="n">DeepQAgent</span><span class="p">(</span><span class="o">**</span><span class="n">_agent_kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Performance-of-an-un-trained-DeepQAgent">Performance of an un-trained <code>DeepQAgent</code><a class="anchor-link" href="#Performance-of-an-un-trained-DeepQAgent"> </a></h3><p>The function <code>simulate</code> defined in the cell below can be used to simuate an agent interacting with and environment for one episode.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span>


<span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">Agent</span><span class="p">,</span> <span class="n">env</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">))</span>
    <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">choose_action</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">img</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">))</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
        <span class="n">display</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>       
    <span class="n">env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The untrained agent behaves erratically (not quite randomly!) and performs poorly. Lots of room for improvement!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">simulate</span><span class="p">(</span><span class="n">deep_q_agent</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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nwcAfRLP4QFc4vP5lJ2drfvvv18tLS267bbbJKl9Hax16/6vYrGotlU8q11VLygaC8lxYopGw906fjjcovXrn1Rz6IQ+PP7/dLBugyKxVu3es0Zr1vxEn332KbGTAL21jhmAnrHO8oeTP7lALzn1Z3HGjBnasWOHpLbbYNdd13b1p6mpRhs2PNXj42Zm5qm09A4dPbpTu3a9Eb+BcUaWZbX/LKPRqCKRiMsTAWbz+/2qrKxUVlaWrNO/Bvs5BA8AJMjKlSt1zz33dNhWV1enaJSV4YF4yMzM1K5duzR69OhTmwgeAOgLZs2apQMH/vaEbMdxdPDgmR8iCeDMhg0bpkGDBun111/XlClTTt9F8ABAX9TU1KSrr766w7aKigqVl/McJOBMRo0apaeeekpf+9rXzrSb4AGA/mLVqlVavnx5h23r1q1TSwsfMsfANWLECE2bNk233367br755s5eRvAAQH+2ZMkS1dX97VlJzc3NWvm5J3cDpsrNzdUPf/hDffvb3z7bSwkeADBJIBDQY4891mHbO++8o82bN7s0ERB/aWlpuvfee5Wfn6877rijO28heADAdO+99177Iw1OWbx4sYLBoEsTAefO7/frt7/9rW6//faevI3gAYCBaM2aNQqH//awysrKSi1atMjFiYCzsyxLq1ev7uyDyV2+tdMdBA8ADBwtLS3avn17h21Lly7V6tWrXZoI6Ojtt99WWlqaZsyYcS5vJ3gAAGdWVVWlhoaGDtumTJmi1tZWlybCQLVx40aVlpbK4znnla8IHgBA9504caLDumC7d+/WzJkze+38c+bM+buv5veWefPmadOmTa6ce6B69dVXdcUVV2jw4MGybft8DkXwAADOXSwW69UrPrZty+/399r5Ttfa2qpYLKbx48fr+PHjrswwkCxfvlwLFiw439A5heABAKAnYrGYpLavRkciERaCjSPLsmTbtpYuXarFixerizU/e3zoTncQPAAAdK25uVl5eXmKRqNqbGx0e5x+zev1auHChXr66acTcXiCBwCA87Vv3z7NmjVLTU1NOnHihNvj9Cu2bWvUqFEqLS1N5FPCCR4AAOLlj3/8o+677z5VVFSoqqrK7XH6PI/Ho1mzZukPf/hDok9F8AAAEG/PPvusXnrpJW3bto0rPp2YNWuW0tLStGrVqt44HcEDAECiPP7449q1a5deffVVNTU1uT1On3HrrbdqxYoV5/NcnZ4ieAAASLSlS5eqtrZWjz76aPu3vAaq7373u3r88cd7+/ECBA8AAL3lySefVGtrq+677z63R+l1d999twoKCvTNb35TqampvX16ggcAgN4UjUb1yiuvqKqqSvfcc4/b4/SKxYsX64EHHtCwYcPcGoHgAQDADcFgUO+9957effddPfjgg26PkxALFizQnXfeqaKiIjdjRyJ4AABwVyAQ0JEjR7Rs2TL9+te/dnucuLnpppu0bNky5eTkuD2KRPAAANA3BAIBNTY2auHChVq7dq3b45yzqVOn6q233lJKSoqysrLcHucUggcAgL4kGAwqGo2qpKRE+/fvd3ucHhkzZow++ugjNz6UfDYEDwAAfVE0GpUkZWZmqqWlpf33fZFt28rOzlZlZWW8VjePN4IHAIC+zHEcRSIRZWdny3EcNTc3uz1SB+np6WpoaJCkeK5uHm+dDtZrjz4EAACdsyxLPp9PjY2N2rt3r0aMGKHBgwe7PZZycnI0YsQInThxQpZl9eXY6RJXeAAA6KM2b96sb33rW5KkiooK1dTU9Or5CwoKtH79eo0ePbpXz3seuKUFAEB/9qtf/Uqvvvqqtm/frvr6+oSfb8qUKXr55ZdVWFiY8HPFEcEDAIAJfvSjH6msrEyrV69WS0tL3I8/efJkFRUVacmSJbr44ovjfvwEI3gAADDJI488okAgoCeeeEJn+bu824qLi/Xoo4/qmmuuicvxXEDwAABgokcffVQtLS165JFHzvkY+fn5uuuuu1RSUtKfY0cieAAAMFc4HNaLL76o8vLyHq/XlZubq9/97ne69tprEzRdryJ4AAAwXSAQ0JYtW7Rhwwb97Gc/6/K1fr9fb7zxhtLS0lRaWtpLEyYcwQMAwEBRW1urQ4cO6YknntBzzz33d/sty9K2bdtUUlLiwnQJRfAAADDQ1NXVqaGhQQsWLNCmTZvat+/fv19jx47ttw8R7ALBAwDAQNXU1KRIJNL++4yMDBNjRyJ4AADAAMBaWgAAYOAieAAAgPEIHgAAYDyCBwAAGI/gAQAAxiN4AACA8QgeAABgPIIHAAAYj+ABAADGI3gAAIDxCB4AAGA8ggcAABiP4AEAAMYjeAAAgPEIHgAAYDyCBwAAGI/gAQAAxiN4AACA8QgeAABgPIIHAAAYj+ABAADGI3gAAIDxCB4AAGA8ggcAABiP4AEAAMYjeAAAgPEIHgAAYDyCBwAAGI/gAQAAxiN4AACA8QgeAABgPIIHAAAYj+ABAADGI3gAAIDxCB4AAGA8ggcAABiP4AEAAMYjeAAAgPEIHgAAYDyCBwAAGI/gAQAAxiN4AACA8QgeAABgPIIHAAAYj+ABAADGI3gAAIDxCB4AAGA8ggcAABiP4AEAAMYjeAAAgPEIHgAAYDyCBwAAGI/gAQAAxvOeZb/VK1MAAAAkEFd4AACA8QgeAABgPIIHAAAYj+ABAADGI3gAAIDxCB4AAGC8/w8G9XUaMrMhIgAAAABJRU5ErkJggg==
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-the-DeepQAgent">Training the <code>DeepQAgent</code><a class="anchor-link" href="#Training-the-DeepQAgent"> </a></h3><p>Now I am finally ready to train the <code>deep_q_agent</code>. The target score for the <code>LunarLander-v2</code> environment is 200 points on average for at least 100 consecutive episodes. If the <code>deep_q_agent</code> is able to "solve" the environment, then training will terminate early.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">deep_q_agent</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="s2">&quot;checkpoint.pth&quot;</span><span class="p">,</span> <span class="n">number_episodes</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">target_score</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Episode 100	Average Score: -149.83
Episode 200	Average Score: -103.40
Episode 300	Average Score: -56.31
Episode 400	Average Score: 9.59
Episode 500	Average Score: 82.93
Episode 600	Average Score: 133.17
Episode 700	Average Score: 135.58
Episode 800	Average Score: 128.12
Episode 900	Average Score: 164.59
Episode 1000	Average Score: 180.24
Episode 1100	Average Score: 154.35
Episode 1200	Average Score: 180.69
Episode 1300	Average Score: 180.29

Environment solved in 1388 episodes!	Average Score: 201.22
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Analyzing-DeepQAgent-performance">Analyzing <code>DeepQAgent</code> performance<a class="anchor-link" href="#Analyzing-DeepQAgent-performance"> </a></h3><p>Now that I have trained the agent, let's rerun the simulation to see the difference in performance.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">simulate</span><span class="p">(</span><span class="n">deep_q_agent</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Plotting-the-time-series-of-scores">Plotting the time series of scores<a class="anchor-link" href="#Plotting-the-time-series-of-scores"> </a></h4><p>I can use <a href="https://pandas.pydata.org/">Pandas</a> to quickly plot the time series of scores along with a 100 episode moving average. Note that training stops as soon as the rolling average crosses the target score.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;scores&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scores</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>count    1389.000000
mean       87.963719
std       177.130250
min      -910.040623
25%       -50.965741
50%       157.388679
75%       247.386481
max       320.713969
Name: scores, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scores&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
           <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
           <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Rolling Average&quot;</span><span class="p">)</span>
           <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Target Score&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Episode Number&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Score&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Kernel-density-plot-of-the-scores">Kernel density plot of the scores<a class="anchor-link" href="#Kernel-density-plot-of-the-scores"> </a></h4><p>Kernel density plot of scores is bimodal with one mode less than -100 and a second mode greater than 200. The negative mode corresponds to those training episodes where the agent crash landed and thus scored at most -100; the positive mode corresponds to those training episodes where the agent "solved" the task. The kernel density or scores typically exhibits negative skewness (i.e., a fat left tail): there are lots of ways in which landing the lander can go horribly wrong (resulting in the agent getting a very low score) and only relatively few paths to a gentle landing (and a high score).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;kde&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Score&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Where-to-go-from-here?">Where to go from here?<a class="anchor-link" href="#Where-to-go-from-here?"> </a></h2><p>I am a bit frustrated by lack of stability that I am seeing in my implmentation of the Deep Q algorithm: sometimes the algorithm converges and sometimes not. Perhaps more tuning of hyper-parameters or use of a different optimization algorithm would exhibit better convergence. I have already spent more time than I had allocated on playing around with this agorithm so I am not going to try and fine-tune the hyperparamters or explore alternative optimization algorithms for now.</p>
<p>Rather than spending time tuning hyperparameters I think it would be better use of my time to explore algorithmic improvements. In future posts I plan to cover the following extensions of the DQN algorithm: <a href="https://arxiv.org/abs/1509.06461">Double Q-Learning</a>, <a href="https://arxiv.org/abs/1509.06461">Prioritized Experience Replay</a>, and <a href="https://arxiv.org/abs/1511.06581">Dueling Network Architectures</a></p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="davidrpugh/stochastic-expatriate-descent"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/stochastic-expatriate-descent/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/stochastic-expatriate-descent/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/stochastic-expatriate-descent/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An expat scientist&#39;s musings about machine learning, deep learning, and living abroad.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/davidrpugh" title="davidrpugh"><svg class="svg-icon grey"><use xlink:href="/stochastic-expatriate-descent/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/TheSandyCoder" title="TheSandyCoder"><svg class="svg-icon grey"><use xlink:href="/stochastic-expatriate-descent/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
