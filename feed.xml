<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://davidrpugh.github.io/stochastic-expatriate-descent/feed.xml" rel="self" type="application/atom+xml" /><link href="https://davidrpugh.github.io/stochastic-expatriate-descent/" rel="alternate" type="text/html" /><updated>2020-04-13T04:20:08-05:00</updated><id>https://davidrpugh.github.io/stochastic-expatriate-descent/feed.xml</id><title type="html">Stochastic Expatriate Descent</title><subtitle>An expat scientist's musings about machine learning, deep learning, and living abroad.</subtitle><entry><title type="html">Improving the DQN algorithm using Double Q-Learning</title><link href="https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/11/double-dqn.html" rel="alternate" type="text/html" title="Improving the DQN algorithm using Double Q-Learning" /><published>2020-04-11T00:00:00-05:00</published><updated>2020-04-11T00:00:00-05:00</updated><id>https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/11/double-dqn</id><content type="html" xml:base="https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/11/double-dqn.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-11-double-dqn.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;I am continuing to work my way through the &lt;a href=&quot;https://www.udacity.com/&quot;&gt;Udacity&lt;/a&gt; &lt;a href=&quot;https://www.udacity.com/course/deep-reinforcement-learning-nanodegree--nd893&quot;&gt;&lt;em&gt;Deep Reinforcement Learning Nanodegree&lt;/em&gt;&lt;/a&gt;. In this blog post I discuss and implement the Double DQN algorithm from &lt;a href=&quot;https://arxiv.org/abs/1509.06461&quot;&gt;&lt;em&gt;Deep Reinforcement Learning with Double Q-Learning&lt;/em&gt;&lt;/a&gt; (Van Hasselt et al 2015). The Double DQN algorithm is a minor, but important, modification of the original DQN algorithm that I covered in a &lt;a href=&quot;https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html&quot;&gt;previous post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The Van Hasselt et al 2015 paper makes several important contributions.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Demonstration of how Q-learning can be overly optimistic in large-scale, even 
deterministic, problems due to the inherent estimation errors of learning. &lt;/li&gt;
&lt;li&gt;Demonstration that over-estimations are more common and severe in practice than previously 
acknowledged. &lt;/li&gt;
&lt;li&gt;Implementation of Double Q-learning called Double DQN that extends, with minor 
modifications, the popular DQN algorithm and that can be used at scale to successfully 
reduce over-estimations with the result being more stable and reliable learning.&lt;/li&gt;
&lt;li&gt;Demonstation that Double DQN finds better policies by obtaining new state-of-the-art 
results on the Atari 2600 dataset.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;Why-does-Q-learning-over-estimate-Q-values?&quot;&gt;Why does Q-learning over-estimate Q-values?&lt;a class=&quot;anchor-link&quot; href=&quot;#Why-does-Q-learning-over-estimate-Q-values?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;No matter what type of function approximation scheme used to approximate the action-value function $Q$ there will always be approximation error. The presence of the max operator in the Bellman equation used to compute the $Q$-values means that the approximate $Q$-values will almost always be strictly greater than the corresponding $Q$ value from the true action-value function (i.e., the approximation errors will almost always be positive). This potentially significant source of bias can impede learning and is often exacerbated by the use of flexible, non-linear function approximators such as neural networks. By explicitly separating action selection from action evaluation, double Q-Learning allows each step to use a different function approximator resulting in a better overall approximation of the action-value function. Figure 2 (with caption) below, which is taken from Van Hasselt et al 2015, summarizes these ideas. See the &lt;a href=&quot;https://arxiv.org/pdf/1509.06461.pdf&quot;&gt;paper&lt;/a&gt; for more details.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/stochastic-expatriate-descent/images/copied_from_nb/my_icons/double-dqn-figure-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;Implementing-the-Double-DQN-algorithm&quot;&gt;Implementing the Double DQN algorithm&lt;a class=&quot;anchor-link&quot; href=&quot;#Implementing-the-Double-DQN-algorithm&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The key idea behind Double Q-learning is to reduce over-estimations of Q-values by separating the selection of actions from the evaluation of those actions so that a different Q-network can be used in each step. When applying Double Q-learning to extend the DQN algorithm one can use the online Q-network, $Q(S, a; \theta)$, to select the actions and then the target Q-network, $Q(S, a; \theta^{-})$, to evaluate the selected actions.&lt;/p&gt;
&lt;p&gt;Before implement the Double DQN algorithm, I am going to re-implement the Q-learning update from the DQN algorithm in a way that explicitly separates action selection from action evaluation. Once I have implemented this new version of Q-learning, implementing the Double DQN algorithm will be much easier. Formally separating action selection from action evaluation involves re-writing the Q-learning Bellman equation as follows.&lt;/p&gt;
&lt;p&gt;
$$ Y_t^{DQN} = R_{t+1} + \gamma Q\big(S_{t+1}, \underset{a}{\mathrm{argmax}}\ Q(S_{t+1}, a; \theta_t); \theta_t\big) $$
&lt;/p&gt;
&lt;p&gt;In Python this can be implemented as three separate functions.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;select_greedy_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Select the greedy action for the current state given some Q-network.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keepdim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;evaluate_selected_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Compute the Q-values by evaluating the actions given the current states and Q-network.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;next_q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gather&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;        
    &lt;span class=&quot;n&quot;&gt;q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_values&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;q_learning_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Q-Learning update with explicitly decoupled action selection and evaluation steps.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;select_greedy_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evaluate_selected_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_values&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;From here it is straight forward to implement the Double DQN algorithm. All I need is a second action-value function. The target network in the DQN architecture provides a natural candidate for the second action-value function. Hasselt et al 2015 suggest using the online Q-network to select the greedy policy actions before using the target Q-network to estimate the value of the selected actions. Once again here are the maths...&lt;/p&gt;
&lt;p&gt;
$$ Y_t^{DoubleDQN} = R_{t+1} + \gamma Q\big(S_{t+1}, \underset{a}{\mathrm{argmax}}\ Q(S_{t+1}, a; \theta_t), \theta_t^{-}\big) $$
&lt;/p&gt;
&lt;p&gt;...and here is the the Python implementation.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;double_q_learning_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;n&quot;&gt;q_network_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;n&quot;&gt;q_network_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Double Q-Learning uses Q-network 1 to select actions and Q-network 2 to evaluate the selected actions.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;select_greedy_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_network_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evaluate_selected_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_network_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_values&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Note that the function &lt;code&gt;double_q_learning_update&lt;/code&gt; is almost identical to the &lt;code&gt;q_learning_update&lt;/code&gt; function above: all that is needed is to introduce a second Q-network parameter, &lt;code&gt;q_network_2&lt;/code&gt;, to the function. This second Q-network will be use to evaluate the actions chosen using the original Q-network parameter, now called &lt;code&gt;q_network_1&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Solving-the-LunarLander-v2-environment&quot;&gt;Solving the &lt;code&gt;LunarLander-v2&lt;/code&gt; environment&lt;a class=&quot;anchor-link&quot; href=&quot;#Solving-the-LunarLander-v2-environment&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the rest of this blog post I will use the Double DQN algorithm to train an agent to solve the &lt;a href=&quot;https://gym.openai.com/envs/LunarLander-v2/&quot;&gt;LunarLander-v2&lt;/a&gt; environment from &lt;a href=&quot;https://openai.com/&quot;&gt;OpenAI&lt;/a&gt; and the compare it to the the results obtained using the vanilla DQN algorithm.&lt;/p&gt;
&lt;p&gt;In this environment the landing pad is always at coordinates (0,0). The reward for moving the lander from the top of the screen to landing pad and arriving at zero speed is typically between 100 and 140 points. Firing the main engine is -0.3 points each frame (so the lander is incentivized to fire the engine as few times possible). If the lander moves away from landing pad it loses reward (so the lander is incentived to land in the designated landing area). The lander is also incentived to land &quot;gracefully&quot; (and not crash in the landing area!).&lt;/p&gt;
&lt;p&gt;A training episode finishes if the lander crashes (-100 points) or comes to rest (+100 points). Each leg with ground contact receives and additional +10 points. The task is considered &quot;solved&quot; if the lander is able to achieve 200 points (I will actually be more stringent and define &quot;solved&quot; as achieving over 200 points on average in the most recent 100 training episodes).&lt;/p&gt;
&lt;h3 id=&quot;Action-Space&quot;&gt;Action Space&lt;a class=&quot;anchor-link&quot; href=&quot;#Action-Space&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;There are four discrete actions available:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Do nothing.&lt;/li&gt;
&lt;li&gt;Fire the left orientation engine.&lt;/li&gt;
&lt;li&gt;Fire main engine.&lt;/li&gt;
&lt;li&gt;Fire the right orientation engine.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Colab-specific-environment-setup&quot;&gt;Colab specific environment setup&lt;a class=&quot;anchor-link&quot; href=&quot;#Colab-specific-environment-setup&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;If you are playing around with this notebook on Google Colab, then you will need to run the following cell in order to install the required OpenAI dependencies into the environment.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pip install gym&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;box2d&lt;span class=&quot;o&quot;&gt;]==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;.17.*
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Making-my-code-more-maintainable&quot;&gt;Making my code more maintainable&lt;a class=&quot;anchor-link&quot; href=&quot;#Making-my-code-more-maintainable&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In order to make the code used in this and in my previous blog post more maintainable for future posts, I have moved the various class definitions and training functions in my previous post out of Jupyter notebooks and into scripts. The &lt;code&gt;agents.py&lt;/code&gt; scripts contains the various agent classes, in particular the &lt;code&gt;DeepQAgent&lt;/code&gt; class which implements both the DQN and Double DQN algorithms; the &lt;code&gt;experience_replay.py&lt;/code&gt; script containing the &lt;code&gt;Experience&lt;/code&gt; and &lt;code&gt;ExperienceReplayBuffer&lt;/code&gt; classes; and the &lt;code&gt;training.py&lt;/code&gt; script contains the functions that train an &lt;code&gt;agents.Agent&lt;/code&gt; to solve some &lt;code&gt;gym.Env&lt;/code&gt; environment.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gym&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;agents&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# module containing the DeepQAgent class  &lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;training&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# module containing the training functions&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gym&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;LunarLander-v2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/Users/pughdr/Research/stochastic-expatriate-descent/env/lib/python3.7/site-packages/gym/logger.py:30: UserWarning: &lt;span class=&quot;ansi-yellow-fg&quot;&gt;WARN: Box bound precision lowered by casting to float32&lt;/span&gt;
  warnings.warn(colorize(&amp;#39;%s: %s&amp;#39;%(&amp;#39;WARN&amp;#39;, msg % args), &amp;#39;yellow&amp;#39;))
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Creating-a-DeepQAgent&quot;&gt;Creating a &lt;code&gt;DeepQAgent&lt;/code&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Creating-a-DeepQAgent&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;h4 id=&quot;Epsilon-decay-schedule&quot;&gt;Epsilon decay schedule&lt;a class=&quot;anchor-link&quot; href=&quot;#Epsilon-decay-schedule&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;As was the case with the DQN algorithm, when using the Double DQN algorithm the agent chooses its action using an $\epsilon$-greedy policy. When using an $\epsilon$-greedy policy, with probability $\epsilon$, the agent explores the state space by choosing an action uniformly at random from the set of feasible actions; with probability $1-\epsilon$, the agent exploits its current knowledge by choosing the optimal action given that current state.&lt;/p&gt;
&lt;p&gt;As the agent learns and acquires additional knowledge about it environment it makes sense to &lt;em&gt;decrease&lt;/em&gt; exploration and &lt;em&gt;increase&lt;/em&gt; exploitation by decreasing $\epsilon$. In practice, it isn't a good idea to decrease $\epsilon$ to zero; instead one typically decreases $\epsilon$ over time according to some schedule until it reaches some minimum value.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;power_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;decay_factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;minimum_epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Power decay schedule found in other practical applications.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decay_factor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minimum_epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;_epsilon_decay_schedule_kwargs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;decay_factor&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;minimum_epsilon&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;epsilon_decay_schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;power_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_epsilon_decay_schedule_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Choosing-an-optimizer&quot;&gt;Choosing an optimizer&lt;a class=&quot;anchor-link&quot; href=&quot;#Choosing-an-optimizer&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;As is the case in training any neural network, the choice of optimizer and the tuning of its hyper-parameters (in particular the learning rate) is important. Here I am going to use the &lt;a href=&quot;https://pytorch.org/docs/stable/optim.html#torch.optim.Adam&quot;&gt;Adam&lt;/a&gt; optimizer. In my previous post on the DQN algorithm I used &lt;a href=&quot;https://pytorch.org/docs/stable/optim.html#torch.optim.RMSProp&quot;&gt;RMSProp&lt;/a&gt;. In my experiments I found that the Adam optimizer significantly improves the efficiency and stability of both the Double DQN and DQN algorithms compared with RMSProp (on this task at least!).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;_optimizer_kwargs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;lr&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;betas&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.999&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;eps&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;weight_decay&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;amsgrad&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer_fn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_optimizer_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Training-the-DeepQAgent-using-Double-DQN&quot;&gt;Training the &lt;code&gt;DeepQAgent&lt;/code&gt; using Double DQN&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-the-DeepQAgent-using-Double-DQN&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now I am finally ready to train the &lt;code&gt;deep_q_agent&lt;/code&gt;. The target score for the &lt;code&gt;LunarLander-v2&lt;/code&gt; environment is 200 points on average for at least 100 consecutive episodes. If the &lt;code&gt;deep_q_agent&lt;/code&gt; is able to &quot;solve&quot; the environment, then training will terminate early.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;state_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;observation_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;action_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;number_hidden_units&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;optimizer_fn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;epsilon_decay_schedule&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;batch_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;buffer_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;alpha&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;gamma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;update_frequency&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;double_dqn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# True uses Double DQN; False uses DQN &lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;seed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;double_dqn_agent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agents&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeepQAgent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;double_dqn_scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doube_dqn_agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;s2&quot;&gt;&amp;quot;double-dqn-checkpoint.pth&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;number_episodes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;target_score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Episode 100	Average Score: -136.37
Episode 200	Average Score: -80.72
Episode 300	Average Score: -42.48
Episode 400	Average Score: 44.46
Episode 500	Average Score: 108.45
Episode 600	Average Score: 193.84

Environment solved in 609 episodes!	Average Score: 201.15
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Training-the-DeepQAgent-using-DQN&quot;&gt;Training the &lt;code&gt;DeepQAgent&lt;/code&gt; using DQN&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-the-DeepQAgent-using-DQN&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Next I will create another &lt;code&gt;DeepQAgent&lt;/code&gt; and train it using the original DQN algorithm for comparison.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;state_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;observation_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;action_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;number_hidden_units&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;optimizer_fn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;epsilon_decay_schedule&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;batch_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;buffer_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;alpha&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;gamma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;update_frequency&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;double_dqn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# True uses Double DQN; False uses DQN &lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;seed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dqn_agent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agents&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeepQAgent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dqn_scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dqn_agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;s2&quot;&gt;&amp;quot;dqn-checkpoint.pth&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;n&quot;&gt;number_episodes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;n&quot;&gt;target_score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Episode 100	Average Score: -188.97
Episode 200	Average Score: -141.91
Episode 300	Average Score: -61.08
Episode 400	Average Score: -41.62
Episode 500	Average Score: -28.62
Episode 600	Average Score: -19.19
Episode 700	Average Score: -42.72
Episode 800	Average Score: 119.68
Episode 900	Average Score: 186.27

Environment solved in 925 episodes!	Average Score: 202.67
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Comparing-DQN-and-Double-DQN&quot;&gt;Comparing DQN and Double DQN&lt;a class=&quot;anchor-link&quot; href=&quot;#Comparing-DQN-and-Double-DQN&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;To make it a bit easier to compare the overall performance of the two algorithms I will now re-train both agents for the same number of episodes (rather than training for the minimum number of episodes required to achieve a target score).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;state_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;observation_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;action_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;number_hidden_units&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;optimizer_fn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;epsilon_decay_schedule&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;batch_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;buffer_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;alpha&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;gamma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;update_frequency&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;double_dqn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;seed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;double_dqn_agent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agents&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeepQAgent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;double_dqn_scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;double_dqn_agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;s2&quot;&gt;&amp;quot;double-dqn-checkpoint.pth&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;number_episodes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;target_score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;inf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Episode 100	Average Score: -154.91
Episode 200	Average Score: -93.57
Episode 300	Average Score: -52.90
Episode 400	Average Score: 21.00
Episode 500	Average Score: 63.61
Episode 600	Average Score: 124.04
Episode 700	Average Score: 213.36
Episode 800	Average Score: 196.64
Episode 900	Average Score: 200.42
Episode 1000	Average Score: 233.95
Episode 1100	Average Score: 242.40
Episode 1200	Average Score: 252.33
Episode 1300	Average Score: 214.17
Episode 1400	Average Score: 225.87
Episode 1500	Average Score: 245.65
Episode 1600	Average Score: 259.11
Episode 1700	Average Score: 253.96
Episode 1800	Average Score: 255.25
Episode 1900	Average Score: 255.18
Episode 2000	Average Score: 254.36
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;state_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;observation_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;action_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;number_hidden_units&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;optimizer_fn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;epsilon_decay_schedule&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;batch_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;buffer_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;alpha&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;gamma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;update_frequency&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;double_dqn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;seed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dqn_agent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agents&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeepQAgent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dqn_scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dqn_agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;s2&quot;&gt;&amp;quot;dqn-checkpoint.pth&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;n&quot;&gt;number_episodes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;n&quot;&gt;target_score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;inf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Episode 100	Average Score: -163.32
Episode 200	Average Score: -112.35
Episode 300	Average Score: -47.40
Episode 400	Average Score: 9.72
Episode 500	Average Score: 115.13
Episode 600	Average Score: 168.85
Episode 700	Average Score: 217.28
Episode 800	Average Score: 144.49
Episode 900	Average Score: 202.26
Episode 1000	Average Score: 224.12
Episode 1100	Average Score: 226.08
Episode 1200	Average Score: 231.65
Episode 1300	Average Score: 242.66
Episode 1400	Average Score: 255.53
Episode 1500	Average Score: 265.84
Episode 1600	Average Score: 266.04
Episode 1700	Average Score: 262.30
Episode 1800	Average Score: 251.11
Episode 1900	Average Score: 257.42
Episode 2000	Average Score: 252.75
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Plotting-the-time-series-of-scores&quot;&gt;Plotting the time series of scores&lt;a class=&quot;anchor-link&quot; href=&quot;#Plotting-the-time-series-of-scores&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;I can use &lt;a href=&quot;https://pandas.pydata.org/&quot;&gt;Pandas&lt;/a&gt; to quickly plot the time series of scores along with a 100 episode moving average. Note that training stops as soon as the rolling average crosses the target score.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dqn_scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dqn_scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;scores&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;double_dqn_scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;double_dqn_scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;scores&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dqn_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;count    2000.000000
mean      163.508939
std       152.089392
min      -500.516422
25%        37.745057
50%       240.134765
75%       264.536588
max       310.643203
Name: scores, dtype: float64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;double_dqn_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;count    2000.000000
mean      160.496507
std       154.166885
min      -543.465688
25%        47.844408
50%       240.574470
75%       264.805729
max       319.673532
Name: scores, dtype: float64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sharex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sharey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dqn_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;DQN Scores&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dqn_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
               &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
               &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Rolling Average&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
               &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Score&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_dqn_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Double DQN Scores&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;double_dqn_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Rolling Average&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Score&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Episode Number&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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SY0aNRg7diyPPfYYOTk5Pss8/fTT2bhxIx9++CFz586la9eurFixgk8++YTx48dTrVo1AAoKCti/fz/79u1jwIABAIwbN45zzz3XXZar34H62LlzZy666CJGjhzJyJEjTfU7EDET2JRSnwD1fRyaAtwBDPF1mo80HSDdX90TcCyf0rRp06BtFQRBEIR4EaomLFZs3LgRq9VKvXr1/K4Q2Ww2D8OEQG4ovAUrrTUdO3Zk/vz5Ibftxx9/pKSkhFatWvHzzz9z8OBBqlev7j6+ePFizjnnHI9zJk2aRLdu3Rg/frzfcgsKCrjwwgu58MILGTFiBPPmzfMrFAYiNzcXCNzH999/n3nz5vHuu+/y17/+lZUrV2KzhS92xWwPm9b6NK11J+8/YCPQHFjqXOpsDCxWStXHoTlrYiimMbDNmd7YR7q/up/RWpdorUvq1q0b3Y4FQsOdIzrw0mU941enIAiCIITIrl27uOqqq7jmmmtQStG/f39effVVANauXcsvv/xC27ZtKSwsZMmSJdjtdn799Ve+//57dxl2u91tDfraa69x8skne9TRtm1bdu3a5RZmysrKWLlyZdC2vfHGG3z00UdccMEF5ObmMm7cOG688UYqKhxhB1966SWys7Pp16+fx3kFBQWcd955PPfccz7L/eyzzzhy5AgABw8eZMOGDTRt2pQhQ4bw/PPPu4/t3buX/Px8atWqxVdffQXAyy+/7Na2memj63qdeuqp3H///ezbt49Dhw4F7Xsg4r4kqrVeDrjd/juFthKt9W6l1LvAa0qph4CGOIwLvtdaVyilDiqlegPfAWOBx+PddjNcfrI5j8WCIAiCEE+OHj1KcXExZWVl2Gw2LrnkEm688UYAJk6cyFVXXUVRURE2m42ZM2eSlZVFv379aN68OUVFRXTq1Ilu3bq5y8vNzWXlypV0796d/Px85syZ41FfZmYmr7/+Otdddx379++nvLycSZMm0bFjVQ3jww8/zCuvvMLhw4fp1KkTn332GS6Fy4wZM7jlllto27YtR48epW7dusyfP9+nVuymm27y2EdnZNGiRVxzzTVureEVV1xBjx49AIeBQUlJCZmZmQwbNox7772XF198kauuuoojR47QokULXnjhhSpl+utjmzZtuPjii9m/fz9aa2644QZq1qxp8k75RiV6o7xRYHN+nwJcBpQDk7TWc53pJcBMIAeHscG12kTjS0pK9MKFC2PTeCeFk98HYFhRff5xUfeY1iUkBtc93nzf8LSuUxBcXDfrR95duo1HxhQzsmvSbRlOOVavXk379u0T3YyU57fffmPo0KFMnDiRCRMmJLo5EePruVBKLdJal3jnTXgsUa11odf3e4B7fORbCHSKU7PC4k/9JSi7IAjpgXi6FJKR+vXrs2TJkkQ3IyFIpIMo0qVJZOpOQRAEQRAEXyRcwyYIqcB7157Mtn1HE90MQRAE4QRFBDZBMEGnRvl0apSf6GYIgiAIJyiyJCoIgiAIgpDkiMAmCIIgCIKQ5IjAJgiCIAgnAFarleLiYjp16sSZZ54ZNL7lpZde6naMO3DgQFwusoYNGxaV2JguHn74YbKzs9m/f3/UykxHRGATBEEQhBOAnJwclixZwooVKygoKODJJ58Mq5wPPvggYiewRmbNmkWPHj146623olKeKyJCuiECmyAIgiCcYPTp04etW7cCDi//vXv3pnPnzowaNYrff/894LmFhYXs3r2bzZs30759e6688ko6duzIkCFDOHrUYU3/ww8/0LlzZ/r06cMtt9xCp06+3ahu2LCBQ4cOcffddzNr1iwAnnrqKW699VZ3npkzZ7oD07/yyiv07NmT4uJi/vSnP7mFs7y8PKZOnUqvXr2YP38+d911Fz169KBTp05MmDDBHSvVX7sqKiq45ZZb6NGjB507d+bpp58O99LGDLESFQRBEIR4Mncy/LY8umXWL4Iz7jOVtaKigk8//ZTLL78cgLFjx/L4448zYMAApk6dyvTp03nkkUdMlbVu3TpmzZrFs88+y3nnnccbb7zBxRdfzPjx43nmmWfo27cvkydP9nv+rFmzuOCCCzjllFNYs2YNO3fu5JxzzqFPnz7cf//9AMyZM4cpU6awevVq5syZwzfffENGRgYTJ07k1VdfZezYse6QVnfddRcAHTp0YOrUqQBccsklvPfee5x55pl+2/Xcc8+Rn5/PDz/8wPHjx+nXrx9DhgyhefPkCTcpGjZBEARBOAFwxRKtXbs2e/fuZfDgwezfv599+/a5A5uPGzeOefPmmS6zefPmFBcXA9C9e3c2b97Mvn37OHjwIH379gXgwgsv9Hv+7NmzOf/887FYLIwePZr//Oc/1K1blxYtWrBgwQL27NnDmjVr6NevH59++imLFi2iR48eFBcX8+mnn7Jx40bAsT/v7LPPdpf7+eef06tXL4qKivjss89YuXJlwHZ99NFHvPTSSxQXF9OrVy/27NnDunXrTF+HeCAaNkEQBEGIJyY1YdHGtYdt//79jBgxgieffJJx48ZFVGZWVpb7s9Vq5ejRo5iNUb5s2TLWrVvH4MGDASgtLaVFixZcffXVjBkzhn//+9+0a9eOUaNGoZRCa824ceOYMWNGlbKys7OxWq0AHDt2jIkTJ7Jw4UKaNGnCtGnTOHbsWMB2aa15/PHHOf3000PpflwRDZsgCIIgnEDk5+fz2GOP8eCDD1KtWjVq1arFV199BcDLL7/s1raFS61atahevToLFiwAHFo0X8yaNYtp06axefNmNm/ezLZt29i6dSs///wzo0eP5u2332bWrFmMGTMGgEGDBvH666+zc+dOAPbu3cvPP/9cpdxjx44BUKdOHQ4dOuS2dA3UrtNPP52nnnqKsrIyANauXcvhw4cjug7RRjRsgiAIgnCC0bVrV7p06cLs2bN58cUXueqqqzhy5AgtWrTghRdeiLj85557jiuvvJLc3FwGDhxIfn7VSDGzZ89m7ty5HmmjRo1i9uzZ3HbbbXTo0IFVq1bRs2dPwLEv7e6772bIkCHY7XYyMjJ48sknadasmUcZNWvW5Morr6SoqIjCwkJ69OgRtF1XXHEFmzdvplu3bmitqVu3Lm+//XbE1yGaKLOqy1SlpKREu3zHxKyOuz9h96HjbL5veEzrEU4s1u44yJHSCoqbRM98XhDMcv3sH3lnyTYeGVPMyK6NEt2clGf16tW0b98+0c2IG4cOHSIvLw+A++67j+3bt/Poo48muFXJ1y5fz4VSapHWusQ7r2jYosBXt55Kmd2e6GYIaUabk6onugmCIAhh8f777zNjxgzKy8tp1qwZM2fOTHSTgORtlxlEYIsCOZlWcrAmuhmCIAiCkBSMGTPGvfcsmUjWdplBjA4EQRAEQRCSHNGwCYIgCFW4eUhbdh86zmkdTkp0U9IGrTVKqUQ3Q0gSQrUhEA2bIAiCUIUmBdV49Yre5GXJe300yM7OZs+ePSFP0kJ6orVmz549ZGdnmz5HfomCIAiCEGMaN27Mli1b2LVrV6KbIiQJ2dnZNG7c2HR+EdgEQRAEIcZkZGQkVVxKIfWQJVFBEARBEIQkRwQ2QRAEQRCEJEcENkEQBEEQhCQn7UNTKaV2AVWjw0aXOsDuGNeRzJzI/Ze+n7icyP0/kfsOJ3b/T+S+Q3z630xrXdc7Me0FtniglFroK+7XicKJ3H/p+4nZdzix+38i9x1O7P6fyH2HxPZflkQFQRAEQRCSHBHYBEEQBEEQkhwR2KLDM4luQII5kfsvfT9xOZH7fyL3HU7s/p/IfYcE9l/2sAmCIAiCICQ5omETBEEQBEFIckRgixCl1FCl1Bql1Hql1OREtyfaKKWaKKU+V0qtVkqtVEpd70yfppTaqpRa4vwbZjjnduf1WKOUOj1xrY8cpdRmpdRyZx8XOtMKlFIfK6XWOf/XMuRPp763NdzfJUqpA0qpSel675VSzyuldiqlVhjSQr7XSqnuzmdmvVLqMaWUindfwsFP/x9QSv2klFqmlHpLKVXTmV6olDpqeAb+aTgn5frvp+8hP+ep2Hfw2/85hr5vVkotcaan2733N8cl329fay1/Yf4BVmAD0ALIBJYCHRLdrij3sQHQzfm5OrAW6ABMA272kb+D8zpkAc2d18ea6H5E0P/NQB2vtPuByc7Pk4G/pWPfvfpsBX4DmqXrvQf6A92AFZHca+B7oA+ggLnAGYnuWwT9HwLYnJ//Zuh/oTGfVzkp138/fQ/5OU/Fvvvrv9fxvwNT0/Te+5vjku63Lxq2yOgJrNdab9RalwKzgbMS3KaoorXerrVe7Px8EFgNNApwylnAbK31ca31JmA9juuUTpwFvOj8/CIw0pCern0fBGzQWgdyQp3S/ddazwP2eiWHdK+VUg2AGlrr+doxgr9kOCep8dV/rfVHWuty59cFQONAZaRq//3ce3+cEPfehVNLdB4wK1AZqdr/AHNc0v32RWCLjEbAr4bvWwgszKQ0SqlCoCvwnTPpGudSyfMGdXG6XRMNfKSUWqSUmuBMO0lrvR0cP3agnjM93fpu5Hw8B+wT4d5D6Pe6kfOzd3o6cBkOrYGL5kqpH5VSXyqlTnGmpVv/Q3nO063vLk4Bdmit1xnS0vLee81xSffbF4EtMnytT6el2a1SKg94A5iktT4APAW0BIqB7ThU5pB+16Sf1robcAZwtVKqf4C86dZ3AJRSmcAfgf84k06Uex8If31Ny2uglJoClAOvOpO2A0211l2BG4HXlFI1SK/+h/qcp1PfjVyA58taWt57H3Oc36w+0uJy/0Vgi4wtQBPD98bAtgS1JWYopTJwPMivaq3fBNBa79BaV2it7cCzVC59pdU10Vpvc/7fCbyFo587nOpv1zLATmf2tOq7gTOAxVrrHXDi3Hsnod7rLXguG6b8NVBKjQNGABc5l3pwLgftcX5ehGMfTxvSqP9hPOdp03cXSikbMBqY40pLx3vva44jCX/7IrBFxg9Aa6VUc6cW4nzg3QS3Kao49y88B6zWWj9kSG9gyDYKcFkXvQucr5TKUko1B1rj2IiZciilcpVS1V2fcWzAXoGjj+Oc2cYB7zg/p03fvfB4wz4R7r2BkO61c+nkoFKqt/O3M9ZwTsqhlBoK3Ab8UWt9xJBeVylldX5ugaP/G9Op/6E+5+nUdwOnAT9prd1Lfel27/3NcSTjbz/aFhcn2h8wDIdVyQZgSqLbE4P+nYxDrbsMWOL8Gwa8DCx3pr8LNDCcM8V5PdaQAlZCAfreAoc10FJgpev+ArWBT4F1zv8F6dZ3Q3+qAXuAfENaWt57HELpdqAMx9vy5eHca6AEx+S+AXgCp4PyZP/z0//1OPbruH77/3TmPdv5m1gKLAbOTOX+++l7yM95KvbdX/+d6TOBq7zyptu99zfHJd1vXyIdCIIgCIIgJDmyJCoIgiAIgpDkiMAmCIIgCIKQ5IjAJgiCIAiCkOSIwCYIgiAIgpDkiMAmCIIgCIKQ5IjAJghCUqKUqlBKLTH8TQ6S/yql1Ngo1LtZKVUnhPxfKKUWGr6XKKW+iLQdzrIuVUo9EY2yBEFIbWyJboAgCIIfjmqti81m1lr/M5aNCUI9pdQZWuu5wbPGD6WUVWtdkeh2CIIQOaJhEwQhpXBqwP6mlPre+dfKmT5NKXWz8/N1SqlVzsDds51pBUqpt51pC5RSnZ3ptZVSHzmDWT+NISagUupiZx1LlFJPuzy8++AB4M8+2uqhIVNKvaeUGuj8fMjZj0VKqU+UUj2d2rqNSqk/GoppopT6UCm1Rin1l2Btc5Z7l1LqO6BPONdYEITkQwQ2QRCSlRyvJdExhmMHtNY9cXgTf8THuZOBrlrrzsBVzrTpwI/OtDuAl5zpfwG+1o5g1u8CTQGUUu2BMUA/p6avArjIT1vnA8eVUqeG0L9c4AutdXfgIHA3MBhHGKS7DPl6OustBs51LrkGalsusEJr3Utr/XUI7REEIYmRJVFBEJKVQEuiswz/H/ZxfBnwqlLqbeBtZ9rJOMLqoLX+zKlZywf64whwjdb6faXU7878g4DuwA+O0IDkUBkA2hd349Cy3WaibwClwIfOz8uB41rrMqXUcqDQkO9j7Qy2rZR609mP8gBtq8ARyFoQhDRCBDZBEFIR7eezi+E4BLE/AncqpTpiWOr0ca6vMhTwotb6dlMNcgiBfwV6G5LL8VzJyDZ8LtOVsQHtwHFnOXallHFs9m6bDtK2Y7JvTRDSD1kSFQQhFRlj+D/feEApZQGaaK0/B24FagJ5wDycy4bOfWS7tdYHvNLPAGo5i/oUOEcpVc95rEAp1SxIu+5x1uliM1CslLIopZrgWN4MlcHOunOAkcA3YbZNEIQURjRsgiAkKzlKqSWG7x9qrV2uPbKcm+otwAVe51mBV5zLnQp4WGu9Tyk1DXhBKbUMOAKMc+afDsxSSi0GvgR+AdBar1JK/Rn4yCkElgFXAz/7a7DW+gOl1C5D0jfAJhxLniuAxSFdAQdfAy8DrYDXtNYLAUJtmyAIqY2q1MgLgiAkP0qpzUCJ1np3otsiCIIQL2RJVBAEQRAEIckRDZsgCIIgCEKSIxo2QRAEQRCEJEcENkEQBEEQhCRHBDZBEARBEIQkRwQ2QRAEQRCEJEcENkEQBEEQhCRHBDZBEARBEIQk5/8BiBjNUkgn0JoAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Kernel-density-plot-of-the-scores&quot;&gt;Kernel density plot of the scores&lt;a class=&quot;anchor-link&quot; href=&quot;#Kernel-density-plot-of-the-scores&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Kernel density plot of scores is bimodal with one mode less than -100 and a second mode greater than 200. The negative mode corresponds to those training episodes where the agent crash landed and thus scored at most -100; the positive mode corresponds to those training episodes where the agent &quot;solved&quot; the task. The kernel density or scores typically exhibits negative skewness (i.e., a fat left tail): there are lots of ways in which landing the lander can go horribly wrong (resulting in the agent getting a very low score) and only relatively few paths to a gentle landing (and a high score). Visually there doesn't seem to be too much of a difference between the distribution of scores between the DQN and Double DQN algorithms.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dqn_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;kde&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;DQN&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_dqn_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;kde&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Double DQN&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Score&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Where-to-go-from-here?&quot;&gt;Where to go from here?&lt;a class=&quot;anchor-link&quot; href=&quot;#Where-to-go-from-here?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In my next post I plan to cover &lt;a href=&quot;https://arxiv.org/abs/1509.06461&quot;&gt;Prioritized Experience Replay&lt;/a&gt; which improves the sampling scheme used by the &lt;code&gt;ExperienceReplayBuffer&lt;/code&gt; so as to replay important transitions more frequently which should lead to more efficient learning.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>David R. Pugh</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/double-dqn-figure-2.png" /><media:content medium="image" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/double-dqn-figure-2.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Getting familiar with deep Q-networks</title><link href="https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html" rel="alternate" type="text/html" title="Getting familiar with deep Q-networks" /><published>2020-04-03T00:00:00-05:00</published><updated>2020-04-03T00:00:00-05:00</updated><id>https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks</id><content type="html" xml:base="https://davidrpugh.github.io/stochastic-expatriate-descent/pytorch/deep-reinforcement-learning/deep-q-networks/2020/04/03/deep-q-networks.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-03-deep-q-networks.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Colab-specific-environment-setup&quot;&gt;Colab specific environment setup&lt;a class=&quot;anchor-link&quot; href=&quot;#Colab-specific-environment-setup&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;If you are playing around with this notebook on Google Colab, then you will need to run the following cell in order to install the required OpenAI dependencies into the environment.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pip install gym&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;box2d&lt;span class=&quot;o&quot;&gt;]==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;.17.*
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Motivation&quot;&gt;Motivation&lt;a class=&quot;anchor-link&quot; href=&quot;#Motivation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;I am currently using my COVID-19 imposed quarantine to expand my deep learning skills by completing the &lt;a href=&quot;https://www.udacity.com/course/deep-reinforcement-learning-nanodegree--nd893&quot;&gt;&lt;em&gt;Deep Reinforcement Learning Nanodegree&lt;/em&gt;&lt;/a&gt; from &lt;a href=&quot;https://www.udacity.com/&quot;&gt;Udacity&lt;/a&gt;. This past week I have been working my way through the seminal 2015 &lt;em&gt;Nature&lt;/em&gt; paper from researchers at &lt;a href=&quot;https://deepmind.com/&quot;&gt;Deepmind&lt;/a&gt; &lt;a href=&quot;https://storage.googleapis.com/deepmind-media/dqn/DQNNaturePaper.pdf&quot;&gt;&lt;em&gt;Human-level control through deep reinforcement learning&lt;/em&gt;&lt;/a&gt; (Minh et al 2015).&lt;/p&gt;
&lt;h3 id=&quot;Why-is-Minh-et-al-2015-important?&quot;&gt;Why is Minh et al 2015 important?&lt;a class=&quot;anchor-link&quot; href=&quot;#Why-is-Minh-et-al-2015-important?&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;While Minh et al 2015 was not the first paper to use neural networks to approximate the action-value function, this paper was the first to demonstrate that the same neural network architecture could be trained in a computationally efficient manner to &quot;solve&quot; a large number or different tasks.&lt;/p&gt;
&lt;p&gt;The paper also contributed several practical &quot;tricks&quot; for getting deep neural networks to consistently converge during training. This was a non-trivial contribution as issues with training convergence had plaugued previous attempts to use neural networks as function approximators in reinforcement learning tasks and were blocking widespread adoption of deep learning techniques within the reinforcemnt learning community.&lt;/p&gt;
&lt;h2 id=&quot;Summary-of-the-paper&quot;&gt;Summary of the paper&lt;a class=&quot;anchor-link&quot; href=&quot;#Summary-of-the-paper&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Minh et al 2015 uses deep (convolutional) neural network to approximate the optimal action-value function&lt;/p&gt;
&lt;p&gt;
$$ Q^*(s, a) = \max_{\pi} \mathbb{E}\Bigg[\sum_{s=0}^{\infty} \gamma^s r_{t+s} | s_t=s, a_t=a, \pi \Bigg] $$
&lt;/p&gt;
&lt;p&gt;which is the maximum sum of rewards $r_t$ discounted by $\gamma$ at each time-step $t$ achievable by a behaviour policy $\pi = P(a|s)$, after making an observation of the state $s$ and taking an action $a$.&lt;/p&gt;
&lt;p&gt;Prior to this seminal paper it was well known that standard reinforcement learning algorithms were unstable or even diverged when a non-linear function approximators such as a neural networks were used to represent the action-value function $Q$. Why?&lt;/p&gt;
&lt;p&gt;Minh et al 2015 discuss several reasons.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Correlations present in the sequence of observations of the state $s$. In reinforcement learning applications the sequence state observations is a time-series which will almost surely be auto-correlated. But surely this would also be true of any application of deep neural networks to model time series data. &lt;/li&gt;
&lt;li&gt;Small updates to $Q$ may significantly change the policy, $\pi$ and therefore change the data distribution.&lt;/li&gt;
&lt;li&gt;Correlations between the action-values, $Q$, and the target values $r + \gamma \max_{a'} Q(s', a')$&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In the paper the authors address these issues by using...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a biologically inspired mechanism they refer to as &lt;em&gt;experience replay&lt;/em&gt; that randomizes over the data which removes correlations in the sequence of observations of the state $s$ and smoothes over changes in the data distribution (issues 1 and 2 above).&lt;/li&gt;
&lt;li&gt;an iterative update rule that adjusts the action-values, $Q$, towards target values, $Q'$ that are only periodically updated thereby reducing correlations with the target (issue 3 above).&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Approximating-the-action-value-function,-$Q(s,a)$&quot;&gt;Approximating the action-value function, $Q(s,a)$&lt;a class=&quot;anchor-link&quot; href=&quot;#Approximating-the-action-value-function,-$Q(s,a)$&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;There are several possible ways of approximating the action-value function $Q$ using a neural network. The only input to the DQN architecture is the state representation and the output layer has a separate output for each possible action. The output units correspond to the predicted $Q$-values of the individual actions for the input state. A representaion of the DQN architecture from the paper is reproduced in the figure below.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/stochastic-expatriate-descent/images/copied_from_nb/my_icons/q-network-architecture.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The input to the neural network consists of an 84 x 84 x 4 image produced by the preprocessing map $\phi$. The network has four hidden layers:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Convolutional layer with 32 filters (each of which uses an 8 x 8 kernel and a stride of 4) and a ReLU activation function. &lt;/li&gt;
&lt;li&gt;Convolutional layer with 64 filters (each of which using a 4 x 4 kernel with stride of 2) and a ReLU activation function. &lt;/li&gt;
&lt;li&gt;Convolutional layer with 64 filters (each of which uses a 3 x 3 kernel and a stride of 1) and a ReLU activation function. &lt;/li&gt;
&lt;li&gt;Fully-connected (i.e., dense) layer with 512 neurons followed by a ReLU activation function.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The output layer is another fully-connected layer with a single output for each action. A PyTorch implementation of the DQN architecture would look something like the following.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deep_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_channels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;deep_q_network&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_channels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_channels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_channels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_channels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_channels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_channels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deep_q_network&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;The-Loss-Function&quot;&gt;The Loss Function&lt;a class=&quot;anchor-link&quot; href=&quot;#The-Loss-Function&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The $Q$-learning update at iteration $i$ uses the following loss function&lt;/p&gt;
&lt;p&gt;
$$ \mathcal{L_i}(\theta_i) = \mathbb{E}_{(s, a, r, s') \sim U(D)} \Bigg[\bigg(r + \gamma \max_{a'} Q\big(s', a'; \theta_i^{-}\big) - Q\big(s, a; \theta_i\big)\bigg)^2\Bigg] $$
&lt;/p&gt;
&lt;p&gt;where $\gamma$ is the discount factor determining the agent’s horizon, $\theta_i$ are the parameters of the $Q$-network at iteration $i$ and $\theta_i^{-}$ are the $Q$-network parameters used to compute the target at iteration $i$. The target network parameters $\theta_i^{-}$ are only updated with the $Q$-network parameters $\theta_i$ every $C$ steps and are held fixed between individual updates.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Experience-Replay&quot;&gt;Experience Replay&lt;a class=&quot;anchor-link&quot; href=&quot;#Experience-Replay&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;To perform &lt;em&gt;experience replay&lt;/em&gt; the authors store the agent's experiences $e_t$ as represented by the tuple&lt;/p&gt;
&lt;p&gt;
$$ e_t = (s_t, a_t, r_t, s_{t+1}) $$
&lt;/p&gt;
&lt;p&gt;consisting of the observed state in period $t$, the reward received in period $t$, the action taken in period $t$, and the resulting state in period $t+1$. The dataset of agent experiences at period $t$ consists of the set of past experiences.&lt;/p&gt;
&lt;p&gt;
$$ D_t = \{e1, e2, ..., e_t \} $$
&lt;/p&gt;
&lt;p&gt;Depending on the task it may note be feasible for the agent to store the entire history of past experiences.&lt;/p&gt;
&lt;p&gt;During learning Q-learning updates are computed based on samples (or minibatches) of experience $(s,a,r,s')$, drawn uniformly at random from the pool of stored samples $D_t$.&lt;/p&gt;
&lt;p&gt;The following is my Python implmentation of these ideas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;_field_names&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;state&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;action&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;reward&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;next_state&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;done&amp;quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Experience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collections&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;namedtuple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Experience&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;field_names&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_field_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ExperienceReplayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Fixed-size buffer to store experience tuples.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Initialize an ExperienceReplayBuffer object.&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;        Parameters:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        -----------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        buffer_size (int): maximum size of buffer&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        batch_size (int): size of each training batch&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        seed (int): random seed&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_buffer_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buffer_size&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collections&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_random_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;nd&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_batch_size&lt;/span&gt;
    
    &lt;span class=&quot;nd&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_buffer_size&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;is_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_buffer_size&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Add a new experience to memory.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Randomly sample a batch of experiences from memory.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;idxs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;experiences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idxs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;experiences&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;The-Deep-Q-Network-Algorithm&quot;&gt;The Deep Q-Network Algorithm&lt;a class=&quot;anchor-link&quot; href=&quot;#The-Deep-Q-Network-Algorithm&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The following is Python pseudo-code for the Deep Q-Network (DQN) algorithm. For more fine-grained details of the DQN algorithm see the methods section of &lt;a href=&quot;https://storage.googleapis.com/deepmind-media/dqn/DQNNaturePaper.pdf&quot;&gt;Minh et al 2015&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# hyper-parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# number of experience tuples used in computing the gradient descent parameter update.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buffer_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# number of experience tuples stored in the replay buffer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# discount factor used in the Q-learning update&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_network_update_frequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frequency (measured in parameter updates) with which target network is updated.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;update_frequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frequency (measured in number of timesteps) with which q-network parameters are updated.&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# initilizing the various data structures&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;replay_buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ExperienceReplayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;local_q_network&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initialize_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_q_network&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initialize_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;synchronize_q_networks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;local_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_episodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# initialize the environment state&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# simulate a single training episode&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;parameter_updates&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# greedy action based on Q(s, a; theta)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choose_epsilon_greedy_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 

        &lt;span class=&quot;c1&quot;&gt;# update the environment based on the chosen action&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# agent records experience in its replay buffer&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;experience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replay_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# agent samples a mini-batch of experiences from its replay buffer&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;experiences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replay_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;experiences&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# agent learns every update_frequency timesteps&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_frequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# compute the Q^- values using the Q-learning formula&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_learning_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# compute the Q values&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;local_q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;local_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# agent updates the parameters theta using gradient descent&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mean_squared_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_q_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;local_q_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;gradient_descent_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;parameter_updates&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# every target_network_update_frequency timesteps set theta^- = theta&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameter_updates&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_network_update_frequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;synchronize_q_networks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;local_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Solving-the-LunarLander-v2-environment&quot;&gt;Solving the &lt;code&gt;LunarLander-v2&lt;/code&gt; environment&lt;a class=&quot;anchor-link&quot; href=&quot;#Solving-the-LunarLander-v2-environment&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the rest of this blog post I will use the DQN algorithm to train an agent to solve the &lt;a href=&quot;https://gym.openai.com/envs/LunarLander-v2/&quot;&gt;LunarLander-v2&lt;/a&gt; environment from &lt;a href=&quot;https://openai.com/&quot;&gt;OpenAI&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In this environment the landing pad is always at coordinates (0,0). The reward for moving the lander from the top of the screen to landing pad and arriving at zero speed is typically between 100 and 140 points. Firing the main engine is -0.3 points each frame (so the lander is incentivized to fire the engine as few times possible). If the lander moves away from landing pad it loses reward (so the lander is incentived to land in the designated landing area). The lander is also incentived to land &quot;gracefully&quot; (and not crash in the landing area!).&lt;/p&gt;
&lt;p&gt;A training episode finishes if the lander crashes (-100 points) or comes to rest (+100 points). Each leg with ground contact receives and additional +10 points. The task is considered &quot;solved&quot; if the lander is able to achieve 200 points (I will actually be more stringent and define &quot;solved&quot; as achieving over 200 points on average in the most recent 100 training episodes).&lt;/p&gt;
&lt;h3 id=&quot;Action-Space&quot;&gt;Action Space&lt;a class=&quot;anchor-link&quot; href=&quot;#Action-Space&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;There are four discrete actions available:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Do nothing.&lt;/li&gt;
&lt;li&gt;Fire the left orientation engine.&lt;/li&gt;
&lt;li&gt;Fire main engine.&lt;/li&gt;
&lt;li&gt;Fire the right orientation engine.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gym&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gym&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;LunarLander-v2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/Users/pughdr/Research/stochastic-expatriate-descent/env/lib/python3.7/site-packages/gym/logger.py:30: UserWarning: &lt;span class=&quot;ansi-yellow-fg&quot;&gt;WARN: Box bound precision lowered by casting to float32&lt;/span&gt;
  warnings.warn(colorize(&amp;#39;%s: %s&amp;#39;%(&amp;#39;WARN&amp;#39;, msg % args), &amp;#39;yellow&amp;#39;))
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Defining-a-generic-Agent-and-train-loop&quot;&gt;Defining a generic &lt;code&gt;Agent&lt;/code&gt; and &lt;code&gt;train&lt;/code&gt; loop&lt;a class=&quot;anchor-link&quot; href=&quot;#Defining-a-generic-Agent-and-train-loop&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In the cell below I define a fairly generic training loop for training and &lt;code&gt;Agent&lt;/code&gt; to solve a task in a given &lt;code&gt;gym.Env&lt;/code&gt; environment. In working through the hands-on portions of the &lt;a href=&quot;https://www.udacity.com/&quot;&gt;Udacity&lt;/a&gt; &lt;a href=&quot;https://www.udacity.com/course/deep-reinforcement-learning-nanodegree--nd893&quot;&gt;&lt;em&gt;Deep Reinforcement Learning Nanodegree&lt;/em&gt;&lt;/a&gt; I found myself writing similar code over and over again to train the agent to solve a task. This is my first attempt to write something that I might be able to reuse on the course going forward.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;choose_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Rule for choosing an action given the current state of the environment.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;NotImplementedError&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filepath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Save any important agent state to a file.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;NotImplementedError&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Update agent&amp;#39;s state after observing the effect of its action on the environment.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NotImplmentedError&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_train_for_at_most&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gym&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Train agent for a maximum number of timesteps.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choose_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;

                
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_train_until_done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gym&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Train the agent until the current episode is complete.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choose_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gym&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;checkpoint_filepath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;target_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;number_episodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;maximum_timesteps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Reinforcement learning training loop.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Parameters:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    -----------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    agent (Agent): an agent to train.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    env (gym.Env): an environment in which to train the agent.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    checkpoint_filepath (str): filepath used to save the state of the trained agent.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    number_episodes (int): maximum number of training episodes.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    maximum_timsteps (int): maximum number of timesteps per episode.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Returns:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    --------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    scores (list): collection of episode scores from training.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;most_recent_scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collections&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_episodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maximum_timesteps&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_train_until_done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_train_for_at_most&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maximum_timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;         
        &lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;most_recent_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;average_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_recent_scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_recent_scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;average_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Environment solved in &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; episodes!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Average Score: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;average_score&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.2f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;agent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint_filepath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Episode &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Average Score: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;average_score&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.2f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Creating-a-DeepQAgent&quot;&gt;Creating a &lt;code&gt;DeepQAgent&lt;/code&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Creating-a-DeepQAgent&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The code in the cell below encapsulates much of the logic of the DQN algorithm in a &lt;code&gt;DeepQAgent&lt;/code&gt; class. Since the &lt;code&gt;LunarLander-v2&lt;/code&gt; task is not well suited for convolutional neural networks, the agent uses a simple three layer dense neural network with ReLU activation functions to approximate the action-value function $Q$.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;functional&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DeepQAgent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;state_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;action_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;number_hidden_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;optimizer_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Callable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;typing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;epsilon_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Callable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;update_frequency&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Initialize a DeepQAgent.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Parameters:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        -----------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        state_size (int): the size of the state space.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        action_size (int): the size of the action space.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        number_hidden_units (int): number of units in the hidden layers.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        optimizer_fn (callable): function that takes Q-network parameters and returns an optimizer.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        batch_size (int): number of experience tuples in each mini-batch.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        buffer_size (int): maximum number of experience tuples stored in the replay buffer.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        epsilon_decay_schdule (callable): function that takes episode number and returns epsilon.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        alpha (float): rate at which the target q-network parameters are updated.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        gamma (float): Controls how much that agent discounts future rewards (0 &amp;lt; gamma &amp;lt;= 1).&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        update_frequency (int): frequency (measured in time steps) with which q-network parameters are updated.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        seed (int): random seed&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_state_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_size&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_action_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action_size&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;cuda&amp;quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;cpu&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# set seeds for reproducibility&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_random_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manual_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backends&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudnn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deterministic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backends&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudnn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;benchmark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# initialize agent hyperparameters&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_experience_replay_buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ExperienceReplayBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_epsilon_decay_schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon_decay_schedule&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# initialize Q-Networks&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_update_frequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_frequency&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_initialize_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_hidden_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_target_q_network&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_initialize_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_hidden_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_synchronize_q_networks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# send the networks to the device&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_target_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# initialize the optimizer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# initialize some counters&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_number_episodes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_number_timesteps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_number_parameter_updates&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_initialize_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;number_hidden_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Create a neural network for approximating the action-value function.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q_network&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_state_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_hidden_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_hidden_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_hidden_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_hidden_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_action_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_network&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_learn_from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;experiences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Heart of the Deep Q-learning algorithm.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vs&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# get max predicted Q values (for next states) from target model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_target_q_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_target_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                       &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                                       &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# compute the new Q&amp;#39; values using the Q-learning formula&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;target_q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewards&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_target_q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# get expected Q values from local model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                         &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unsqueeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;expected_q_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                 &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gather&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# compute the mean squared loss&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mse_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expected_q_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_q_values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unsqueeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# agent updates the parameters theta of Q using gradient descent&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_soft_update_target_q_network_parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                 
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_soft_update_target_q_network_parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Soft-update of target q-network parameters with the local q-network parameters.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;local_param&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_target_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;local_param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_alpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_synchronize_q_networks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Synchronize the target_q_network and the local_q_network.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_target_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
           
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_uniform_random_policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Choose an action uniformly at random.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_action_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_greedy_policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Choose an action that maximizes the action_values given the current state.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# evaluate the network to compute the action values&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;no_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;action_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# choose the greedy action&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# action_values might reside on the GPU!&lt;/span&gt;
                               &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                               &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_epsilon_greedy_policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;With probability epsilon explore randomly; otherwise exploit knowledge optimally.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_uniform_random_policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_greedy_policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;choose_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Return the action for given state as per current policy.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Parameters:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        -----------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        state (np.array): current state of the environment.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Return:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        --------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        action (int): an integer representing the chosen action.&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# need to reshape state array and convert to tensor&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;state_tensor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                             &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unsqueeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                             &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            
        &lt;span class=&quot;c1&quot;&gt;# choose uniform at random if agent has insufficient experience&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;has_sufficient_experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_uniform_random_policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_epsilon_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_number_episodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_epsilon_greedy_policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;has_sufficient_experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;True if agent has enough experience to train on a batch of samples; False otherwise.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_experience_replay_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_experience_replay_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filepath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Saves the state of the DeepQAgent.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Parameters:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        -----------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        filepath (str): filepath where the serialized state should be saved.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Notes:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        ------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        The method uses `torch.save` to serialize the state of the q-network, &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        the optimizer, as well as the dictionary of agent hyperparameters.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&amp;quot;q-network-state&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_local_q_network&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&amp;quot;optimizer-state&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&amp;quot;agent-hyperparameters&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;alpha&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_alpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;batch_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_experience_replay_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;buffer_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_experience_replay_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;gamma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;update_frequency&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_update_frequency&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filepath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Updates the agent&amp;#39;s state based on feedback received from the environment.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Parameters:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        -----------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        state (np.array): the previous state of the environment.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        action (int): the action taken by the agent in the previous state.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        reward (float): the reward received from the environment.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        next_state (np.array): the resulting state of the environment following the action.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        done (bool): True is the training episode is finised; false otherwise.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# save experience in the experience replay buffer&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;experience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_experience_replay_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_number_episodes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_number_timesteps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            
            &lt;span class=&quot;c1&quot;&gt;# every so often the agent should learn from experiences&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_number_timesteps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_update_frequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;has_sufficient_experience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;experiences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_experience_replay_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_learn_from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Epsilon-decay-schedule&quot;&gt;Epsilon decay schedule&lt;a class=&quot;anchor-link&quot; href=&quot;#Epsilon-decay-schedule&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;In the DQN algorithm the agent chooses its action using an $\epsilon$-greedy policy. When using an $\epsilon$-greedy policy, with probability $\epsilon$, the agent explores the state space by choosing an action uniformly at random from the set of feasible actions; with probability $1-\epsilon$, the agent exploits its current knowledge by choosing the optimal action given that current state.&lt;/p&gt;
&lt;p&gt;As the agent learns and acquires additional knowledge about it environment it makes sense to &lt;em&gt;decrease&lt;/em&gt; exploration and &lt;em&gt;increase&lt;/em&gt; exploitation by decreasing $\epsilon$. In practice, it isn't a good idea to decrease $\epsilon$ to zero; instead one typically decreases $\epsilon$ over time according to some schedule until it reaches some minimum value.&lt;/p&gt;
&lt;p&gt;The Deepmind researchers used a simple linear decay schedule and set a minimum value of $\epsilon=0.1$. In the cell below I code up a linear decay schedule as well as a power decay schedule that I have seen used in many other practical applications.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;linear_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;minimum_epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Simple linear decay schedule used in the Deepmind paper.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;slope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;episode_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minimum_epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;power_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;decay_factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;minimum_epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Power decay schedule found in other practical applications.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decay_factor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minimum_epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;_epsilon_decay_schedule_kwargs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;decay_factor&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.995&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;minimum_epsilon&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;epsilon_decay_schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;power_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_epsilon_decay_schedule_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Choosing-an-optimizer&quot;&gt;Choosing an optimizer&lt;a class=&quot;anchor-link&quot; href=&quot;#Choosing-an-optimizer&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;As is the case in training any neural network, the choice of optimizer and the tuning of its hyper-parameters (in particular the learning rate) is important. Here I am going to more or less follow the Minh et al 2015 paper and use the &lt;a href=&quot;https://pytorch.org/docs/stable/optim.html#torch.optim.RMSprop&quot;&gt;RMSProp&lt;/a&gt; optimizer.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_optimizer_kwargs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;lr&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;alpha&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;eps&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;weight_decay&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;momentum&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;centered&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer_fn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RMSprop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_optimizer_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;At this point I am ready to create an instance of the &lt;code&gt;DeepQAgent&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;state_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;observation_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;action_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;number_hidden_units&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;optimizer_fn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;epsilon_decay_schedule&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon_decay_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;batch_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;buffer_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;alpha&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;gamma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;update_frequency&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;seed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;deep_q_agent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DeepQAgent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_agent_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Training-the-DeepQAgent&quot;&gt;Training the &lt;code&gt;DeepQAgent&lt;/code&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-the-DeepQAgent&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now I am finally ready to train the &lt;code&gt;deep_q_agent&lt;/code&gt;. The target score for the &lt;code&gt;LunarLander-v2&lt;/code&gt; environment is 200 points on average for at least 100 consecutive episodes. If the &lt;code&gt;deep_q_agent&lt;/code&gt; is able to &quot;solve&quot; the environment, then training will terminate early.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deep_q_agent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;checkpoint.pth&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;number_episodes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Episode 100	Average Score: -154.51
Episode 200	Average Score: -81.60
Episode 300	Average Score: -44.89
Episode 400	Average Score: -37.86
Episode 500	Average Score: 19.62
Episode 600	Average Score: 32.20
Episode 700	Average Score: 30.49
Episode 800	Average Score: 58.88
Episode 900	Average Score: 155.21
Episode 1000	Average Score: 108.55
Episode 1100	Average Score: 140.13
Episode 1200	Average Score: 161.63
Episode 1300	Average Score: 175.18
Episode 1400	Average Score: 168.44
Episode 1500	Average Score: 186.24

Environment solved in 1535 episodes!	Average Score: 202.17
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Analyzing-DeepQAgent-performance&quot;&gt;Analyzing &lt;code&gt;DeepQAgent&lt;/code&gt; performance&lt;a class=&quot;anchor-link&quot; href=&quot;#Analyzing-DeepQAgent-performance&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;h4 id=&quot;Plotting-the-time-series-of-scores&quot;&gt;Plotting the time series of scores&lt;a class=&quot;anchor-link&quot; href=&quot;#Plotting-the-time-series-of-scores&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;I can use &lt;a href=&quot;https://pandas.pydata.org/&quot;&gt;Pandas&lt;/a&gt; to quickly plot the time series of scores along with a 100 episode moving average. Note that training stops as soon as the rolling average crosses the target score.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;scores&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;count    1536.000000
mean       64.637609
std       176.074169
min     -1089.259632
25%       -68.239273
50%        37.594122
75%       238.746307
max       319.191977
Name: scores, dtype: float64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Scores&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Rolling Average&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axhline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linestyle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;dashed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Target Score&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Episode Number&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Score&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZ4AAAEGCAYAAABVSfMhAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAgAElEQVR4nOydZ5gUxdaA35qwgbDknBbJGSQHFRQUQcUMZlEv14TgZ7iAGK6Kcs0RFRNmxAgIgqCSkShZclzikmFhd1J9PybshJ6ZnrQzu9T7PPvsTHV3dXVPd506p06dI6SUKBQKhUJRVBiS3QCFQqFQnFsowaNQKBSKIkUJHoVCoVAUKUrwKBQKhaJIUYJHoVAoFEWKKdkNSBaVK1eW2dnZyW6GQqFQFCtWrFhxWEpZJZY6zlnBk52dzfLly5PdDIVCoShWCCF2xVqHMrUpFAqFokhRgkehUCgURYoSPAqFQqEoUpTgUSgUCkWRogSPQqFQKIoUJXgUCoVCUaQowaNQKBSKIkUJHoVCUWw4ccaKze5Iahs2HjjJ8p1Hk9qG4o4SPAqFolggpaTNs7/x6Herk9qOvm/M5/r3F0d17D/7TzL0m79jFp47DudxusAWUx3JRAkehULhYdWe42SPmMbanBPJbkoANoczaeXPq/Z5yvYeP8u6vZG3VUrJtDX7ybfaNbefLrAF3eZfz4Z9J3Wf98GvVzJ19T52HM7TfYw37jb1emUOd3yyNKo6UgEleBQlnlP5VmasO5Cw+o+cLuDEWWvC6teL3SGxO0JnFL763YXcHqLDmr3hIABzNh2Ka9v8OXQyP2DU/+fGQ5y1ODtWKSU7D+fh8Loeq2t/o0F4yi57fR5XvL2ARk9MZ8vBUyHPKaX0nHPh1iM88PVKXpm5ybPd7pB8NH87Zy12Wj49kwtf+jPsdUxYtJN+b83nr+1Hwu7rbIPzvxAi9I4a/Lgyh6ZPzmB77mkAVuw6xomzVnYdCS3E1u87QfaIaUxetTficyYKJXjOIXYczsNii03Ftzsk2SOm8fLMjREfO2n5Hq57b1FM54+Gx75bw71frmCb64WNN+2fn02H52clpO5IuPT1ubR8eiYAq/ccp/lTMzh8ugCb3UGeyyyzas9x5m3O9Tlu66FTPDV5HXaHxOHqGcP1i1a7g5P5gcL2u+V7yB4xjaN5lqDHHsuz0OmF33lheuEztCbnOIMnLOPBr1dy6FQ+U9fsp+crczhv1HSyR0zz0cLsDukRSG5zk9Uu6fP6PH5YkQPAttzTPlrb8TMW/vX5cho+8Sv7T5zlzk+dwvfw6QLPPtPX7uf5af/wsksYHTpVQIHNTvaIabw/d5vmtax3aTuDxv/FXROWYbM7KLAF15TsrvvrLTzdbDpwimUh5o7cg6fVOcc9ZVe9s4CLXp7DGYuNpTu0j/1ppVPgDJu4ismr9oYV0EWBEjznCMfPWOj1yhxG/bQ2pnrco84P5++I+NjHv1/Dil3HYjp/NOw6egaAsxY7VrtDlwklUqz2wpH5oVP5fO/qAPVwy0d/cdP4v3Tte+R0QVDb/rbcPM66rm38/O2csdhZtO0I9365ghYugaTF0G9W8fniXWw5dAr3VQghePW3Tew+ckbzmAe/XknrZ34DwOGQfDhvO6cLbDz2/RoAco4FHrdi11G25572CKzZ/xzk938OcrrAxlXvLATg942H6DTmd7YdChwkDPS6R8E0jEe+W82MdQe45NW5XPnOAk95u+dmMfsfpxY36se1HrNdhtno2cctdL0HKCN/cL4vY3/dyBqvDl+LPzYeouETv9Jk9IyA61+bc4LbPl7CLtf9/HXdfp/tB07kc9kb87jBNXdkszt4f+42vvirMB6nW1idcWmFaUaDp75/f7GCGz9YzLbc0x6tLs8jlAsHm8MmrqLP6/NCXkdRcM5Gpz7XcHdWi7Yejqke98tJaItOytLoiV8B2Dm2v679c08VIKWkalaG7nPc89ly1uSc4KLGVahSNj3s/gu36jPTrN93gv5vOTvTcO03uzopu8Ph6XAdGmY4KSX/7HeO2sfP287G/c7RcM6xM3yzdA+/rjvA7P+7CLtD8twvG7i7R33mbM5l5vqDnjr+3HSIMdP/YcuhwpG0QUNluu49Z6c6//FeAOw+eoa7P4suQvy2w3k0rFpGc9u9X67wfD6Vb6Vshtlj4nK2t1DjyzAbkVKy5+hZhk1cBcBcL43wx78LzVNXvbNQ93PzwvR/qFo2g47ZFflw/nZ2Hsnj+JlCDfGlGZvYuP8U17evzRmLjXu/XOnZlnuqgI5jZvtcw/09G3reYbc50uIlUOZvcb7Xl7w6l6wME1/e09kjzFMRJXjOEdw25VjlhXsOwSGTL3lOF9jYf/wsjaqV1bX/FW8vCL+TF2ctdk8HoLfDATh4Mh8gYL7l0Kl8KpVOx2gQ7Dl6BptDUr9yac06jp+xYDAIsjLMnjLvDnHBlsP0aFQZgE8X7uC/Uzd4th3Ls2A0OI0Z3prYeaOmez43emI6393bjT1HC0fmP64s7GTdo+uth04z9Ju/aV+3PBMW7eTv3cdY4zWZL6X0mG837C+cZN915AxfLdlNu7rlefz7NSz4Ty/Ptoe/XaV5zd6Ee7qmrt7Hkz+vC1vP+c/N4rPBnYJuP3Ain/ojp9Mpu2LYusDpSq2H6WudZrEJi3YG3WfK6n1MWb0voNxb6IBTSO0/nu8RLs9P+yfkuU/m21gQ4wAz0ShT2zlC5FOZ2jhcg6zkix24/eMlAWYDh0P6dKYn862eEX045m3OJXvENI+X0gvTQ7/g/rw0YyNXv6s9yjx0Mp9OY37ntVnO+YMLXvqTXq/MCVpX22dn0ea/v/mUGb20iGd/Wc8x1zzKi9N959vaPTeLH1Y6TX3Brt1ql3wwdxv7jp/V3G42FnYNU1fv4xmXYFudc4JqZQu1P6tdYnAJqXV7C881+ue1fLN0N4+7TG+feXXAy3WYW38IY6oMNp/hj9UuufmjJUG3r9/vFKJLda7L6fvGfF37xRtvk5seXpqxKeR2Le23KFGC5xwjVkXFPTkqi0DjkVLyvxkb2XLwFHM35zJ/S66PZ87K3b4290VbD3PnhGVc8NKfbHZNoE5b42tLD8Usl0eXe4L3SF7hxPPkVXs5Ywm9bmLcnG2s2nPcc4+fmlw4Ij940lnXnE2+E/tPTw4+ave/xd4T0psPnubuz5aFbA/Apwt3Bt125LTF83v6Y9KY/HZTNavQfGi1O3wEoptymWaf70dCOBtosTeIQIw3e45Gf55npqyPaC4vlbAkeRGuMrWdI7j7BhmjruI2H3nX8uG87YyZ/g8bn+vrM1mrh40HTlKzfKaPSQlgy8FTvPn7Fn5Zs5/35vh6FA1oW0uzLu+R7fbcPBrrNMEFw+Zlpho2cRWDu2fz9JUtdB//24bCeZBg3kyfLQ4cyeaeKggoA/h6yW6f7//sj8076YzVFnTkG8rdt3KZQsFjs0sMGsNXk9G30NuMV1IIZUZLdX5Zs5/r29dO2vmVxnOOIFzGNv8Bbr7VzrXjFvp47Ow5eiZoh+TWJLzr+WCeUzCcyo98JXXfN+Zzy4eBppBbP17CL0G0lR2H88KaHtxeT5GYGP37Wv95rLwoVoov3XGUHYfzPAJba9Ldm3V7TwTY+N1s91t0eNZqZ/aGgzGNXqM59I+NhWt8rA6HppDaquGVlgy8haSiEPc8ZLJQguccIVh/t37fSVbuPs5Tk9cDTsFywUt/8sG87Zr73xLCXh6tNrVWY+V5XkFwl+f+b833mVjWWrwZbjTqv9bixen/8LlL+3CbEf2dAyqUSgtZpxY3frCYXq/M8dQVyoTVacxszXUcXy/ZHXSR4D2fR+cV5iaYqU0vNrsMK0yTifc6HUUhWuuIihIleM4x/LuZQhOcE/e6jVAL2QKJ/0OcF2I+xb2OwU2b//7GoVPaI7hgfeLIH33XM/kL2kOn8n28yCDwZf179zHd4VLcmqLRIALqLTxngY93GjjnUEb9tDZijzx9bTrNb+u1IzoU6FzrFGyOJxXoXF+fp1oyqVwm8sFMtJiNhb9TqAFQUaAEzzmC+zHzH+D6P37uzQdP5sfVgSDSoIiRnvq75ZFN8i4KsXYmz2LnuvcWEc7x55pxi+j3VqCXk9Zho10amtEgIoqx5b4P0Zgxw2GxOdh4QHueSGvuSQur3UGS+7CgpEc435gM7u5xXpGdK8NUeD+UxqOBEKKOEOJPIcQ/Qoj1QohhrvKKQohZQogtrv8VvI4ZKYTYKoTYJIS4LHmtL6b4eaut33eST0J4RGnXEXzTom2FHb1MgGfcyzMD3Udv/CB4BOFSacE7pZdnbtL0dtI7sA8VLy3SFz5WZ5BEcyrfFlXcsaIgzRi/dvVrVT1udXkTawiriPC6HS1rlSu682qQkoIHsAGPSCmbAV2AB4QQzYERwO9SykbA767vuLYNAloAfYFxQojUH+4UIVLjE4ReWLp4m74V9ZH2O57gBwnuU5fuOOpxqvAnM4TgCUawuvwJFacsYsGT2nKH/SfOJn30HIx4zj0lyknhqrY1E1KvFu67UV/sp6POBbOJIiXdqaWU+4H9rs+nhBD/ALWAAUBP126fAXOA/7jKJ0opC4AdQoitQCcg6JB306ZN9OzZ06fsxhtv5P777+fMmTP069cv4Jg777yTO++8k8OHD3P99dcHbL/vvvsYOHAge/bs4bbbbgvY/sgjj3DllVeyadMm/v3vfwdsHz16NL1792bVqlUMHz48YPsLL7xAt27dWLRoEaNGjQrY/sYbb9C2bVtmz57N888/77PNYnNgbXYLlDmPqVOn8uqrrwLO1f8H9p7gdLqJPQOmIDGT9888Tv09nWml0+j5aaFL8vfff+88Zu1sTq+dTc+/XgZg465jWO0O8obPhawMxo0bx6RJk3zOf+KsFXo52/zKq68wfdo0JHDA5X12+ep3+PXXX1m5+xi/THibA19/53O8MTOLKtc4jz82dwIFe30XTZrKVqbylY8CcHT2eCyHnHM2/51VhgO5pzFXrEWlvkMBODLjbZaeOUTPH7M8xx89XY6KvYcAcHjqK9hO+a78Tq/VFHo57+l1113Hhh17OeDlZZZRrw3lu98EwMFJTyNtvpPamQ06Ua7ztRiF4MDXI/CndNMLKHt+fxzWfA5994yn/NLFL3Fgx1HKtOpNmVa9sZ85Qe7PLwYcX7ZdP0o3uxDbyVwO//JqwPasTtdQqmFnrEdyODLznYDt5boNIjO7LZaD2zn6+/iA7eUvvIOM2s3Iz/mH4/M+85Q/OrsM6SYjlmYDSat2Hmd3ruLEookBx1e67EHMlWpzZusSTi79KWB75SsewZRVxfPs+VPl6pEYS5XzPHv+VL3hGQzmDE6tnEbeRqf585fSaZ5BQPWbxwJwYsmPnN3ma+oUpnSq3fhfAI4v/Ib8Xb75foyZWRi7O+9JJM+eG/9nz3q00LV88F+VdD17FS66E4Dcn17AftZ3XrFS4/aYO9wA+D57BiTpWKFBD8p1vpaKnKTsxFuR2Ok583+Q5VyWEGu/Fw0pKXi8EUJkA+2AJUA1l1BCSrlfCFHVtVstwDvKYo6rzL+uIcAQgPT0c9PNMtgIWnq2F+5wLM/CWaudzAht5WctYSampd9/F39sPMhdE5bT/mjoYIzxIJrBsPuYXUfORJ1PJVLtwDvkTSpy1mpPWa0snibAZDtQlOEMpylFdqVSVBR2Nuw5ggUzErjEsIL/S1tNnszkUcNW9oky5MkMWhp2AnCFeRePZjgHjT2xY8FEWukqybsYQBTFCvRoEUKUAeYCY6SUPwohjkspy3ttPyalrCCEeBdYLKX80lX+MTBdSvlDsLo7dOggly+PzRW1OLHv+Fm6jf2DSqXTWPFkH0/5mpzjXPXOQlrVKsfUoT34de1+7vuqMGChySDY+kLhKCh7xDTPZ3f8so5jZpN7qoAloy7BbDRw/nOzeOjihtzd4zzaPPsb4245n7IZJm772DnS3DLmcsxGAxabg8ajC4N2umOO3dG1nu7J7XC8dF1rHv9hTUB594aV+OqeLmzPPc2v6w5ozhH589DFDfm/S5tw4/uLdYdY8adjdgWW7dQfobtd3fL8vTt2QXxTpzp8s3SP5rau51Visc58MsWJK9vUZKpGLLRoGHLheYwPssQgFnaO7U/2iGkYsdNU7GGzrE03w3qOyLI0FjncYJzHKNvd/Jn+CIvtzRG129Nl/xcB9VikkQOyInUN2h6Tbh623MdPjh7sHHtF1G0WQqyQUnaIugJSWOMRQpiBH4CvpJQ/uooPCiFquLSdGoB7JVsOUMfr8NpAfJ64EkIQJcNre2BEAijM+uhPsAGge93Er+sOcFETp0L64fztPNKnSeG5PAGuI181HzFBqnLb/2/5aAn7T+hcTBeHdkUidAAOnYzPOpQGVbQjOUNcLiupNBO7qCsOMdPR0ac8Xi7DBhxkFRygEic4Qjmqc4QbjHOZaL+YXMr77NvVsJ5v0sYA8JO9O5PsPVnhaIwFs1bVAFTlGCPNX3ONUTvO35/GR5x1GzfAfqe7fYE0cZpMtsma2EpV547jd2PFRFuxlZ/TnwLgNev1/OLoQkVO4sBAbkY2exxF574dipQUPMLZ83wM/COlfM1r0xTgDmCs6/9kr/KvhRCvATWBRkDxzQubQPw1XP+IBtEowFqu2sHWCzm3yYD9vSmKRX9u4RZJbp7TLpfmovQ0i5dFIpQwT+UFoKGownGuNi7gCfPXAIy2DuZne3dOUwqARmdWcYtxNRPtvbATuTNJgyql6d+qBnXmPcoNq+fxYAYUSDPpwrlg+UrjYi6z/I8+hhVYMTHEOM0pHFxcY1zoESZnZRp7ZBW+t1/IakdDlshmZJIPX93I0ozAXElT7F3Jl2kYhZ3rjAuYZLuITFGAuWFP+t4xkiZelocutStiPe7UwFfJhtxrGU46FiY7egCwHacDQ0VDGhBZzLxEkZKCB+gO3AasFUK4Y6iPwilwJgkh7gZ2AzcASCnXCyEmARtwesQ9IKWMf7avYozHhdmv3L/P0dupanVVR/MsPovUgu0vJbwyc1NAqBd3HxssVE48iWYw/MnCHdzapW6Rzmns06uNhSHU9bqfgbriIA+bvqed2EqmKOAuy2Osl/Xjcv54crdxOk+avwwof978Kc+bP2WOvQ1WTPTZtQLM0Mewgrds11BbHGabrMl6ma3rPFLCjfxGbdM8jta6mDW7j9DTuJoNjnrUFQdpbNjLi6aPGGSa4zlmu6M6t1tHUJmTNDbsoYnIoa1hKw3EPuqJg4wyfwPAHHsb0rDClg0cl6UpL/JY76jH9ZanOYtv7qcR1iFYXV31/dUa0Nevnf4DhxkO7TQQqTS8SEnBI6VcQPD7dEmQY8YAYxLWqGJOOI0mJo3H9Uv1e2s+sx6+0FVP6Ire+XNrYBsiP3XUuF/WSM1623OjcyooCtrWKc+qPdrzQe7rNWLnfLGFPsYV1BRHeMp6J9eemMZH6ZMwY8MgCn+Fz9L+x42Wp9gui87lNxwdxEYfobPBUY93bANY5mjK0+bPuMK4hJ5Gp1fa3szGrDhdiauMiz1lAC9bb+QEpbnZ+Afv2AYw3dFF81zXWiZTe9EnYDBT5qZPuPP5hWRZz3CS0gwwLODNtHEeobPI3pxnbHewWdYGBDlUZZW9oU99Zmx0NvzDW+a3C9tz/u20XdSXKhyjgLQAoQN4hA5om0X1aqyppNimpOBRFB3+IXNi7fyDPtzeprYilDA6mhMRv288lLJLOkNqNTh4zvQJt5l8XZGvMP4FJwEBE2yX8q29FwYctDZs5xnT5/yR/iibHbV42TaQXbIavQ0rmWjvxVGytE8URzLJx4GBmuIIX6WNoaZwmpPyZDpv2q7lNKX42l44Dn3QOoynrCf5Ke0pdslqzGg0jq+X7mGmvSPNDTvZ4qjNE+Yvecxc6Oo/Lu0tBhRUZrUsFBJVOMac9P+jtKUATBlw9ywMmeUAwUmcifsWOVrwu70d8x2t+Mx+KVLHkkgrJhY4WnF+wXjOF5tpYtjDi/3GwqJZ5FIh7PHB0C9QUkfyKMFTgpBS8sDXK+lcvxJ3dMv221a4T7Bjg22fvGov7epUoG6lUrrbsi2EZhDMnJcMD8tIX8Vvlu6mfb3oO4lEEspVu8G+qXR3CZ0ljqb85WjOEkdTPjP/jyPm6vQ/PZojFK5mX2+vzwpHY35L/w+NDXv5MK1wqvVx87e0z3/PZ/94U50jTE0fTRXhG0D2d3s7hlsf4BTaz+JRsrjI8gYAt7nyNUxzdGGaS6v5s6AtqzOca2a+s13IDaZ5THZNxgM4pGCXrEppUcBeUY1a/54KVZpg8HOyyaUCd1sfi/r6VsrGrLQ35kVTZJP9WouY9WrtSuNRxI0Xp//DxU2r0vm8SkjpTLk7fe2BQMETxGtNT18/bOIqsjJMrHlGOxJRsBX9M70CUHrvk8Ie/LpI1SUI/iaXUuRzq3EWdgx0X/cVuxxVGWB5juMULgruWDCOdvXqc2RzYKrkzbIOFxa8zlvmd2hrcKa+WO5oTAfDZlZk3Mck20WMtd0Ud+3nRuOfvGT+EIBcmYUDA9/bL+Qb+8XkyCroHS5oCeITlKFt/gfkkYkVEwsdLXnZ/AFm4ZwSNghJfXGQcbar+KrMYBZWcXpjpkqnrW1q03lsfJsSE0rwFFO+WbqbNrXL88G87Xwwbzs7x/b3ESo//72X0wU2np6ynhnDLvBJZaxFuDmek35BKh0SJizcwZ3dg08+eweg9PVqC+Sv7Uc00yPESrDRoLs4mg4lNcVOoeDpIDbyffqzAdsfsj7oI3QAjlMWg1YmNxe7ZTWuszzDBYa1zHe0wo6B183juMa4kBtNc2ln2MqdlsfZS7wWJEoeMv1EgTRxo+UpHxNYpASb+/C+Bz87evBzQXcyKcCMnZ6G1UxxdAWEzwr0VI1HB8VzjidVY7UpwjDyx7UBkZG9E5cN/3YVo39eh90h+X5FjqezPJVv438zNnpG7f7JziJxFX7GFcLf94Eu/OLOkyOlv1db4DkGjf+LyauKcumV8Ptf/Glg28q0tJE+QudZ6228ar2e7/osDtqJh+uQ7BiZ42jrckkWPGx9gK75b/OU9Q4aGfayMGMY7cSWuFzD7cbfqC0O85RtcExCByDMWMsLwVkyOElppji64X4m/N+NVEDrp9L7BOuNNVgUKI2nBHE2yJoUiW9n/96cbdzfswFlM8wBizlDvWuRmpiCRd5Nvdc5MlKwP+ISwwqeP/SqZyj5pPVOvrD3wd0tjTUHX0Cqt+vqlF3RE7FhP5X43H4ZZuw8af6Sn9Kf5v8s99LMsJs6IpdPbH1ZKpuFrTMdC/8zj2eOvS27ZDWeNX/GGkd9vrdfqKtNoTDEuIA0FQWP1ihBzfEoksron9ZplksZXI/xLw+Vg2bGOu2kYd5oPdxC+L4cqfQ+p9LLGC3pWHje/CngDImyRp7HNukbqjDUdeq9BzXKB7r6fmzvRxVxgntNU3kt7X1PeTvDFq4peJZ9VA5Z573GqVxtXMTVxkWesjHWW6Na8OlPrPHVUuk5DUVxfIaV4Ckh/PR3DlOCxKUKJUwc0lfTCaXVHA4R7t+Nrpc1BdypYyGV+qNWYjtT00cD8GmlR/hpb3vN/UJHLtB3rmAd+Uu2gRixc4dxJs/Y7sSBYKz5IxZlPMRY6yB+sF9ALhVIx0IbsY1J6c8BsNNRjWzDQZ+6BllGs0SHpqSrvTFrPHFpRlzRuiLlXKAoErSEw8PfrtbY04lDygCBUBiN2vd7rHindQ72oKdCcjOPc0FymxEjktfN4wDnGpyFWf1g70HNPUNNQOu1/QczXTkwMMZ2K2Nst3ralS/TeCNtHCPMExlhDkyTAJBtOMgmR20esj7IbcZZTLV3Y4lsxt9P9qHdc7N0tSlke2NWBZL/nPoT2wLS1HnaleAphoTKcKmFU7hIjTKN8qhb5eS5XzYElEnp59VWlBpPkHetWlb0aTH+2X8y/E5FwKWG5TQ07ONl6428a7+ay0JMpofqcvT2R/qDbgp+dvRgXn5rvk17jkaGvT5bv7RdwiR7T9bIBp6y0ba7PZ9Lp8enW4pV8JQ0U1sKyR0leIojwSJGhyJA4/F4tfl+j0by6HmefbzaIj9F1AR72dz556N5GYs0XbEGaVh50fwhVxsWclCW5yO7M21FKNNSCI9p3R10pJP1R8mij+VlKnOCRoYcjsmySGCTrBvyuHhlNNXv1aZNKjoXxLKANJVQgqcYEukLoeVc4Naa/OVNNC9buECWTucC3/YkkyxOQ7GMISvpZ1jCaPOXnvAxdxU8RgHO1e+hOqBO9SsFrzbGOZ5wHKYchx36oxzEK5N27F5t8WlHPInF1JZKqHU8xZBITW3fr8gJ0HgCNB0XoWqO9vGW0jeETjLeZ4FTS6lFLovThzJoy6MgZUqtbXAjcDA9bST3GAtD39fkMFPSRjMu7S2qcIIvbZfQIP8Ln+jRoQRDjaxAj7TC8+lsVxHdqniN4PccPRvT8ckeIOkl1X4/PSiNpxjiiNDSk2exs++470v4r8+Xc1WbmjSr4Qp3EkN06nCs2nPcJ2pyUb/PVxsW8Lz5E86SDkhKiwIanvwLPu1HmnyoaBujgwsNa2lu2EVzwy7WOM6jt3ElQ0xOIbTM0Zh7LI9ygsB1OaFMVKHdqXWa2lKp59JBtCbRNrXLsTrnRErO8cTi1ZZKKI2nGGKLVPIAeRbfkDer9hzn2V82+HiYbdh3Mq5ha4LNK3y3QjsFc7y4xziNnRk3syz9Xq6Z3II30sZhxkYVcYJ0rLxhu5ZdZdrA7kV8aHmcrob1pIYHk+QF04d8lvY/T8mk9Oc8QidXZjHUMlRT6ED0wiWVRszdG4YwCUZIsNxQ4Rh9RXMg8XM8jauFWtSrjf9vcEGjyjxyaRPtnVMYpfEUQ+xRvBBBowh4zfH4h+BJFFMSFBrHgIN7jVN53PwtAFXESSQGljka8ZR1MBZMbJc1AMHxRvUYvu8Rmhz8i2/SxvCp7TJetg3kjEY+lHjRQOzlsCwXIDjqiQO8ZB5PZ8NGwBn2f5xtAFMcXfkx7RkqcIouBe9yOEw06GjnYPSvA5pt7zoAACAASURBVEms5CmbYWLCYO0kZtEQraB0H5boOZ7pD10Qcx1f3N05Di0pepTgKWZc9c4CdkSRjKwgnOBJwOguWJXewUPjRWVOsDzjPgD2OKpwleU5jlGWNwa2Y/i3qwL2n77uAJXajmHm7sU8Z57AYNNMBptmss6RzSPWe8N6XumlqdjNa+b3OCrL0MO4ns2OWlxjeZY8MgFn7pe56f/n2f+gLM9FBa+Tj9Pdu1vB20jApuNVjdYUpt/UFlX1uimVZgwbzDYSbPbonunCHFWJlTymENeaZjJQr2Ipthw67VOeiua/aFCmtmLEom2HWZNzglMFtvA7+1EQJI7bJwt3AIkxNBXVS3K/8WeP0NnoqEMfy0scI4tQRqRDpwp4df5B1snzuMUyim2OGgC0NOxkZvoIXja9z/3GyWRQ4HOckdDecPcap7A0/X52ZtzMzoybmZE+guaGXfQwrgegsWEv482vUQ2nV9p7aW8CcEpmkp3/FZ0LxnmEDjiTh+kROhC9F1eyTG2taycunw9E7oTjJs3odLUf3rtxPJsDQJ2Kmbr2q1+pNMN6Nwooz7MUR2/MQJTGkwRyTxVQLtNMmikyuX/zh0uiPqc7krQ/f2w8BOgTEpF2PIm0kWeRxwjTNzQ25NDBsJl8aeYLex9etN2Mw2s8pafNZ8jgEssrVOIkg00zeNA0mRtM8wAYZvqBSyyvMNL0NW0N26gljjDJdhGP2/4dUE85Tmuu0p9jb8NI6z0IJOPS3qS7cT1LjA96tr9qvZ637ddGcRd8iVpZ0L0AMb6Sx7++eJvyrFEKHoMBdo7tr2vfu7rX9wzealfIJOdYcE+6H+7ryqo9JzQXWfsjkVTX8EQ8XWDV1S6A/17VgqenrNe9f1FSYjQeIURfIcQmIcRWIcSIZLcnGFJKOo6ZzcOTAs0/ySRas8J/pybnwf49/VFuNv1BB8Nm/rS3oWXBx4yx3eojdCJDcIRyvGIbSHb+Vwy1OAVDurCxIH04/Y1LqSWOAHCjaS5r0+/mVuMshhinUpPDdDWs5+e0JwEYbrmf1vkfcm3BMzTJn8Cd1v+wn0rsozIjrP9ioq2nz5nH26+I9jb4EK2pLVneav5njaYZC0dczD09tHNC1amgT7vQS6f6FQPKmtUozO1TJkzEhfb1KkYkWrUy3Z4JofHUKu97vYM61YngbEVLiRA8Qggj8C5wOdAcuEkI0Ty5rdLGPQibvnZ/2H3nbs5l8qq9YfdLJp8u3Fnk5zS5PNQARlsHc5f1saDmqOen/RPFGQRTHd3Izv+aL22XADDL3p42+eNpkf8xAGXFWZ43f8oo8zcsyniIb9LGUN9wkBn2jvzs6MFJSrNSNvYs7nSzUdZlhG0I7fPf4ynrHXTIfy9gn2iJeo5H735xlk/xmDOqVT4TcxDLwV096vPkFfHrBib9u6vn8/l1ywdsj/b+92qinURPU8MMNm/6XF/+fLSn7/EpuEbNTYkQPEAnYKuUcruU0gJMBAYkuU2auO3O7of0s0U72X3kjOa+d3yylGETi0YzSoRVLN6mtgqc5ALDGh40/QzAvZbhfGnvgwzxGOeeKgi6TQ+jbXeTnf81/7I+wgnKkEcmPQre4JAszyJ7c47L0j77P2gdqqveI5Tjc/tlYT3VQpHu1+FGG2pGCJj18IUsGnFxSE+reHdkida0TAbB3T3qc1/PBq7zxa/urEwz4Csc3Pf/ls7BHVP6NK8G+Aqx/1zeNGC/YPc62BuVYTYGmO5TedlVSRE8tQDvxSE5rjIfhBBDhBDLhRDLc3Nz/TcXCe7OWABnLM7U1APHL05KW7xJhOCJd52vm9/ji7SxDDf9yB/2tsxwdIzvCXSSI6vSqWAcN1tH06PgTZ603kmvgldpkf+xbkeAaBnYodB80r91DZ9t0XasBiFoVK0sNctnUrF0cO0r3l5t/h2jVvX/ukDbjKarfleNlzStCkC7uoGmKy10zXdqlLmdOzpmB5rk3NSpWIqdY/v7mO20BHA8POpSWO6UGMGjdY8Dfjkp5XgpZQcpZYcqVeKVIz44+46fZcGWwz5lbsHj/bAdO+PMc5NXYMPhkCzedoS8KDzXEs1qr+gDevB3BY0cSVOxmwZiL5cZltHT6Ez98JmtDw9aHyIVXq3TlOIL+6XskDU8LtKxMqpf4AjYTVWvqNq1y2fSxsszLBKvttpe8x/Jim58e9dsKnkJOi3T0hP9YzCVuaqrVMZ5z9rUDjSPeaMn+nZ2pVLc1qWeT1vfGNiWNnXK416vGqmmH8ltjWTZQyoHDy0pXm05gPdMWm0gMasUI+CKtxdwNM/C9hf6eToF9xyPEIUjMoeE0wU2Wj4903OsWyUHWLf3BL9t0M6zUpRMWp4T1/q6GtbT1bCeTY66THN0AWCAYQFPmz+ngDRquAJhujkj0+lneYGdsoZWdSWG7EqlQ26vUjad3FMFmIwGJj/Yg+wRzsgGN3Wsywdzt4et/8f7u/Hod975m5ITMqdRtTKseLKPp/3ezHr4Qt1j/mB9sbu59SuXZvpDF9CoWhmPB1ql0mmYjIKDJwtNsY2rlWVDmJQXcx7rBcDdE5Z5yq5uV4ur29XihvedWVQjdaYLdVu/+VcXbvrwL8/3SKpOXbFTcgTPMqCREKI+sBcYBNyc3CbBUVfGzk8W7uCeC84DfOd43Oq0lJJjftk9N3ktsrx23CIs9uSG4o+GqhzjGuMCqoujfGjrzz4q4X4dOoiNfJM2xrPv7Y7fKMtZmht2+dQxz94KieAkpXjJNpA9sholnVAdvJQwqGMd3v5jq0952zrlKeeadwjH+XUr+HRK3gP9UCaeptWzdNWvl1BzRo2qlQ26TX/9hTSv6dv2+pVL07JWOSYs2hm3c7h/t3gsxnbfm64NKjHr4QtZsPUw/w2yJCJoHSkseUqE4JFS2oQQDwIzASPwiZQyZRzYf/p7r0fwODyCp3Ck5pChk4slegX1AMMCck5UoaMhl1WyATtlDdKxROVtZcJGPXGQseYP6WjY7CkfbJrJRFtPzMJOBU7RxrCNA7IC79iu5nnzp3Q2bGSloyGnZCZDrP9HQ7GXPx3tyJHaJtFWtcrFNa5cKhEqd44W/zzbF5NRRLRS39sMo7eDKpsR3+7C37IV744ydLpvEffzuZ0LIn9bQzekUbWyrN/n7B8ikWnK1FYESCmnA9OT3Q4Aq93BEz+t9Xxfv+8k6/aeoHmNrELnAiE8n+0OyZAvVvjU4S1s0owGrPb4rFg2YucCw1quN87FjJ3uhnWUEb75dE7IUpQTTk+7Wfb2fGa/lBxZ2WPi6uE63oDkeeutHKI8LcROXjB/TBuD09RzVqaxwVGPmfYOnKIUT5m/YJBpjuccBdLEbZaRLJXN+MZ+MXYMeL+Ai2kR8jqKY0RevUTaYWSmOVfaG4X+XqlFzSy2uubg9HqrRdOPVSqdxhE/bT6W+iIhVPUGg+91Lx55MXdPWK6/bo3KPYLHSzr8dH83rhm3KOK6/AebKSxDoqLECJ5kcirfyu6jZ8jKMGNzSPYcPRMwH3LF2wvolF2RW7o4XS2F0D8ySjcb4xIqo544wIumj+hm9FXZ59pbc0BW5BSZ3Gmc6RE6AH2MK+hjXMEZmc5d1sfY6qjFl2kverZfZVzMWZlGpnB2LvPsrTBj51nbbfwj63n22yRrc51xPj/aL+CELM1uWdUTLNOOMeJr8e6c/e3gxZ1QwT4lwXMIhXMumP94L0/n+PzVLZnsCtZaKl3f/Y/GnbpMhimE4PGLXKCz+vqVS7PjcPh4haFMlkaDr8ZTo1x0jiHedbjP5z3Ho9eTTi8lJFSbEjzx4M5Pl7Fi1zHP96/v0Y4Yu3TnUZbudE6YC/SrzbHZjCWlKOAl8wdcYXSG3HnKegff2nvR3rCZ0zKTNbKBZ+93bFfTROSwRDYjHQt9DCtoatjNTcY/mJj2PLscTtfU4Zb7qSBO0dKwg+uMCwC4ouB51snzNFux0NGKhY5WMVyHL+4OdMLgjnRtEL9Q+qlAuEn8aB+HOhVLeT67V9lnmo0Mu6QwJliouuNuCovimCta1+Dtm9pRf2R440ao9jaoUsZz/lBehCFqDygxehyIYvdqC7qOp4RECVWCJw54Cx3Q59ZqMIRWebyzJ0YXckrS27CSj9Je9ZTkyMrcbxnmETSLHC0DjjpOWZbIZgAUkMYvjq784ujKJkcd3k57h3qGQ8yyt+dnRw/nAXZ403Ydx2VpTgbJE5MI3LdY69ZMe6gHt3y0hCpl0uPg0l30aHWYgzrWYeIy3zxGWk9Z3xbVmbH+gI5zCM14ZBnm4NpPvK090XjJCSHiMnfxRP9mvDJzExCdIA+Vgjpyr7bw15PK8zXRUFLW8SSNb5ftDijTs4L8+Bmr7pHRibP6AwMClOUMk9Ke5aO0V3FIwXR7J24seJIeBW/5aDeRMNXRjbHWQcy3t+Q+6zCfbbtlNd1C56GLGwaU6fXG8sbTaWncwhY1y7HqqUuZOfzCiOuNFU9G1xjwfyxu7VLXs+4m3CPz/m3tYzp3xdJpvHJDm5jq0It/X6pHEGntEew9ClVdusno6cyljv31tKNlLedvX7VsusbWyEi0Q1GyUYInQhwOyZxNhzwq739+WBuwj96RXCIerasMC1mWfh+dDJv43NaHJgWfcb91OEtdWkwsvG+/ituso2JanZ/uNaL+ZWgPfry/G02rR+4663FdDXEXo00TANC/VXRrhWIxhXhHDfjp/m4+2/w7Sb3MGH4Bvw6LLOFYp2Ar74VT84oX0Wk8gWXBvPnCzUm5t8ZivfJuz9CLG/HT/d1opxHHTU879OwTS5+RSrHblOCJkHf/3Mqdny6j/sjpQVfyX/deaC8WN/G2115lWMhbae+yR1blVstInrINxpoEa+rHd3Tg7yf7aG6zeq1HalmrHOfXrRBVTDe3y3G4Q+tVKhV6hyB08Zs3Gt67EROHdImqLr00qlqoNXrPxwQj3F1bMbo3TatnxUULA2fHdWmL5K6j0uo67UFSwYezPAgdg5fgx2qfr13dChF38Fp1+dch4iB5UkmLUoInQvadKJx7+WzxzpjqiudjUIVj/M/8IQA3WUazII4T+ZGSZ7FTvpS2+cw/dDvot4lf3rK653PhYr3Qx7g7nytaR6bB+PdZw3s3pst5iXVi8NYAguVqktLpKQbOjJ2hcIeKiRdxj07td5N1mdo09gmWCj6cwuux1kYzxxNCuJRkV/94oQRPhFzfvtDUEGs8tXhFb24udvJT+tOYsXFxwSsxRTyOB6XMxqCToQ2qlgnIPKknU+RL17Xm3osK56eEZyI39LFGnQIqFXDfMiGca7fcSOnb6d/VvT4jLm/K7V2zNet55srmVC4Tn1QLPu1LgfoyNYRtsKAe4SbkC01t0T8cWgIoUkeASDSkVNJaYkF5tUWI2Vj4kOhZSxCKHbmxHQ8wyPgHY80fAc7gmdtlzZD7t65djjU5sa34b1KtLJsOntLc9tU9nekWwr1ZSvjxvm5YvezydSqWYlWYAKRnLDafEbHeUaVb44k2DXKySAuRTjTNZPARwv7c2b0+d3avH/c2CSHiOk8QzRzPCI0UAsFMbeGISeMJ0fRIr0rXAlKKzwBKD0rjiRCTVzyTzQdjc9UdOD62RY+VOMHTps8BZ0K0Z2x3hD3mqjahBZMWbev4TpZ+dEeHoPt2b1g55IhPSonJaPAZub54bSvev7U9HbODL7bLtzk0F+u530PvdAHeeASP6429O0i2ymjQSgYWS8fQxOVkUaFUGgaDoHG1QE/BZI544x/Sxu+7jmOyMgJNuNGGMfR05n7lsaaBT1XPZ+VcUIwxGZP/49XkMHPSHmZFxn2YhIOLC14JmxDNjZ7Q7/54R8oGp4byQK/o3LK1FI8y6Sb6tqzOh7cHCrSHezfmmna1uLlzXZ8RcmF4Euf3MdcErkkCuLqtMy1TjXLO/PWZIdapREokI/Y+zatxa5fgCcIARl7ejEn/7uoJaHlbl8LID0XZaQS7rGhaEOp5CzhPlJcYicl68gPd+dHlMehuWmEYq+jO7088fqtgzgWxDGxSyUynBE+ERNNxx4rAQW1xiF/SRjE/bRiLMh4i2+BMk7C+3dOkVWuiu65gaYIjJVRYl1CE6iT8X7bfH7mIYb0b8frAtmRlmH2EfuGn0C/TPRfUZ+NzfT1rK8K9fDd1Ci0cvIkkgdeFjSp7hGAw0kwGnwRhblJlBK23Hc29vOg+viN4sr6AzjWqVoEtAjNqmzrlOd8VxsbkMme63bEf7OVcY1avsn5PSM17EuGF6LmvKfIIxA01xxMh5hC291hJx0J1cZQKnOYZ8wTKkE86VuoYfLOlWqWRB60PMdPRkbey28GOrZr1aWGONPQx2pOvWmtksnRELw45YvOr0l+4ebsb+48Ag5n3hBAhV+O7KZ1mDNDs3FzbTltgRCoQgu3/0vWt+X5F8FxHPvcsqYNWfRfsfZ3ZlYPnFtJ7//o0r8asEPmoHFHO37k9B90u/n1b1tCM5qBFKK0m0uciEfM2K0b3jn+lcUQJngiJNq99OCpzgh/Snqae4ZCn7G9HQw7IdOqQy5/2Nnxiv5xljibkk4a7E4i0NWZTNIv2Ao/xFwovXtsqqLZQtWw6h045E26F1HjCrGT3bof/HE+4q/Ks2Qhy+vXP9gVg5I+FC4LDdUKRmNoKE54HcmOHOtyoNUcVReqCeOCO41Y2w8Sp/ELPTSGI69A7wNIW5CLfv7U9DUYFj81mi9K5wD2IjCrXVRydC3Sdzj3Q0jnyiLcrfbxRgidC4j3HI3BwpWExQ00/U89wiE2O2myWtZlgu4wV0mVC0xkx54u7O1GhVBpXvL0g6D4mP41ncPdsPl24M2S9WsLWX+PRMr09d3VLmlYvS92Kpej8wu9A7C7kQy48j91HznhexEjt8xLnfM/+E/lh9w2HlvLovry7e9Tn4wU7POUOh4yL8CgKhadC6TTmPtaTVXuOM2ziqqD7ta9XISBOIcCwSxoFpPlwc1Onunyz1BlmSq/bcbjBnrdwjIQ017tsjXOSxYjdqXXtHrtXm3IuKMZEY6oKxey0x3gr7V0aGfYyuebDXGZ5iaHWhwqFThiEKHzQM83GsHGizH6Cs1pWRthzaAmVWzrXpVeTKrSvV8HTDn9u61KPjtkVfc4Ryiqi57UY1a8Z79/WPmr30niaNUJpPNdomOdiee0rucLpJGJ9jhb1KpUOMCt7t//CxlW4vWs9tLi0RXXN8p1j+3N/z+icUkLh1rTXPHMp/75QOzq6Fu7rs9rim7otUqNIUblIp5JzgdJ4IiTeGs9H9n7k2TKY6ujKQ/WbwPYtEdfhbpEeU4i/xqPHWUJrxFm+VBqfDu7EkM+dybP0mp1Cm9p86wj5ovi74oZbLOhlqojXL6h1Tu9FoN7IIPuH4pKmVfmvQXBz57o0q56F2WiIOAJDPAnMnxPbnfQ/Olor9pVtanJlFMsEPIInCo0n1LX7axblMs1UiUPgUIhd4+1cvyIXNKocl7bEghI8EeLfccfKN/ZLYjre9yEXYQWAv+DceUR7Eet9PRvw3pxtZJqNIYWt+3R6b0uoVeL+Z6msw06t90X03CcJrWqXY188TG0at8Xj7KC1oj3C+muWz2TrC/08368O4uSQKAJSU+N7DVrXv3SU/uc5Erl1dduaDAjjFQiRdczutWTRCFD3EVqPs391q5++NHRderza4uBOLRB8+++u0VcQR5TgiZBUWMcTDCF8O4YqZdPJdU3qu/EXnLu98v4YDcKzwv8/fZt6EoT9sDK8x5VujSfE4NK7inAT+4Uvvr430bvu1we2Zc6mXO7/aqWuY4MR6poDNB7pG326OOAfL877mqSUmtdf1WVWnfJg97CRPSKZc3hjUDtd+4WLX+fNpc2rce9FDSIyz/kTl3k7PQtWNcqCxfMrDqRcy4UQLwshNgoh1gghfhJClPfaNlIIsVUIsUkIcZlXeXshxFrXtrdEArMmhTNN9Q1i39ZDNIMZ7ysVFHaGaUaDz9yMe27AXzPpUK+Cxw3aP6xMhtlIhtmoyxyn95brWcejp6pIw614BBVQKs1EjziYGzQ1Hvf5NExteiJOpxJpRt9OXOCbhC3UY9G6dnldGoo30YTQ8SdUKCF/TEYDIy5vSoU4DwgS64HofML+ebYva8JoUqlMygkeYBbQUkrZGtgMjAQQQjQHBgEtgL7AOCGE+814DxgCNHL99U1U48J1sK8PbJuoU3N9+9oBZQI/4ROkeY4gmskDvRoydWgPXh8YPPlXqA7EXZ3eBaV63Kn11OTv1aZ3f7eGlJVhZvb/XaTr2OB16rfzF0fSzcE1Huf3GK8xAbdIz5qteKJpaotDWoTAfXx3ykwzRnytqeRckHKCR0r5m5TS7R/5F+DubQcAE6WUBVLKHcBWoJMQogaQJaVcLJ29yufA1UXVXv9gjokc7VzmpU1VcKUd8BU6vkEcvbd9cmdHrm1XK8DcYzQI6lUqzTXtanvWb/ij5wHXOzGsZ62frlTArv+x2LwbVo0tVbe7DW3qBMZsCzS1aTc0GVlS9RIqUCnErqEkKgjIeVWCL1otChK5gFQFCS0a7gJ+dX2uBXgnnc9xldVyffYvD0AIMUQIsVwIsTw3N1drl4jxt7PGw1ygB28B4q0pCHeCNL/RTds65XltYNuQL/svQ3tE3Z5owqkErUvX+SJzp05UdN+dY/tzr9ccgVvA+F+D1nnb1invCQyaioTTePyDx0ZaZ1mNgJ/xYObwC9n0fMKMHmFJRA/gbSqOvo7U0cKTIniEELOFEOs0/gZ47fMEYAO+chdpVCVDlAcWSjleStlBStmhSpUqsV4GAKf9cvJEO4qrHyK0iFbdhWssfDUcXx83LYI3MFR4k3Do7dD1hFCJJHaVbq+2Qqe2uKPV3kg8lVKVRlXLclOnwogK/kkRonERrlo2gwmDO7LmmcD5iXhNzZqNBtJNiTW5hY5OHb2pzb1e64GLG+o+X3EkKYJHStlbStlS428ygBDiDuAK4BZZaKPIAbzjitQG9rnKa2uUJ4VoNJ7H+zZhxvALPL33pa6YYV3O8w0Y6V11ehCPFu+HXusFqF+5NDdozBWlAqFckQPwm7OJ9BxFTSrZ1/ViNAhevLa1R8DEq/Pr2aSqZnqD4kSo5yiWBaSl003sHNs/qvQlxYmUM7UJIfoC/wGuklKe8do0BRgkhEgXQtTH6USwVEq5HzglhOji8ma7HZhc5A13Ec3LmeY3QmtRsxw7x/anfmXfOQjvDtmt8Ti1HH2eRuDsTF6+IbgjQbTEc0SmlWUy4HxBcqmEI54CoPCaCy8+ktqL2yA20aPu4nY/gpEIp1p/55hoSKXBTyqu43kHSAdmuX7Av6SU90op1wshJgEbcJrgHpBS2l3H3AdMADJxzgn9GlBrERHNQxfMMytUVcGiZAdzLkg08dAkMsxGRlzelN7NtKNEe/Ofvk0osNm5srW+kWGkc0KR4L7PPZtUYfdR91jJ9+ZXL5cZtE2K4kc8fzp9puXoBlqpSsoJHillwxDbxgBjNMqXA9qZwBLAp4M7MvjTZYDvostoCZozPkSBO6+O9z5SxmeFcyiCRaCO1+n0rsOompXBOzefr7tevf1ErfLOBZCVSuufv/CpW+NGfH5Xp5QIUxItWibQRArw4kQqaRHhOOedC4o7vZpU9bwkzw2IXd4F03gevdQ3UKj3Y+O9qDPYOp5EvMj+a4nKpDtt9aejjBCcbL66pzO/PVzo0nzvRQ14/9b2XNYivNblJlTMNnAG1NTap+t5lSJrbJJxBqT1LTvPy1lkSQThchTREU7g929VI2Fu6vEk5TSe4kY8MpK6NSb/Z8p/RbWP44BGmdPFr2ifupouDcHfuy/VCCaEuzf01URMRgN9W0YffUIv8x7rRa0Kgea31CR4NqEf7+9G22dnAcEjnb978/lsPngq7FmKo8ZTZO+bTq/Md2/RbwVIJkrwRInA+RDEI3abv6nO+wVcPro387fk0r5uRZ+Ant4J0IK1YFDHurw8c1NEbTm/bvmQibH8O4f7ejagwOaIKGV0MmhVqxwAHbMDU0vHSrD7/9fIS8izaAvkupWKV/gc0BYM5UuFDzfTv3UN+hM+qnYqmYL0UlSmtmjvzOsD22C1SR7/YU1c2xMrSvDESDwykvp7qnh/rVwmnWvaOc1bbsHTw2uU7t8ZuJvTomYW9/dsELHg+fH+7iG3+19tqTQTo/o1i+gcyaBDdkVWjO6dkMyMwUbq1cuFz3VUHCh8Hr216+Izt1GcCBf4M1Kvtmva1WZXkAj0yUTN8USJ28QVS5qEh3s3BsAeZLV74Dmd/yUy6ANoMhr4/t6ufH5XZ+U15Ue8hY5WUNOS3B37u+7Hm+IwN5FoPrmjo2Z5o2rOCBclZX2PEjxR4n5HwoSzConZ5KzFFmSOJ/CchS7Bt3R2Zn9s6TIhOcudNXTIrki5UqEX6EWqqbWoGT7UjaKQktSHept1PWUlWcLqIBG/b63ymUFNsLXKZ7L9hX7c0KGO5vbihjK1xUgsWoU7orMjxByPNzVcE/kdsivSu3m1wpw17jUqEZx75eg+Iedy/HE7USgtKpDiODcRDeq3jwy9g7vqWRl0ql/RYwEJhqEEqYRK8ESJJ/Omxst4ddua/LwqfNSeK9vU5L252xikc2K+QZUy/PHIRdSr5BvvLJrHMZxG5E9xGeDqiXmXKKSMbWV5qhIs8KmbiqXTOJpnif1EJUiwvTmorcehJRwmo4FJKZIZtKhQgidGtAYhz1zVgloVMnn3z20hj61ZPpNVT0WWzOm8KrGF8o8Wd2y4VB50zRx+IdWy4u88EBbNIKHaN+rxvk0CssKmOt7J7bQua8bwC9h77GzgBp1MebA7V72zkGevahF1HalGpEnwzjV0Cx4hRCZQV0oZmZtUCUW4HKqDuZg+dlnTsIKnOPHmoHZ8tWSXmejDSAAAIABJREFU7lFcMkhaioEIlJz7ewYNzJHyBDMpVi2bQdWy0Xvwta5dPmyq81SlOCi47jiQtVNo3ZguwSOEuBJ4BUgD6gsh2gLPSimvSmTjUhrh/hc/FSDWh1jr+GGXNGLVnuOxVYxTO3vssqYx11PSKQb9UFwoDh1uIilO813Vy2Xw3i3n07VB6kTK0KvxPAN0AuYASClXCSGyE9KiYkJh5IDE1a17/xAHPNwn9ISlInpC5mQpumYUGcWor004xW0u7/JW4RfwFiV6nYFtUsoTCW1JMUXPyOeJfs1iyu6pn+L1MpQU3LH2DKJkagIl8ZoUyUWvxrNOCHEzYBRCNAIeAhYlrlmpT6FXW/h9/+WVGjkhbUlo7YpwuL3hvT0cS6J24J/h9lymOJnaUhG9gmco8ARQAHwNzASeT1SjihMNq5ahWlY6B08WL08lRfxwazwltTOSGteX7JA58x7rRbo5eevfi5upLdUI+8sJIYzAFCnlE1LKjq6/0VLK/CJoX8ridioolWZiyajecakz1pdZvQvJQXqb2kqwuTOVxGrdSqWCRsNWpD5hBY8ry+cZIUTq+tEmkXgECfUn0oFzSR1pFxeklqktpbrp2PBex6Nwot652NBrassH1gohZgGeUKdSyocS0qpigPu5U4+fwj3HU2L7Iu8MpCX1GqNEWRmiQ6/gmeb6U/ihnrtzF7egKfRqK9m9sk8UbvXgK2JA1+yclPIz4Btghevva1dZwhBCPCqEkEKIyl5lI4UQW4UQm4QQl3mVtxdCrHVte0sUgR780vWtqV+5NJlmY6JPpRvVFyQHj+BJ5XhCMeCbdLBkXmO0lPCxRsLQG7mgJ/AZsBPn81dHCHGHlHJeIholhKgD9AF2e5U1BwYBLYCawGwhRGPXHNR7wBDgL2A60Bf4NRFtc3NF65pc0Tq+uTGGXNCAnGNnub1bdkTHuZ99NQpNDtJjiirhv4HqZAMo0b93AtFransVuNQdp00I0RinBtQ+Qe16HXgcmOxVNgCYKKUsAHYIIbYCnYQQO4EsKeViV9s+B64mwYInGr6+pzOrc07Q+byKlEoL1JTKlTLz5qB2EderRl3Jxe3JZhDwQK+GjPxxLVXKJiFYaYJR2o4iXugVPGbv4KBSys1CiMji6utECHEVsFdKudrPYlYLp0bjJsdVZnV99i/XqnsITs2IunX1pSKIJ90aVqabV9rqeNGzSVWW7TxGjRKSajmVufeiBrw/1zf4q8OV1kgIwU2d6nKTzjQXxRk10FfEgl7Bs1wI8THwhev7LTjneqJCCDEbqK6x6QlgFKCVK0BruCVDlAcWSjkeGA/QoUOHEvPu3HdRA25oX5uqal1DwhlxeVNa1sriwa//9pQVLiBNVqsSi/S6vpJ6jZGibkNs6BU89wEP4AyVI4B5wLhoTyql1FxxKYRoBdQH3NpObWClEKITTk3GO+9rbWCfq7y2Rvk5g8EglNBJIm47v7GE98qCwky0WqZihUIvegWPCXhTSvkaeKIZxN2ILaVcC1R1f3fN33SQUh4WQkwBvhZCvIbTuaARsFRKaRdCnBJCdAGWALcDb8e7bdHwxd2dkt0ERQJxz3mUeI3H9V8IQft6FXikT2Nu6lzyzYmKxKFX8PwO9AZOu75nAr8B3RLRKC2klOuFEJOADYANeMDl0QZOjWyCq12/kiKOBRc0qpLsJiiKAHfHXFLX8Xh77QkhGHpJo6S2R1H80St4MqSUbqGDlPK0EKJUgtrkQUqZ7fd9DDBGY7/lQMtEt0ehgEAX2pIeJNRNCb+8qCgxE8VFjN7wrnlCiPPdX4QQHYDok6wrFCWIwrQIyW1HonC7iyt3ai/UrYgJvRrPcOA7IcQ+nEK+JjAwYa1SKIoR8hwJmaM6Wy+UqhMTITUeIURHIUR1KeUyoCnwLc75lRnAjiJon0KR8lQq7fSzqVk+M8ktSQyeOR4leBRxIpyp7QPA4vrcFecam3eBY7jWwygU5zr9WlXn/VvPZ0iCM80mGyV3vFA3IybCmdqMUsqjrs8DgfFSyh+AH4QQqxLbNIUiNfFYWdypMYSgb8sayWpOwvF2p1Yo4kE4jccohHALp0uAP7y26Z0fUigUJQAldhTxIpzw+AaYK4Q4jNOLbT6AEKIhcCLBbStW9GxShZ6N1bodhUKhCEdIwSOlHCOE+B2oAfwmpWcFgwEYmujGFScmDFZRChQlFOVcEBSp8iJERVhzmZTyL42yzYlpjkKhSFXUOh5FvNC7gFShUJyjeBaQKrmjiBNK8CgUCkWEKO0vNpTgUSgixJOfJsntKCrUAtJApApdEBNK8CgUCl2oUb4iXijBo1AoQlK4gDSpzUgplBCODSV4FAqFLlRXG4gyuEWHEjwKhSIkaq2KIt4owaNQKEJS4tM9xIC6M9Gh4q0pFIqQ/PxAd35dtx+TUY1T/VG6YHQowaNQRMm5Eq25Za1ytKxVLtnNSCnOkZ8+YaTkEEYIMVQIsUkIsV4I8ZJX+UghxFbXtsu8ytsLIda6tr0lzpUeQaFQKIohKafxCCF6AQOA1lLKAiFEVVd5c2AQ0AJn6u3ZQojGUko78B4wBPgLmA70BX5NRvsVCoVCEZpU1HjuA8ZKKQsApJSHXOUDgIlSygIp5Q5gK9BJCFEDyJJSLnZFz/4cuDoZDVcoFApFeFJR8DQGLhBCLBFCzBVCdHSV1wL2eO2X4yqr5frsXx6AEGKIEGK5EGJ5bm5uApquUCgUinAkxdQmhJgNVNfY9ATONlUAugAdgUlCiPPQ9lyUIcoDC6UcD4wH6NChg3JIUcSEmkhUKKIjKYJHStk72DYhxH3Ajy6z2VIhhAOojFOTqeO1a21gn6u8tka5QqFQKFKQVDS1/QxcDCCEaAykAYeBKcAgIUS6EKI+0AhYKqXcD5wSQnRxebPdDkxOTtMV5wJqIb/Cg3oWoiLlvNqAT4BPhBDrAAtwh0v7WS+EmARsAGzAAy6PNnA6JEwAMnF6symPNoVCoUhRUk7wSCktwK1Bto0BxmiULwdaJrhpCoVCoYgDqWhqUygUipRGOZbEhhI8CoVCESFqaic2lOBRKCLEHZDJaFDjXoUiGlJujkehSHUub1mDFV2PMeySRsluiiJJqCFHbCjBo1BESJrJwLMDlC+LAqQyukWFMrUpFAqFokhRgkehUCiiRCijW1QowaNQKBRRokxt0aEEj0KhUESISjUZG0rwKBQKhaJIUYJHoVAoFEWKEjwKhUKhKFKU4FEoFApFkaIEj0KhUCiKFCV4FAqFIkpUUsDoUIJHoVAoIkQtHI0NJXgUCoUiQtTC0dhQgkehUCgURYoSPAqFQhEhytQWGykneIQQbYUQfwkhVgkhlgshOnltGymE2CqE2CSEuMyrvL0QYq1r21tCqIAWCoVCkaqkYj6el4D/Sil/FUL0c33vKYRoDgwCWgA1gdlCiMZSSjvwHjAE+AuYDvQFfk1K6xWajO7fDIvdEZe6rFYrOTk55Ofnx6U+RdGSkZFB7dq1MZvNyW6KIkmkouCRQJbrczlgn+vzAGCilLIA2CGE2Ap0EkLsBLKklIsBhBCfA1ejBE9Kcc8F58WtrpycHMqWLUt2djZKuS1eSCk5cuQIOTk51K9fP9nNUSSJVBQ8w4GZQohXcJoCu7nKa+HUaNzkuMqsrs/+5QEIIYbg1IyoW7dufFutKDLy8/OV0CmmCCGoVKkSubm5yW5KXFC+bdGRFMEjhJgNVNfY9ARwCfCwlPIHIcSNwMdAb7TTnMsQ5YGFUo4HxgN06NBBPTPFGCV0ii/qt1MkRfBIKXsH2+YylQ1zff0O+Mj1OQeo47VrbZxmuBzXZ/9yhUKhUKQgKefVhlNoXOT6fDGwxfV5CjBICJEuhKgPNAKWSin3A6eEEF1c3my3A5OLutGKc4sxY8bQokULWrduTdu2bVmyZEmym6QoQpTSFhupOMfzL+BNIYQJyMc1JyOlXC+EmARsAGzAAy6PNoD7gAlAJk6nAuVYoEgYixcv5pdffmHlypWkp6dz+PBhLBZL1PXZbDZMplR8FRXBUDHaYiPlnnYp5QKgfZBtY4AxGuXLgZYJbpoiBfnv1PVs2HcyrnU2r5nF01e2CLp9//79VK5cmfT0dAAqV64MwLJlyxg2bBh5eXmkp6fz+++/Yzabue+++1i+fDkmk4nXXnuNXr16MWHCBKZNm0Z+fj55eXlMnTqVoUOHsnbtWmw2G8888wwDBgxg/fr1DB48GIvFgsPh4IcffqBRo0ZxvV6FoqhJOcGjUKQ6l156Kc8++yyNGzemd+/eDBw4kK5duzJw4EC+/fZbOnbsyMmTJ8nMzOTNN98EYO3atWzcuJFLL72UzZs3A07Nac2aNVSsWJFRo0Zx8cUX88knn3D8+HE6depE7969ef/99xk2bBi33HILFosFu90eqmmKIkKZ2mJDCR5FsSaUZpIoypQpw4oVK5g/fz5//vknAwcO5IknnqBGjRp07NgRgKws51K0BQsWMHToUACaNm1KvXr1PIKnT58+VKxYEYDffvuNKVOm8MorrwBOl/Hdu3fTtWtXxowZQ05ODtdee63SdlIMZXKLDiV4FIooMBqN9OzZk549e9KqVSveffddTTdhGaJnKl26tM9+P/zwA02aNPHZp1mzZnTu3Jlp06Zx2WWX8dFHH3HxxRfH70IUiiSQil5tCkVKs2nTJrZs2eL5vmrVKpo1a8a+ff/f3r3HVVnlexz//Nyo4CURzZMnHS9ZKQGimGZqWYqOjqNpOnSZV9LpZhjV6dQZLW2wm6aONZqlNnpwNAHHa2lOjKXTZbwASUiakonmpWPqwUBRLq3zx/Ow2yqgewN7b+T3fr148ez1XPZ3P5vNYq3nYa0jpKWlAZCfn09JSQm33XYb7733HgB79+7l4MGDF1UuAIMHD2bOnDnOimrHjh0AfPfdd3Ts2JEnn3yS4cOHk5WVVdMvT7lBu9w8oy0epdxUUFBAfHw8eXl5BAQE0KlTJxYsWMCDDz5IfHw8hYWFBAUFsXHjRuLi4hg3bhzh4eEEBASQmJjovCnB1eTJk3n66aeJiIjAGEP79u1Zt24dKSkpLF26lPr163PNNdfw4osv+uAVq4poV5tnpLKugCtZjx49THp6uq9jKA/s3r2bLl26+DqGqoLa/h5OXJVF0vbveW1kOPf1qlvDb4lIhjGmR1WOoV1tSinlpjr693q10YpHKaWUV2nFo5RSbtKbCqpGKx6llFJepRWPUkopr9KKRymllFdpxaOUBxwOB5GRkYSFhfHb3/6WvLy8SrePjY1lxYoVAPTv35+yW/mHDh16yX3d8cYbbxAYGMipU6eq7ZiqYkbnIPWIVjxKeSAoKIjMzEyys7MJCQlh7ty5Hh3nww8/JDg4uNpyJSUlcfPNN7N69epqOZ4OSqpqgo5coGq3DRPgh53Ve8xrwmHItMvevHfv3s6hbDIzMxk3bhxnzpzhuuuuY9GiRTRv3rzCfdu3b096ejoFBQUMGTKEvn378q9//Ytrr72WtWvXEhQURFpaGg899BCNGzemb9++bNiwgezs7IuOtW/fPgoKCpgxYwavvfYasbGxvPPOO+zfv5/p06cDkJiYSEZGBnPmzGHp0qXMnj2boqIievXqxdtvv43D4aBJkyY888wzfPTRR/zpT3/ik08+4YMPPqCwsJBbb72V+fPnIyIV5iotLWXChAls3ryZc+fOMX78eB577DE33wR1JdMWj1JVUFpayscff8zw4cMBeOCBB3j99dfJysoiPDycKVOmXPaxcnJyGD9+PF9//TXBwcGsXLkSgAcffJB58+axZcsWHA5HhfsnJSVx77330q9fP/bs2cOxY8cYPXo0q1atcm6TkpJCTEwMu3fvJiUlhS+++ILMzEwcDodzTLnTp08TFhbGtm3b6Nu3L0888QRpaWlkZ2dTWFjIunXrKs21cOFCmjVrRlpaGmlpabz77rvs37//8k9qraD3U1eFtnhU7eZGy6Q6FRYWEhkZSW5uLlFRUURHR3Pq1Cny8vK4/XZr5vaxY8cyZsyYyz5mhw4diIyMBCAqKorc3Fzy8vLIz8/n1ltvBeC+++5z/uK/UHJyMqtXr6ZevXqMGjWKv/3tb4wfP56OHTuydetWrr/+evbs2UOfPn2YO3cuGRkZzmkcCgsLadWqFWBdv7r77rudx920aRPTp0/nzJkznDx5kptuuol+/fpVmCs1NZWsrCznNa1Tp06Rk5NDhw4dLvtc+D+9tlMVWvEo5YGyazynTp1i2LBhzJ07l7Fjx1bpmK6DhzocDgoLCyudVsFVVlYWOTk5REdHA1BUVETHjh0ZP348MTExLF++nM6dOzNy5EhEBGMMY8eOZerUqRcdKzAw0NmCOXv2LHFxcaSnp9O2bVsSEhI4e/ZspbmMMcyZM4fBgwe78/JVHaJdbUpVQbNmzZg9ezYzZ86kUaNGNG/enM8++wyAJUuWOFs/nmrevDlNmzZl69atgNWqKU9SUhIJCQnk5uaSm5vLkSNHOHz4MAcOHGDUqFGsWbOGpKQkYmJiABgwYAArVqzg2LFjAJw8eZIDBw5cdNyzZ88C1vTeBQUFzlZMZbkGDx7MO++8Q3FxMWBNB3H69OkqnQf/o11tVeGTikdExojI1yLys4j0uGDdRBH5VkT2iMhgl/IoEdlpr5st9qxbItJQRFLs8m0i0t67r0bVdd26daNr164kJyezePFinnvuOSIiIsjMzKyWaQwWLlzIo48+Su/evTHG0KxZs4u2SU5OZuTIkeeVjRw5kuTkZJo3b05oaCgHDhygZ8+eAISGhvLKK68waNAgIiIiiI6O5ujRoxcdNzg4mEceeYTw8HDuuusuZ9dcZbkefvhhQkND6d69O2FhYTz22GOUlJRU+Tz4Ix0s1EPGGK9/AV2AG4HNQA+X8lDgK6Ah0AHYBzjsdduB3lh/amwAhtjlccA8e/keIOVyMkRFRRlVO+3atcvXEbwqPz/fuTx16lTz5JNP+jDNL6qSq7a/hxNWZpl2f1hnlmzJ9XUUrwPSTRXrAJ9c4zHG7AbKmyp4BJBsjDkH7BeRb4GeIpILXGWM2WLv91fgLqwKaASQYO+/AnhLRMQ+QUrVeuvXr2fq1KmUlJTQrl07EhMTfR0J8N9c3qSDhXrG324uuBbY6vL4kF1WbC9fWF62z/cAxpgSETkFtACOX3hwEXkUeBTgV7+qW5M3qdorJibGeW3Gn/hrLm/SP289U2MVj4hsBK4pZ9ULxpi1Fe1WTpmppLyyfS4uNGYBsACsGUgryKCUUpXSlk7V1FjFY4wZ6MFuh4C2Lo/bAEfs8jbllLvuc0hEAoBmwEkPnlsppZQX+Nvt1O8D99h3qnUArge2G2OOAvkicot9N9sDwFqXfcr+gWI08Ile31FKKf/lk2s8IjISmANcDawXkUxjzGBjzNcishzYBZQA440xZaMUPg4kAkFYNxVssMsXAkvsGxFOYt3ZppRSyk/56q621UC5w+caY14FXi2nPB0IK6f8LHD545IoVQUnTpxgwIABAPzwww84HA6uvvpqALZv306DBg2q7bny8vJYtmwZcXFx5a5/9dVXWbZsGQ6Hg3r16jF//nx69epVbc+vVE3xt7valPJrLVq0IDMzE4CEhASaNGnCs88+e8n9SkpKCAhw7+OWl5fH22+/XW7Fs2XLFtatW8eXX35Jw4YNOX78OEVFRW4dvzoyKuUJ/SlTtV7//v0vKvvd735HXFwcZ86cYejQoRetj42NJTY2luPHjzN69Ojz1m3evNmt53/33XdZsGABRUVFdOrUiSVLltCoUSNiY2MJCQlhx44ddO/enbi4OO6//35KS0sZMmQIs2bNoqCgAIAZM2awfPlyzp07x8iRI5kyZQoTJkxg3759REZGEh0dzYwZM5zPefToUVq2bOkc361ly5bOdWlpaTz11FOcPn2ahg0b8vHHH1O/fn0ef/xx0tPTCQgIYNasWdxxxx0kJiayfv16zp49y+nTp/nggw+Ij49n586dlJSUkJCQwIgRI9w6H3WJXkz2jFY8SlXRqFGjeOSRRwCYNGkSCxcuJD4+HrDGKdu4cSMOh4Nhw4bx1FNPce+99zJv3jzn/qmpqeTk5LB9+3aMMQwfPpxPP/2UadOmkZ2d7WxhuRo0aBAvvfQSN9xwAwMHDiQmJobbb7+doqIiYmJiSElJ4eabb+ann34iKCiIP//5zwDs3LmTb775hkGDBrF3717Aaj1lZWUREhLC888/z5133smiRYvIy8ujZ8+eDBw4kMaNG9f0aaxV9G7qqtGKR9V6lbVQGjVqVOn6li1but3CuVB2djaTJk0iLy+PgoKC80ZlHjNmjHOk5y1btrBmzRrAmkagrIsuNTWV1NRUunXrBkBBQQE5OTmV/pNzkyZNyMjI4LPPPmPTpk3ExMQwbdo0oqKiaN26tXNMtauuugqAzz//3FkZdu7cmXbt2jkrnujoaEJCQpxZ3n//fWbOnAlYg4QePHiQLl26VOkcXWm0pVM1WvEoVUWxsbGsWbOGrl27kpiYeF5FdjktBWMMEydOvGiWztzc3Er3czgc9O/fn/79+xMeHs7ixYvp3r17eUNRVTqNgWtGYwwrV67kxhtvvGRupTzlb//Ho1Stk5+fT+vWrSkuLnbO4lmeW265xTmr6IXTCCxatMh5vefw4cMcO3aMpk2bkp+fX+6x9uzZQ05OjvNxZmYm7dq1o3Pnzhw5coS0tDRntpKSEm677TZntr1793Lw4MFyK5fBgwczZ84cZ0W1Y8cOd05FnaFdbVWjFY9SVfTyyy/Tq1cvoqOj6dy5c4Xbvfnmm8yaNYuePXty9OhR5zQCgwYN4r777qN3796Eh4czevRo8vPzadGiBX369CEsLIznnnvuvGMVFBQwduxYQkNDiYiIYNeuXSQkJNCgQQNSUlKIj4+na9euREdHOydzKy0tJTw8nJiYGBITE8+beK7M5MmTKS4uJiIigrCwMCZPnly9J+sK0SDA+tUZUE+rIE9IXf0n/x49epj09HRfx1Ae2L17d6285nDmzBmCgoIQEZKTk0lKSmLt2oqGLbyy1db3sEz+2WLe+uRb/mvQjc5KqK4QkQxjTI9Lb1kxvcajlJdkZGTwxBNPYIwhODiYRYsW+TqS8lDTwPpMHFp7K05f04pHKS/p168fX331la9jKOVzdauNqK4YdbWL+Eqg753SikfVOoGBgZw4cUJ/gdVCxhhOnDhBYGCgr6MoH9KuNlXrtGnThkOHDvHjjz/6OoryQGBgIG3atLn0huqKpRWPqnXq169Phw4dfB1DKeUh7WpTSinlVVrxKKWU8iqteJRSSnlVnR25QER+BA54uHtL4Hg1xqlums9z/pwNNF9V+HM2qD352hljrq7KgepsxVMVIpJe1SEjapLm85w/ZwPNVxX+nA3qVj7talNKKeVVWvEopZTyKq14PLPA1wEuQfN5zp+zgearCn/OBnUon17jUUop5VXa4lFKKeVVWvEopZTyKq143CQivxaRPSLyrYhM8MHztxWRTSKyW0S+FpGn7PIQEfmHiOTY35u77DPRzrtHRAZ7IaNDRHaIyDo/zBYsIitE5Bv7HPb2s3z/ab+v2SKSJCKBvswnIotE5JiIZLuUuZ1HRKJEZKe9braIVMuc0RXkm2G/v1kislpEgn2Rr7xsLuueFREjIi19ka2yfCISb2f4WkSm10g+Y4x+XeYX4AD2AR2BBsBXQKiXM7QGutvLTYG9QCgwHZhgl08AXreXQ+2cDYEOdn5HDWd8BlgGrLMf+1O2xcDD9nIDINhf8gHXAvuBIPvxciDWl/mA24DuQLZLmdt5gO1Ab0CADcCQGsw3CAiwl1/3Vb7ystnlbYGPsP6BvaWfnbs7gI1AQ/txq5rIpy0e9/QEvjXGfGeMKQKSgRHeDGCMOWqM+dJezgd2Y/3CGoH1SxX7+1328ggg2RhzzhizH/gW63XUCBFpA/wG+ItLsb9kuwrrw7YQwBhTZIzJ85d8tgAgSEQCgEbAEV/mM8Z8Cpy8oNitPCLSGrjKGLPFWL+p/uqyT7XnM8akGmNK7IdbgbI5GLyar4JzB/AG8N+A651dfnHugMeBacaYc/Y2x2oin1Y87rkW+N7l8SG7zCdEpD3QDdgG/Jsx5ihYlRPQyt7M25nfxPpQ/exS5i/ZOgI/Av9jdwX+RUQa+0s+Y8xhYCZwEDgKnDLGpPpLPhfu5rnWXvZ2ToD/wPorHPwgn4gMBw4bYy6cA93n2Ww3AP1EZJuI/FNEbq6JfFrxuKe8vkuf3I8uIk2AlcDTxpifKtu0nLIaySwiw4BjxpiMy92lnLKaPJ8BWF0L7xhjugGnsbqKKuLVfPa1khFYXRn/DjQWkd9Xtks5Zb78/4iK8vgkp4i8AJQA75UVVZDDK/lEpBHwAvBieasryOCLz0hz4BbgOWC5fc2mWvNpxeOeQ1j9s2XaYHWFeJWI1MeqdN4zxqyyi//XbvZify9rInszcx9guIjkYnVD3ikiS/0kW9nzHTLGbLMfr8CqiPwl30BgvzHmR2NMMbAKuNWP8pVxN88hfunu8kpOERkLDAPut7uA/CHfdVh/VHxlf0baAF+KyDV+kK3MIWCVsWzH6rloWd35tOJxTxpwvYh0EJEGwD3A+94MYP/1sRDYbYyZ5bLqfWCsvTwWWOtSfo+INBSRDsD1WBcDq50xZqIxpo0xpj3WufnEGPN7f8hm5/sB+F5EbrSLBgC7/CUfVhfbLSLSyH6fB2Bdw/OXfGXcymN3x+WLyC3263rAZZ9qJyK/Bv4ADDfGnLkgt8/yGWN2GmNaGWPa25+RQ1g3Cv3g62wu1gB3AojIDVg34Byv9nzVcXdEXfoChmLdSbYPeMEHz98XqymbBWTaX0OBFsDHQI79PcRlnxfsvHuopjtiLiNnf365q81vsgGRQLqjCaigAAADnElEQVR9/tZgdSv4U74pwDdANrAE6y4in+UDkrCuNxVj/aJ8yJM8QA/7Ne0D3sIeNaWG8n2LdT2i7PMxzxf5yst2wfpc7Lva/OjcNQCW2s/3JXBnTeTTIXOUUkp5lXa1KaWU8iqteJRSSnmVVjxKKaW8SisepZRSXqUVj1JKKa/SikfVOSJSKiKZLl+VjjIuIuNE5IFqeN5c19GIL2P7zSKS7vK4h4hsrmoO+1ixIvJWdRxLKXcF+DqAUj5QaIyJvNyNjTHzajLMJbQSkSHGmA2X3tR7RMRhjCn1dQ5VO2mLRymb3SJ5XUS221+d7PIEEXnWXn5SRHaJNddLsl0WIiJr7LKtIhJhl7cQkVR7QNL5uIxrJSK/t58jU0Tmi4ijglgzgEnlZD2vxSIi60Skv71cYL+ODBHZKCI97dbTd/YglWXaisjfxZpf5Y+XymYf9yUR2YY1DL5SHtGKR9VFQRd0tcW4rPvJGNMT6z+w3yxn3wlAN2NMBDDOLpsC7LDLnscaGh7gj8DnxhqQ9H3gVwAi0gWIAfrYLa9S4P4Ksm4BzonIHW68vsbAZmNMFJAPvAJEAyOBl1y262k/byQwxu7KqyxbY6y5W3oZYz53I49S59GuNlUXVdbVluTy/Y1y1mcB74nIGqwhd8AaxuhuAGPMJ3ZLpxnW3D+j7PL1IvJ/9vYDgCggzRreiiB+GWizPK9gtXr+cBmvDaAI+Lu9vBM4Z4wpFpGdQHuX7f5hjDkBICKr7NdRUkm2UqzBaZWqEq14lDqfqWC5zG+wKpThwGQRuYnKh4Yv7xgCLDbGTLysQFZl9jLWUPVlSji/xyLQZbnY/DIW1s9A2aReP4s1wdyFGV0fV5btrF7XUdVBu9qUOl+My/ctritEpB7Q1hizCWuyu2CgCfApdneUfZ3luLHmSHItH4I1IClYA2uOFpFW9roQEWl3iVyv2s9ZJheIFJF6ItIWz2YejbafOwhr1sgvPMymlFu0xaPqoiARyXR5/HdjTNkt1Q3ti+f1gHsv2M8BLLW70QR4wxiTJyIJWLOaZgFn+GXKgClAkoh8CfwTa9oDjDG7RGQSkGpXZsXAeOBARYGNMR+KyI8uRV8A+7G60spGEnbX51gjYHcClhlj0gHczaaUu3R0aqVsYk3O1cMYc9zXWZS6kmlXm1JKKa/SFo9SSimv0haPUkopr9KKRymllFdpxaOUUsqrtOJRSinlVVrxKKWU8qr/B2QoVw/cJbtdAAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Kernel-density-plot-of-the-scores&quot;&gt;Kernel density plot of the scores&lt;a class=&quot;anchor-link&quot; href=&quot;#Kernel-density-plot-of-the-scores&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Kernel density plot of scores is bimodal with one mode less than -100 and a second mode greater than 200. The negative mode corresponds to those training episodes where the agent crash landed and thus scored at most -100; the positive mode corresponds to those training episodes where the agent &quot;solved&quot; the task. The kernel density or scores typically exhibits negative skewness (i.e., a fat left tail): there are lots of ways in which landing the lander can go horribly wrong (resulting in the agent getting a very low score) and only relatively few paths to a gentle landing (and a high score).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;kde&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Score&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Where-to-go-from-here?&quot;&gt;Where to go from here?&lt;a class=&quot;anchor-link&quot; href=&quot;#Where-to-go-from-here?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;I am a bit frustrated by lack of stability that I am seeing in my implmentation of the Deep Q algorithm: sometimes the algorithm converges and sometimes not. Perhaps more tuning of hyper-parameters or use of a different optimization algorithm would exhibit better convergence. I have already spent more time than I had allocated on playing around with this agorithm so I am not going to try and fine-tune the hyperparamters or explore alternative optimization algorithms for now.&lt;/p&gt;
&lt;p&gt;Rather than spending time tuning hyperparameters I think it would be better use of my time to explore algorithmic improvements. In future posts I plan to cover the following extensions of the DQN algorithm: &lt;a href=&quot;https://arxiv.org/abs/1509.06461&quot;&gt;Double Q-Learning&lt;/a&gt;, &lt;a href=&quot;https://arxiv.org/abs/1509.06461&quot;&gt;Prioritized Experience Replay&lt;/a&gt;, and &lt;a href=&quot;https://arxiv.org/abs/1511.06581&quot;&gt;Dueling Network Architectures&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>David R. Pugh</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/q-network-architecture.jpg" /><media:content medium="image" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/q-network-architecture.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Conda (+ pip) and Docker FTW!</title><link href="https://davidrpugh.github.io/stochastic-expatriate-descent/python/conda/docker/data-science/2020/03/31/poor-mans-repo2docker.html" rel="alternate" type="text/html" title="Conda (+ pip) and Docker FTW!" /><published>2020-03-31T00:00:00-05:00</published><updated>2020-03-31T00:00:00-05:00</updated><id>https://davidrpugh.github.io/stochastic-expatriate-descent/python/conda/docker/data-science/2020/03/31/poor-mans-repo2docker</id><content type="html" xml:base="https://davidrpugh.github.io/stochastic-expatriate-descent/python/conda/docker/data-science/2020/03/31/poor-mans-repo2docker.html">&lt;h1 id=&quot;conda--pip-and-docker-ftw&quot;&gt;Conda (+ pip) and Docker FTW!&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.conda.io/en/latest/&quot;&gt;Conda&lt;/a&gt; is an open source package and 
environment management system that runs on Windows, Mac OS and Linux.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Conda can quickly install, run, and update packages and their dependencies.&lt;/li&gt;
  &lt;li&gt;Conda can create, save, load, and switch between project specific software 
environments on your local computer.&lt;/li&gt;
  &lt;li&gt;Although Conda was created for Python programs, Conda can package and 
distribute software for any language such as R, Ruby, Lua, Scala, Java, 
JavaScript, C, C++, FORTRAN.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Conda as a package manager helps you find and install packages. If you need a 
package that requires a different version of Python, you do not need to switch 
to a different environment manager, because Conda is also an environment 
manager. With just a few commands, you can set up a totally separate 
environment to run that different version of Python, while continuing to run 
your usual version of Python in your normal environment.&lt;/p&gt;

&lt;p&gt;While Conda is my default package and environment management solution, not 
every Python package that I might need to use is available via Conda. 
Fortunately, Conda plays nicely with &lt;a href=&quot;https://pip.pypa.io/en/stable/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pip&lt;/code&gt;&lt;/a&gt; 
which is the default Python package management tool.&lt;/p&gt;

&lt;h2 id=&quot;why-not-just-use-conda--pip&quot;&gt;Why not just use Conda (+ pip)?&lt;/h2&gt;

&lt;p&gt;While Conda (+ pip) solves most of my day-to-day data science environment and 
package management issues, incorporating &lt;a href=&quot;https://www.docker.com/&quot;&gt;Docker&lt;/a&gt; 
into my Conda (+ pip) development workflow has made it much easier to port my 
data science workflows from from my laptop/workstation to remote cloud 
computing resources. Getting Conda (+ pip) to work as expected inside Docker 
containers turned out to be much more challenging that I expected.&lt;/p&gt;

&lt;p&gt;This blog post shows how I eventually combined Conda (+ pip) and Docker. 
In the following I assume that you have organized your project directory 
similar to my 
&lt;a href=&quot;https://github.com/kaust-vislab/python-data-science-project&quot;&gt;Python data science project template&lt;/a&gt;. 
In particular, I will assume that you store all Docker related files in a 
&lt;code class=&quot;highlighter-rouge&quot;&gt;docker&lt;/code&gt; sub-directory within your project root directory.&lt;/p&gt;

&lt;h2 id=&quot;writing-the-dockerfile&quot;&gt;Writing the &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt;&lt;/h2&gt;

&lt;p&gt;The trick to getting Conda (+ pip) and Docker to work smoothly together is to 
write a good &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt;. In this section I will take you step by step 
through the various pieces of the &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; that I developed. Hopefully you 
can use this &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; without modification on you next data science 
project.&lt;/p&gt;

&lt;h3 id=&quot;use-a-standard-base-image&quot;&gt;Use a standard base image&lt;/h3&gt;

&lt;p&gt;Every &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockefile&lt;/code&gt; has a base or parent image. For the parent image I use 
&lt;a href=&quot;http://releases.ubuntu.com/16.04/&quot;&gt;Ubuntu 16.04&lt;/a&gt; 
which is one of the most commonly used flavor of Linux in the data science 
community (and also happens to be the same OS installed on my workstation).&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FROM ubuntu:16.04
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;make-bash-the-default-shell&quot;&gt;Make &lt;code class=&quot;highlighter-rouge&quot;&gt;bash&lt;/code&gt; the default shell&lt;/h3&gt;

&lt;p&gt;The default shell used to run &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; commands when building Docker 
images is &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/sh&lt;/code&gt;. Unfortunately &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/sh&lt;/code&gt; is currently not one of the shells 
supported by the &lt;code class=&quot;highlighter-rouge&quot;&gt;conda init&lt;/code&gt; command. Fortunately it is possible to change the 
default shell used to run &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; commands using the 
&lt;a href=&quot;https://docs.docker.com/engine/reference/builder/#shell&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SHELL&lt;/code&gt;&lt;/a&gt; instruction.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SHELL [ &quot;/bin/bash&quot;, &quot;--login&quot;, &quot;-c&quot; ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note the use of the &lt;code class=&quot;highlighter-rouge&quot;&gt;--login&lt;/code&gt; flag which insures that both &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.profile&lt;/code&gt; and 
&lt;code class=&quot;highlighter-rouge&quot;&gt;~/.bashrc&lt;/code&gt; are sourced properly. Proper sourcing of both &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.profile&lt;/code&gt; and 
&lt;code class=&quot;highlighter-rouge&quot;&gt;~/.bashrc&lt;/code&gt; is necessary in order to use various &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt; commands to build the 
Conda environment inside the Docker image.&lt;/p&gt;

&lt;h3 id=&quot;create-a-non-root-user&quot;&gt;Create a non-root user&lt;/h3&gt;

&lt;p&gt;It is a 
&lt;a href=&quot;https://snyk.io/blog/10-docker-image-security-best-practices/&quot;&gt;Docker security “best practice”&lt;/a&gt; 
to create a non-root user inside your Docker images. My preferred approach to 
create a non-root user uses build arguments to customize the &lt;code class=&quot;highlighter-rouge&quot;&gt;username&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;uid&lt;/code&gt;, 
and &lt;code class=&quot;highlighter-rouge&quot;&gt;gid&lt;/code&gt;the non-root user. I use standard defaults for the &lt;code class=&quot;highlighter-rouge&quot;&gt;uid&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;gid&lt;/code&gt;; 
the default username is set to 
&lt;a href=&quot;https://en.wikipedia.org/wiki/Muhammad_ibn_Musa_al-Khwarizmi&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;al-khawarizmi&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Create a non-root user
ARG username=al-khawarizmi
ARG uid=1000
ARG gid=100
ENV USER $username
ENV UID $uid
ENV GID $gid
ENV HOME /home/$USER

RUN adduser --disabled-password \
    --gecos &quot;Non-root user&quot; \
    --uid $UID \
    --gid $GID \
    --home $HOME \
    $USER
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;copy-over-the-config-files-for-the-conda-environment&quot;&gt;Copy over the config files for the Conda environment&lt;/h3&gt;

&lt;p&gt;After creating the non-root user I copy over all of the config files that I 
will need to create the Conda environment (i.e., &lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt;, 
&lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;postBuild&lt;/code&gt;). I also copy over a Bash script that I will 
use as the Docker &lt;code class=&quot;highlighter-rouge&quot;&gt;ENTRYPOINT&lt;/code&gt; (more on this below).&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;COPY environment.yml requirements.txt /tmp/
RUN chown $UID:$GID /tmp/environment.yml /tmp/requirements.txt

COPY postBuild /usr/local/bin/postBuild.sh
RUN chown $UID:$GID /usr/local/bin/postBuild.sh &amp;amp;&amp;amp; \
    chmod u+x /usr/local/bin/postBuild.sh

COPY docker/entrypoint.sh /usr/local/bin/
RUN chown $UID:$GID /usr/local/bin/entrypoint.sh &amp;amp;&amp;amp; \
    chmod u+x /usr/local/bin/entrypoint.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Newer versions of Docker support copying files as a non-root user, however 
the version of Docker available on DockerHub does not yet support copying 
as a non-root user so if you want to setup 
&lt;a href=&quot;https://docs.docker.com/docker-hub/builds/&quot;&gt;automated builds&lt;/a&gt; for your Git 
repositories you will need to copy everything as root.&lt;/p&gt;

&lt;h3 id=&quot;install-miniconda-as-the-non-root-user&quot;&gt;Install Miniconda as the non-root user.&lt;/h3&gt;

&lt;p&gt;After copying over the config files as root, I switch over to the non-root 
user and install &lt;a href=&quot;https://docs.conda.io/en/latest/miniconda.html&quot;&gt;Miniconda&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;USER $USER

# install miniconda
ENV MINICONDA_VERSION 4.8.2
ENV CONDA_DIR $HOME/miniconda3
RUN wget --quiet https://repo.anaconda.com/miniconda/Miniconda3-$MINICONDA_VERSION-Linux-x86_64.sh -O ~/miniconda.sh &amp;amp;&amp;amp; \
    chmod +x ~/miniconda.sh &amp;amp;&amp;amp; \
    ~/miniconda.sh -b -p $CONDA_DIR &amp;amp;&amp;amp; \
    rm ~/miniconda.sh

# make non-activate conda commands available
ENV PATH=$CONDA_DIR/bin:$PATH

# make conda activate command available from /bin/bash --login shells
RUN echo &quot;. $CONDA_DIR/etc/profile.d/conda.sh&quot; &amp;gt;&amp;gt; ~/.profile

# make conda activate command available from /bin/bash --interative shells
RUN conda init bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;create-a-project-directory&quot;&gt;Create a project directory&lt;/h3&gt;

&lt;p&gt;Next I create a project directory inside the non-root user home directory. The 
Conda environment will be created in a &lt;code class=&quot;highlighter-rouge&quot;&gt;env&lt;/code&gt; sub-directory inside the project 
directory and all other project files and directories can then be mounted into 
this directory.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# create a project directory inside user home
ENV PROJECT_DIR $HOME/app
RUN mkdir $PROJECT_DIR
WORKDIR $PROJECT_DIR
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;build-the-conda-environment&quot;&gt;Build the Conda environment&lt;/h3&gt;

&lt;p&gt;Now I am ready to build the Conda environment. Note that I can use nearly the 
same sequence of &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt; commands that I would use to build a Conda environment 
for a project on my laptop or workstation.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# build the conda environment
ENV ENV_PREFIX $PWD/env
RUN conda update --name base --channel defaults conda &amp;amp;&amp;amp; \
    conda env create --prefix $ENV_PREFIX --file /tmp/environment.yml --force &amp;amp;&amp;amp; \
    conda clean --all --yes

# run the postBuild script to install any JupyterLab extensions
RUN conda activate $ENV_PREFIX &amp;amp;&amp;amp; \
    /usr/local/bin/postBuild.sh &amp;amp;&amp;amp; \
    conda deactivate
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;insure-conda-environment-is-properly-activated-at-runtime&quot;&gt;Insure Conda environment is properly activated at runtime&lt;/h3&gt;

&lt;p&gt;Almost finished! Second to last step is to use an 
&lt;a href=&quot;https://docs.docker.com/engine/reference/builder/#entrypoint&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ENTRYPOINT&lt;/code&gt;&lt;/a&gt; 
script to insure that the Conda environment is properly activated at runtime.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ENTRYPOINT [ &quot;/usr/local/bin/entrypoint.sh&quot; ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is the &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/bin/entrypoint.sh&lt;/code&gt; script for reference.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash --login&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt;

conda activate &lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;specify-a-default-command-for-the-docker-container&quot;&gt;Specify a default command for the Docker container&lt;/h3&gt;

&lt;p&gt;Finally, I use the &lt;a href=&quot;https://docs.docker.com/engine/reference/builder/#cmd&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CMD&lt;/code&gt;&lt;/a&gt; 
instruction to specify a default command to run when a Docker container is 
launched. Since I install 
&lt;a href=&quot;https://jupyterlab.readthedocs.io/en/stable/&quot;&gt;JupyerLab&lt;/a&gt; in all of my Conda 
environments I tend to launch a JupyterLab server by default when executing 
containers.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# default command will be to launch JupyterLab server for development
CMD [ &quot;jupyter&quot;, &quot;lab&quot;, &quot;--no-browser&quot;, &quot;--ip&quot;, &quot;0.0.0.0&quot; ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;building-the-docker-image&quot;&gt;Building the Docker image&lt;/h2&gt;

&lt;p&gt;The following command builds a new image for your project with a custom &lt;code class=&quot;highlighter-rouge&quot;&gt;$USER&lt;/code&gt; 
(and associated &lt;code class=&quot;highlighter-rouge&quot;&gt;$UID&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;$GID&lt;/code&gt;) as well as a particular &lt;code class=&quot;highlighter-rouge&quot;&gt;$IMAGE_NAME&lt;/code&gt; and 
&lt;code class=&quot;highlighter-rouge&quot;&gt;$IMAGE_TAG&lt;/code&gt;. This command should be run within the &lt;code class=&quot;highlighter-rouge&quot;&gt;docker&lt;/code&gt; sub-directory of 
the project as the Docker build context is set to &lt;code class=&quot;highlighter-rouge&quot;&gt;../&lt;/code&gt; which should be the 
project root directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker image build &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--build-arg&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--build-arg&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$UID&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--build-arg&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GID&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--file&lt;/span&gt; Dockerfile &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--tag&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$IMAGE_NAME&lt;/span&gt;:&lt;span class=&quot;nv&quot;&gt;$IMAGE_TAG&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  ../
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;running-a-docker-container&quot;&gt;Running a Docker container&lt;/h2&gt;

&lt;p&gt;Once the image is built, the following command will run a container based on 
the image &lt;code class=&quot;highlighter-rouge&quot;&gt;$IMAGE_NAME:$IMAGE_TAG&lt;/code&gt;. This command should be run from within the 
project’s root directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker container run &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--tty&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--volume&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/bin:/home/&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;/app/bin &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--volume&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/data:/home/&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;/app/data &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--volume&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/doc:/home/&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;/app/doc &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--volume&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/notebooks:/home/&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;/app/notebooks &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--volume&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/results:/home/&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;/app/results &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--volume&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/src:/home/&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;/app/src &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--publish&lt;/span&gt; 8888:8888 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$IMAGE_NAME&lt;/span&gt;:&lt;span class=&quot;nv&quot;&gt;$IMAGE_TAG&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;using-docker-compose&quot;&gt;Using Docker Compose&lt;/h2&gt;

&lt;p&gt;It is quite easy to make typos whilst writing the above docker commands by hand. 
A less error-prone approach is to use 
&lt;a href=&quot;https://docs.docker.com/compose/&quot;&gt;Docker Compose&lt;/a&gt;. The above docker commands can 
be encapsulated into the &lt;code class=&quot;highlighter-rouge&quot;&gt;docker-compose.yml&lt;/code&gt; configuration file as follows.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;3.7&quot;&lt;/span&gt;

&lt;span class=&quot;na&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;jupyterlab-server&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;username=${USER}&lt;/span&gt;
        &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;uid=${UID}&lt;/span&gt;
        &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;gid=${GID}&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;../&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;dockerfile&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker/Dockerfile&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;ports&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;8888:8888&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;volumes&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;../bin:/home/${USER}/app/bin&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;../data:/home/${USER}/app/data&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;../doc:/home/${USER}/app/doc&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;../notebooks:/home/${USER}/app/notebooks&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;../results:/home/${USER}/app/results&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;../src:/home/${USER}/app/src&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;stdin_open&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;tty&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above &lt;code class=&quot;highlighter-rouge&quot;&gt;docker-compose.yml&lt;/code&gt; file relies on 
&lt;a href=&quot;https://docs.docker.com/compose/environment-variables/#the-env-file&quot;&gt;variable substitution&lt;/a&gt;.
to obtain the values for &lt;code class=&quot;highlighter-rouge&quot;&gt;$USER&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;$UID&lt;/code&gt;, and &lt;code class=&quot;highlighter-rouge&quot;&gt;$GID&lt;/code&gt;. These values can be 
stored in an a file called &lt;code class=&quot;highlighter-rouge&quot;&gt;.env&lt;/code&gt; as follows.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;USER=$USER
UID=$UID
GID=$GID
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can test your &lt;code class=&quot;highlighter-rouge&quot;&gt;docker-compose.yml&lt;/code&gt; file by running the following command in 
the &lt;code class=&quot;highlighter-rouge&quot;&gt;docker&lt;/code&gt; sub-directory of the project.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker-compose config
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This command takes the &lt;code class=&quot;highlighter-rouge&quot;&gt;docker-compose.yml&lt;/code&gt; file and substitutes the values 
provided in the &lt;code class=&quot;highlighter-rouge&quot;&gt;.env&lt;/code&gt; file and then returns the result.&lt;/p&gt;

&lt;p&gt;Once you are confident that values in the &lt;code class=&quot;highlighter-rouge&quot;&gt;.env&lt;/code&gt; file are being substituted 
properly into the &lt;code class=&quot;highlighter-rouge&quot;&gt;docker-compose.yml&lt;/code&gt; file, the following command can be used 
to bring up a container based on your project’s Docker image and launch the 
JupyterLab server. This command should also be run from within the &lt;code class=&quot;highlighter-rouge&quot;&gt;docker&lt;/code&gt; 
sub-directory of the project.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker-compose up &lt;span class=&quot;nt&quot;&gt;--build&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When you are done developing and have shutdown the JupyterLab server, the 
following command tears down the networking infrastructure for the running 
container.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker-compose down
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;summary&quot;&gt;Summary&lt;/h1&gt;

&lt;p&gt;In this post I walked through a &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; that can be used to inject a 
Conda (+ pip) environment into into a Docker image. I also detailed how to 
build the resulting image and launch containers using Docker Compose.&lt;/p&gt;

&lt;p&gt;If you are looking for a production-quality solution that generalizes the 
approach outlined above, then I would encourage you to check out 
&lt;a href=&quot;https://repo2docker.readthedocs.io/en/latest/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jupyter-repo2docker&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jupyter-repo2docker&lt;/code&gt; is a tool to build, run, and push Docker images from 
source code repositories. &lt;code class=&quot;highlighter-rouge&quot;&gt;repo2docker&lt;/code&gt; fetches a repository (from GitHub, 
GitLab, Zenodo, Figshare, Dataverse installations, a Git repository or a local 
directory) and builds a container image in which the code can be executed. The 
image build process is based on the configuration files found in the repository.&lt;/p&gt;

&lt;p&gt;The Conda (+ pip) and Docker combination has significantly increased my data 
science development velocity while at the same time increasing the portability 
and reproducibility of my data science workflows.&lt;/p&gt;

&lt;p&gt;Hopefully this post can help you combine these three great tools together on 
your next data science project!&lt;/p&gt;</content><author><name></name></author><summary type="html">Conda (+ pip) and Docker FTW!</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/conda-docker.png" /><media:content medium="image" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/conda-docker.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Building a Conda environment for Horovod</title><link href="https://davidrpugh.github.io/stochastic-expatriate-descent/python/conda/deep-learning/pytorch/tensorflow/nvidia/horovod/2020/03/30/horovod-conda-env.html" rel="alternate" type="text/html" title="Building a Conda environment for Horovod" /><published>2020-03-30T00:00:00-05:00</published><updated>2020-03-30T00:00:00-05:00</updated><id>https://davidrpugh.github.io/stochastic-expatriate-descent/python/conda/deep-learning/pytorch/tensorflow/nvidia/horovod/2020/03/30/horovod-conda-env</id><content type="html" xml:base="https://davidrpugh.github.io/stochastic-expatriate-descent/python/conda/deep-learning/pytorch/tensorflow/nvidia/horovod/2020/03/30/horovod-conda-env.html">&lt;h1 id=&quot;what-is-horovod&quot;&gt;What is Horovod?&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;&quot;&gt;Horovod&lt;/a&gt; is an open-source distributed training framework for 
&lt;a href=&quot;https://www.tensorflow.org/&quot;&gt;TensorFlow&lt;/a&gt;, &lt;a href=&quot;https://keras.io/&quot;&gt;Keras&lt;/a&gt;, 
&lt;a href=&quot;https://pytorch.org/&quot;&gt;PyTorch&lt;/a&gt;, and 
&lt;a href=&quot;https://mxnet.incubator.apache.org/&quot;&gt;Apache MXNet&lt;/a&gt;. Horovod improves the speed, 
scale, and resource utilization of deep learning training.&lt;/p&gt;

&lt;p&gt;In this post I describe how I build Conda environments for my deep learning 
projects where I plan to use Horovod to enable distributed training across 
multiple GPUs (either on the same node or spread across multuple nodes). If 
you like my approach then you can make use of the template repository on 
&lt;a href=&quot;https://github.com/kaust-vislab/horovod-gpu-data-science-project&quot;&gt;GitHub&lt;/a&gt; to 
get started with you rnext Horovod data science project!&lt;/p&gt;

&lt;h1 id=&quot;installing-the-nvidia-cuda-toolkit&quot;&gt;Installing the NVIDIA CUDA Toolkit&lt;/h1&gt;

&lt;p&gt;First thing you need to do is to install the 
&lt;a href=&quot;https://developer.nvidia.com/cuda-toolkit-archive&quot;&gt;appropriate version&lt;/a&gt; 
of the NVIDIA CUDA Toolkit on your workstation. For this blog post I am using 
&lt;a href=&quot;https://developer.nvidia.com/cuda-10.1-download-archive-update2&quot;&gt;NVIDIA CUDA Toolkit 10.1&lt;/a&gt; 
&lt;a href=&quot;https://docs.nvidia.com/cuda/archive/10.1/&quot;&gt;(documentation)&lt;/a&gt; which works with 
all three deep learning frameworks that are currently supported by Horovod.&lt;/p&gt;

&lt;h2 id=&quot;why-not-just-use-the-cudatoolkit-package&quot;&gt;Why not just use the &lt;code class=&quot;highlighter-rouge&quot;&gt;cudatoolkit&lt;/code&gt; package?&lt;/h2&gt;

&lt;p&gt;Typically when installing PyTorch, TensorFlow, or Apache MXNet with GPU support 
using Conda you simply add the appropriate version 
&lt;a href=&quot;https://anaconda.org/anaconda/cudatoolkit&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cudatoolkit&lt;/code&gt;&lt;/a&gt; package to your 
&lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt; file.&lt;/p&gt;

&lt;p&gt;Unfortunately, the &lt;code class=&quot;highlighter-rouge&quot;&gt;cudatoolkit&lt;/code&gt; package available from 
&lt;a href=&quot;https://conda-forge.org/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;conda-forge&lt;/code&gt;&lt;/a&gt; does not include 
&lt;a href=&quot;https://docs.nvidia.com/cuda/archive/10.1/cuda-compiler-driver-nvcc/index.html&quot;&gt;NVCC&lt;/a&gt; 
and in order to use Horovod with either PyTorch, TensorFlow, or MXNet you need 
to compile extensions.&lt;/p&gt;

&lt;h2 id=&quot;what-about-the-cudatoolkit-dev-package&quot;&gt;What about the &lt;code class=&quot;highlighter-rouge&quot;&gt;cudatoolkit-dev&lt;/code&gt; package?&lt;/h2&gt;

&lt;p&gt;While there are 
&lt;a href=&quot;https://anaconda.org/conda-forge/cudatoolkit-dev&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cudatoolkit-dev&lt;/code&gt;&lt;/a&gt; packages 
available from &lt;code class=&quot;highlighter-rouge&quot;&gt;conda-forge&lt;/code&gt; that do include NVCC, I have had difficult getting 
these packages to consistently install properly.&lt;/p&gt;

&lt;h2 id=&quot;use-the-nvcc_linux-64-meta-pacakge&quot;&gt;Use the &lt;code class=&quot;highlighter-rouge&quot;&gt;nvcc_linux-64&lt;/code&gt; meta-pacakge!&lt;/h2&gt;

&lt;p&gt;The most robust approach to obtain NVCC and still use Conda to manage all the 
other dependencies is to install the NVIDIA CUDA Toolkit on your system and then 
install a meta-package 
&lt;a href=&quot;https://anaconda.org/nvidia/nvcc_linux-64&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;nvcc_linux-64&lt;/code&gt;&lt;/a&gt; from &lt;code class=&quot;highlighter-rouge&quot;&gt;conda-forge&lt;/code&gt; 
which configures your Conda environment to use the NVCC installed on the system 
together with the other CUDA Toolkit components installed inside the Conda 
environment.&lt;/p&gt;

&lt;h1 id=&quot;the-environmentyml-file&quot;&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt; file&lt;/h1&gt;

&lt;p&gt;I prefer to specify as many dependencies as possible in the Conda 
&lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt; file and only specify dependencies in &lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt; 
that are not available via Conda channels. Check the 
&lt;a href=&quot;https://horovod.readthedocs.io/en/latest/install_include.html&quot;&gt;official Horovod installation guide&lt;/a&gt; 
for details of required dependencies.&lt;/p&gt;

&lt;h2 id=&quot;channel-priority&quot;&gt;Channel Priority&lt;/h2&gt;

&lt;p&gt;I use the recommended channel priorities. Note that &lt;code class=&quot;highlighter-rouge&quot;&gt;conda-forge&lt;/code&gt; has priority over &lt;code class=&quot;highlighter-rouge&quot;&gt;defaults&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;null&lt;/span&gt;

&lt;span class=&quot;na&quot;&gt;channels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;pytorch&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;conda-forge&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;defaults&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;dependencies&quot;&gt;Dependencies&lt;/h2&gt;

&lt;p&gt;There are a few things worth noting about the dependencies.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Even though I have installed the NVIDIA CUDA Toolkit manually I still use 
Conda to manage the other required CUDA components such as &lt;code class=&quot;highlighter-rouge&quot;&gt;cudnn&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;nccl&lt;/code&gt; 
(and the optional &lt;code class=&quot;highlighter-rouge&quot;&gt;cupti&lt;/code&gt;).&lt;/li&gt;
  &lt;li&gt;I use two meta-pacakges, &lt;code class=&quot;highlighter-rouge&quot;&gt;cxx-compiler&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;nvcc_linux-64&lt;/code&gt;, to make sure 
that suitable C, and C++ compilers are installed and that the resulting 
Conda environment is aware of the manually installed CUDA Toolkit.&lt;/li&gt;
  &lt;li&gt;Horovod requires some controller library to coordinate work between the 
various Horovod processes. Typically this will be some MPI implementation 
such as &lt;a href=&quot;https://www.open-mpi.org/&quot;&gt;OpenMPI&lt;/a&gt;. However, rather than 
specifying the &lt;code class=&quot;highlighter-rouge&quot;&gt;openmpi&lt;/code&gt; package directly I instead opt for 
&lt;a href=&quot;https://mpi4py.readthedocs.io/en/stable/&quot;&gt;mpi4py&lt;/a&gt; Conda package which 
provides a cuda-aware build of OpenMPI (where possible).&lt;/li&gt;
  &lt;li&gt;Horovod also support that &lt;a href=&quot;https://github.com/facebookincubator/gloo&quot;&gt;Gloo&lt;/a&gt; 
collective communications library that can be used in place of MPI. I 
include &lt;code class=&quot;highlighter-rouge&quot;&gt;cmake&lt;/code&gt; in order to insure that the Horovod extensions for Gloo are 
built.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Below are the core required dependencies. The complete &lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt; file 
is available on 
&lt;a href=&quot;https://github.com/kaust-vislab/horovod-gpu-data-science-project/blob/master/environment.yml&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;dependencies&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bokeh=1.4&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cmake=3.16&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# insures that the Gloo library extensions will be built&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cudnn=7.6&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cupti=10.1&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cxx-compiler=1.0&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# meta-pacakge that insures suitable C and C++ compilers are available&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;jupyterlab=1.2&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;mpi4py=3.0&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# installs cuda-aware openmpi&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nccl=2.5&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nodejs=13&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nvcc_linux-64=10.1&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# meta-package that configures environment to be &quot;cuda-aware&quot;&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;pip=20.0&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;pip&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;mxnet-cu101mkl==1.6.*&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# makes sure MXNET is installed prior to horovod&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;-r file:requirements.txt&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python=3.7&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;pytorch=1.4&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tensorboard=2.1&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tensorflow-gpu=2.1&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;torchvision=0.5&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;the-requirementstxt-file&quot;&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt; File&lt;/h1&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt; file is where all of the &lt;code class=&quot;highlighter-rouge&quot;&gt;pip&lt;/code&gt; dependencies, including 
Horovod itself, are listed for installation. In addition to Horovod I 
typically will also use &lt;code class=&quot;highlighter-rouge&quot;&gt;pip&lt;/code&gt; to install JupyterLab extensions to enable GPU and 
CPU resource monitoring via &lt;a href=&quot;https://github.com/rapidsai/jupyterlab-nvdashboard&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jupyterlab-nvdashboard&lt;/code&gt;&lt;/a&gt; 
and Tensorboard support via &lt;a href=&quot;https://github.com/lspvic/jupyter_tensorboard&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jupyter-tensorboard&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;horovod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;0.19.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
jupyterlab-nvdashboard&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;0.2.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# server-side component; client-side component installed in postBuild&lt;/span&gt;
jupyter-tensorboard&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;0.2.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# make sure horovod is re-compiled if environment is re-built&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--no-binary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;horovod
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note the use of the &lt;code class=&quot;highlighter-rouge&quot;&gt;--no-binary&lt;/code&gt; option at the end of the file. Including this 
option insures that Horovod will be re-built whenever the Conda environment is 
re-built.&lt;/p&gt;

&lt;p&gt;The complete &lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt; file is available on &lt;a href=&quot;https://github.com/kaust-vislab/horovod-gpu-data-science-project/blob/master/requirements.txt&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;

&lt;h1 id=&quot;building-conda-environment&quot;&gt;Building Conda Environment&lt;/h1&gt;

&lt;p&gt;After adding any necessary dependencies that should be downloaded via &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt; 
to the &lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt; file and any dependencies that should be downloaded 
via &lt;code class=&quot;highlighter-rouge&quot;&gt;pip&lt;/code&gt; to the &lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt; file you create the Conda environment in a 
sub-directory &lt;code class=&quot;highlighter-rouge&quot;&gt;./env&lt;/code&gt;of your project directory by running the following 
commands.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ENV_PREFIX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PWD&lt;/span&gt;/env
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOROVOD_CUDA_HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CUDA_HOME&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOROVOD_NCCL_HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOROVOD_GPU_ALLREDUCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;NCCL
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOROVOD_GPU_BROADCAST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;NCCL
conda &lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;create &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--file&lt;/span&gt; environment.yml &lt;span class=&quot;nt&quot;&gt;--force&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By default Horovod will try and build extensions for all detected frameworks. 
See the Horovod documentation on 
&lt;a href=&quot;https://horovod.readthedocs.io/en/latest/install_include.html#environment-variables&quot;&gt;environment variables&lt;/a&gt; 
for the details on additional environment variables that can be set prior to 
building Horovod.&lt;/p&gt;

&lt;p&gt;Once the new environment has been created you can activate the environment 
with the following command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda activate &lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;the-postbuild-file&quot;&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;postBuild&lt;/code&gt; File&lt;/h2&gt;

&lt;p&gt;If you wish to use any JupyterLab extensions included in the &lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt; 
and &lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt; files then you need to rebuild the JupyterLab 
application using the following commands to source the &lt;code class=&quot;highlighter-rouge&quot;&gt;postBuild&lt;/code&gt; script.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda activate &lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# optional if environment already active&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; postBuild
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;wrapping-it-all-up-in-a-bash-script&quot;&gt;Wrapping it all up in a Bash script&lt;/h2&gt;

&lt;p&gt;I typically wrap these commands into a shell script &lt;code class=&quot;highlighter-rouge&quot;&gt;./bin/create-conda-env.sh&lt;/code&gt;. 
Running the shell script will set the Horovod build variables, create the 
Conda environment, activate the Conda environment, and built JupyterLab with 
any additional extensions.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash --login&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ENV_PREFIX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PWD&lt;/span&gt;/env
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOROVOD_CUDA_HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CUDA_HOME&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOROVOD_NCCL_HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOROVOD_GPU_ALLREDUCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;NCCL
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOROVOD_GPU_BROADCAST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;NCCL

conda &lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;create &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--file&lt;/span&gt; environment.yml &lt;span class=&quot;nt&quot;&gt;--force&lt;/span&gt;
conda activate &lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; postBuild
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I typically put scripts inside a &lt;code class=&quot;highlighter-rouge&quot;&gt;./bin&lt;/code&gt; directory in my project root directory. 
The script should be run from the project root directory as follows.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./bin/create-conda-env.sh &lt;span class=&quot;c&quot;&gt;# assumes that $CUDA_HOME is set properly&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;verifying-the-conda-environment&quot;&gt;Verifying the Conda environment&lt;/h1&gt;

&lt;p&gt;After building the Conda environment you can check that Horovod has been built 
with support for the deep learning frameworks TensorFlow, PyTorch, Apache 
MXNet, and the contollers MPI and Gloo with the following command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda activate &lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# optional if environment already active&lt;/span&gt;
horovodrun &lt;span class=&quot;nt&quot;&gt;--check-build&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You should see output similar to the following.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Horovod v0.19.1:

Available Frameworks:
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;X] TensorFlow
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;X] PyTorch
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;X] MXNet

Available Controllers:
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;X] MPI
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;X] Gloo

Available Tensor Operations:
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;X] NCCL
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; DDL
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; CCL
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;X] MPI
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;X] Gloo  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;listing-the-contents-of-the-conda-environment&quot;&gt;Listing the contents of the Conda environment&lt;/h2&gt;

&lt;p&gt;To see the full list of packages installed into the environment run the 
following command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda activate &lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# optional if environment already active&lt;/span&gt;
conda list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;updating-the-conda-environment&quot;&gt;Updating the Conda environment&lt;/h1&gt;

&lt;p&gt;If you add (remove) dependencies to (from) the &lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt; file or the 
&lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt; file after the environment has already been created, then 
you can re-create the environment with the following command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda &lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;create &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ENV_PREFIX&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--file&lt;/span&gt; environment.yml &lt;span class=&quot;nt&quot;&gt;--force&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, whenever I add new dependencies I prefer to re-run the Bash script 
which will re-build both the Conda environment and JupyterLab.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./bin/create-conda-env.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;summary&quot;&gt;Summary&lt;/h1&gt;

&lt;p&gt;Finding a reproducible process for building Horovod extensions for my deep 
learning projects was tricky. Key to my solution is the use of meta-packages 
from &lt;code class=&quot;highlighter-rouge&quot;&gt;conda-forge&lt;/code&gt; to insure that the appropriate compilers are installed and 
that the resulting Conda environment is aware of the system installed NVIDIA 
CUDA Toolkit. The second key is to use the &lt;code class=&quot;highlighter-rouge&quot;&gt;--no-binary&lt;/code&gt; flag in the 
&lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt; file to insure that Horovod is re-built whenever the Conda 
environment is re-built.&lt;/p&gt;

&lt;p&gt;If you like my approach then you can make use of the template repository on 
&lt;a href=&quot;https://github.com/kaust-vislab/horovod-gpu-data-science-project&quot;&gt;GitHub&lt;/a&gt; to 
get started with your next Horovod data science project!&lt;/p&gt;</content><author><name></name></author><summary type="html">What is Horovod?</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/horovod-nvidia.jpg" /><media:content medium="image" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/horovod-nvidia.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Managing Project-Specific Environments With Conda</title><link href="https://davidrpugh.github.io/stochastic-expatriate-descent/python/conda/data-science/machine-learning/deep-learning/2020/03/29/getting-started-with-conda.html" rel="alternate" type="text/html" title="Managing Project-Specific Environments With Conda" /><published>2020-03-29T00:00:00-05:00</published><updated>2020-03-29T00:00:00-05:00</updated><id>https://davidrpugh.github.io/stochastic-expatriate-descent/python/conda/data-science/machine-learning/deep-learning/2020/03/29/getting-started-with-conda</id><content type="html" xml:base="https://davidrpugh.github.io/stochastic-expatriate-descent/python/conda/data-science/machine-learning/deep-learning/2020/03/29/getting-started-with-conda.html">&lt;h1 id=&quot;getting-started-with-conda&quot;&gt;Getting Started with Conda&lt;/h1&gt;

&lt;p&gt;Conda is an open source package and environment management system that runs on 
Windows, Mac OS and Linux.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Conda can quickly install, run, and update packages and their dependencies.&lt;/li&gt;
  &lt;li&gt;Conda can create, save, load, and switch between project specific software environments on your local computer.&lt;/li&gt;
  &lt;li&gt;Although Conda was created for Python programs, Conda can package and distribute software for any language such as R, Ruby, Lua, Scala, Java, JavaScript, C, C++, FORTRAN.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Conda as a &lt;em&gt;package manager&lt;/em&gt; helps you find and install packages. If you need a 
package that requires a different version of Python, you do not need to switch to 
a different environment manager, because Conda is also an &lt;em&gt;environment manager&lt;/em&gt;. 
With just a few commands, you can set up a totally separate environment to run 
that different version of Python, while continuing to run your usual version of 
Python in your normal environment.&lt;/p&gt;

&lt;h2 id=&quot;conda-miniconda-anaconda-whats-the-difference&quot;&gt;Conda? Miniconda? Anaconda? What’s the difference?&lt;/h2&gt;

&lt;p&gt;Users are often confused about the differences between Conda, Miniconda, and 
Anaconda.&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
   &lt;img alt=&quot;Conda vs. Miniconda vs. Anaconda&quot; src=&quot;/stochastic-expatriate-descent/images/miniconda-vs-anaconda.png&quot; width=&quot;500&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;I suggest installing Miniconda which combines Conda with Python 3 (and a small 
number of core systems packages) instead of the full Anaconda distribution. 
Installing only Miniconda will encourage you to create separate environments 
for each project (and to install only those packages that you actually need for each 
project!) which will enhance portability and reproducibility of your research and 
workflows.&lt;/p&gt;

&lt;p&gt;Besides, if you &lt;em&gt;really&lt;/em&gt; want a particular version of the full Anaconda 
distribution you can always create an new conda environment and install it 
using the following command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda create &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; anaconda202002 &lt;span class=&quot;nv&quot;&gt;anaconda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2020.02
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;installing-miniconda&quot;&gt;Installing Miniconda&lt;/h2&gt;

&lt;p&gt;Download the 64-bit, Python 3 version of the 
&lt;a href=&quot;https://docs.conda.io/en/latest/miniconda.html&quot;&gt;appropriate Miniconda installer&lt;/a&gt; 
for your operating system from and follow the instructions. I will walk through 
the steps for installing on Linux systems below as installing on Linux systems 
is slightly more involved.&lt;/p&gt;

&lt;p&gt;Download the 64-bit Python 3 install script for Miniconda.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget &lt;span class=&quot;nt&quot;&gt;--quiet&lt;/span&gt; https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Run the Miniconda install script. The &lt;code class=&quot;highlighter-rouge&quot;&gt;-b&lt;/code&gt; runs the install script in batch mode 
which doesn’t require manual intervention (and assumes that the user agrees to 
the terms of the license).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash Miniconda3-latest-Linux-x86_64.sh &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Remove the install script.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;rm &lt;/span&gt;Miniconda3-latest-Linux-x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;initializing-your-shell-for-conda&quot;&gt;Initializing your shell for Conda&lt;/h2&gt;

&lt;p&gt;After installing Miniconda you next need to configure your preferred shell to be 
“conda-aware”.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda init bash
&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; ~/.bashrc
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# now the prompt indicates that the base environment is active!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;updating-conda&quot;&gt;Updating Conda&lt;/h2&gt;

&lt;p&gt;It is a good idea to keep your &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt; installation updated to the most recent 
version.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda update &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; base conda &lt;span class=&quot;nt&quot;&gt;--yes&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;uninstalling-miniconda&quot;&gt;Uninstalling Miniconda&lt;/h2&gt;

&lt;p&gt;Whenever installing new software it is always a good idea to understand how to 
&lt;em&gt;uninstall&lt;/em&gt; the software (just in case you have second thoughts!). Uninstalling 
Miniconda is fairly straighforward.&lt;/p&gt;

&lt;p&gt;Uninitialize your shell to remove Conda related content from &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.bashrc&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda init &lt;span class=&quot;nt&quot;&gt;--reverse&lt;/span&gt; bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Remove the entire &lt;code class=&quot;highlighter-rouge&quot;&gt;~/miniconda3&lt;/code&gt; directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; ~/miniconda3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Remove the entire &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.conda&lt;/code&gt; directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; ~/.conda
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If present, remove your Conda configuration file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; ~/.condarc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;conda-best-practices&quot;&gt;Conda “Best Practices”&lt;/h1&gt;

&lt;p&gt;In the following section I detail a minimal set of best practices for using 
Conda to manage data science environments that I use in my own work.&lt;/p&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TLDR;&lt;/h2&gt;

&lt;p&gt;Here is the basic recipe for using Conda to manage a project specific software 
stack.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;project-dir
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;project-dir
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nano environment.yml &lt;span class=&quot;c&quot;&gt;# create the environment file&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;conda &lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;create &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt; ./env &lt;span class=&quot;nt&quot;&gt;--file&lt;/span&gt; environment.yml
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;conda activate ./env &lt;span class=&quot;c&quot;&gt;# activate the environment&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/path/to/env&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nano environment.yml &lt;span class=&quot;c&quot;&gt;# forgot to add some deps&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/path/to/env&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;conda &lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;update &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt; ./env &lt;span class=&quot;nt&quot;&gt;--file&lt;/span&gt; environment.yml &lt;span class=&quot;nt&quot;&gt;--prune&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# update the environment&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/path/to/env&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;conda deactivate &lt;span class=&quot;c&quot;&gt;# done working on project (for now!)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;new-project-new-directory&quot;&gt;New project, new directory&lt;/h2&gt;

&lt;p&gt;Every new project (no matter how small!) should live in its own directory. 
A good reference to get started with organizing your project directory is 
&lt;a href=&quot;https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005510&quot;&gt;Good Enough Practices for Scientific Computing&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;project-dir
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;project-dir
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;new-project-new-environment&quot;&gt;New project, new environment&lt;/h2&gt;

&lt;p&gt;Now that you have a new project directory you are ready to create a new 
environment for your project. We will do this in two steps.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Create an environment file that describes the software dependencies 
(including specific version numbers!) for the project.&lt;/li&gt;
  &lt;li&gt;Use the newly created environment file to build the software environment.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Here is an example of a typical environment file that could be used to run GPU 
accelerated, distributed training of deep learning models developed using 
&lt;a href=&quot;https://www.pytorch.org&quot;&gt;PyTorch&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;null&lt;/span&gt;

&lt;span class=&quot;na&quot;&gt;channels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;pytorch&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;conda-forge&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;defaults&lt;/span&gt;

&lt;span class=&quot;na&quot;&gt;dependencies&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cudatoolkit=10.1&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;jupyterlab=1.2&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;pip=20.0&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python=3.7&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;pytorch=1.4&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;torchvision=0.5&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once you have created an &lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt; file inside your project directory 
you can use the following commands to create the environment as a sub-directory 
called &lt;code class=&quot;highlighter-rouge&quot;&gt;env&lt;/code&gt; inside your project directory.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda env create --prefix ./env --file environment.yml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;activating-an-environment&quot;&gt;Activating an environment&lt;/h2&gt;

&lt;p&gt;Activating environments is essential to making the software in environments work 
well (or sometimes at all!). Activation of an environment does two things.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Adds entries to &lt;code class=&quot;highlighter-rouge&quot;&gt;PATH&lt;/code&gt; for the environment.&lt;/li&gt;
  &lt;li&gt;Runs any activation scripts that the environment may contain.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Step 2 is particularly important as activation scripts are how packages can set 
arbitrary environment variables that may be necessary for their operation.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda activate ./env &lt;span class=&quot;c&quot;&gt;# activate the environment&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/path/to/env&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# now the prompt indicates which environment is active!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;updating-an-environment&quot;&gt;Updating an environment&lt;/h2&gt;

&lt;p&gt;You are unlikely to know ahead of time which packages (and version numbers!) you 
will need to use for your research project. For example it may be the case that…&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;one of your core dependencies just released a new version (dependency version 
number update).&lt;/li&gt;
  &lt;li&gt;you need an additional package for data analysis (add a new dependency).&lt;/li&gt;
  &lt;li&gt;you have found a better visualization package and no longer need to old 
visualization package (add new dependency and remove old dependency).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If any of these occurs during the course of your research project, all you need 
to do is update the contents of your &lt;code class=&quot;highlighter-rouge&quot;&gt;environment.yml&lt;/code&gt; file accordingly and then 
run the following command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda &lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;update &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt; ./env &lt;span class=&quot;nt&quot;&gt;--file&lt;/span&gt; environment.yml &lt;span class=&quot;nt&quot;&gt;--prune&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# update the environment&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alternatively, you can simply rebuild the environment from scratch with the following 
command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda &lt;span class=&quot;nb&quot;&gt;env &lt;/span&gt;create &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt; ./env &lt;span class=&quot;nt&quot;&gt;--file&lt;/span&gt; environment.yml &lt;span class=&quot;nt&quot;&gt;--force&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;deactivating-an-environment&quot;&gt;Deactivating an environment&lt;/h2&gt;

&lt;p&gt;When you are done working on your project it is a good idea to deactivate the 
current environment. To deactivate the currently active environment use the 
&lt;code class=&quot;highlighter-rouge&quot;&gt;deactivate&lt;/code&gt; command as follows.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;conda deactivate # done working on project (for now!)
(base) $ # now you are back to the base environment
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;interested-in-learning-more&quot;&gt;Interested in Learning More?&lt;/h1&gt;

&lt;p&gt;For more details on using Conda to manage software stacks for you data science projects, 
checkout the 
&lt;a href=&quot;https://carpentries-incubator.github.io/introduction-to-conda-for-data-scientists/&quot;&gt;Introduction to Conda for (Data) Scientists&lt;/a&gt; 
training materials that I have contributed to &lt;a href=&quot;https://carpentries.org/involved-lessons/&quot;&gt;The Carpentries Incubator&lt;/a&gt;.&lt;/p&gt;</content><author><name></name></author><summary type="html">Getting Started with Conda</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/conda-logo.svg" /><media:content medium="image" url="https://davidrpugh.github.io/stochastic-expatriate-descent/images/conda-logo.svg" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>